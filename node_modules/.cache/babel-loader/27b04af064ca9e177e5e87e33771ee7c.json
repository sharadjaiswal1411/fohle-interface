{"ast":null,"code":"import{sendAnalyticsEvent}from'@uniswap/analytics';import{EventName}from'@uniswap/analytics-events';import{useWeb3React}from'@web3-react/core';import{DEFAULT_TXN_DISMISS_MS,L2_TXN_DISMISS_MS}from'constants/misc';import LibUpdater from'lib/hooks/transactions/updater';import{formatPercentInBasisPointsNumber,formatToDecimal,getTokenAddress}from'lib/utils/analytics';import{useCallback,useMemo}from'react';import{useAppDispatch,useAppSelector}from'state/hooks';import{TransactionType}from'state/transactions/types';import{computeRealizedPriceImpact}from'utils/prices';import{L2_CHAIN_IDS}from'../../constants/chains';import{useDerivedSwapInfo}from'../../state/swap/hooks';import{useAddPopup}from'../application/hooks';import{checkedTransaction,finalizeTransaction}from'./reducer';import{jsx as _jsx}from\"react/jsx-runtime\";var formatAnalyticsEventProperties=function formatAnalyticsEventProperties(_ref){var trade=_ref.trade,hash=_ref.hash,allowedSlippage=_ref.allowedSlippage,succeeded=_ref.succeeded;return{estimated_network_fee_usd:trade.gasUseEstimateUSD?formatToDecimal(trade.gasUseEstimateUSD,2):undefined,transaction_hash:hash,token_in_address:getTokenAddress(trade.inputAmount.currency),token_out_address:getTokenAddress(trade.outputAmount.currency),token_in_symbol:trade.inputAmount.currency.symbol,token_out_symbol:trade.outputAmount.currency.symbol,token_in_amount:formatToDecimal(trade.inputAmount,trade.inputAmount.currency.decimals),token_out_amount:formatToDecimal(trade.outputAmount,trade.outputAmount.currency.decimals),price_impact_basis_points:formatPercentInBasisPointsNumber(computeRealizedPriceImpact(trade)),allowed_slippage_basis_points:formatPercentInBasisPointsNumber(allowedSlippage),chain_id:trade.inputAmount.currency.chainId===trade.outputAmount.currency.chainId?trade.inputAmount.currency.chainId:undefined,swap_quote_block_number:trade.blockNumber,succeeded:succeeded};};export default function Updater(){var _useWeb3React=useWeb3React(),chainId=_useWeb3React.chainId;var addPopup=useAddPopup();// speed up popup dismisall time if on L2\nvar isL2=Boolean(chainId&&L2_CHAIN_IDS.includes(chainId));var transactions=useAppSelector(function(state){return state.transactions;});var _useDerivedSwapInfo=useDerivedSwapInfo(),trade=_useDerivedSwapInfo.trade.trade,allowedSlippage=_useDerivedSwapInfo.allowedSlippage;var dispatch=useAppDispatch();var onCheck=useCallback(function(_ref2){var chainId=_ref2.chainId,hash=_ref2.hash,blockNumber=_ref2.blockNumber;return dispatch(checkedTransaction({chainId:chainId,hash:hash,blockNumber:blockNumber}));},[dispatch]);var onReceipt=useCallback(function(_ref3){var _transactions$chainId;var chainId=_ref3.chainId,hash=_ref3.hash,receipt=_ref3.receipt;dispatch(finalizeTransaction({chainId:chainId,hash:hash,receipt:{blockHash:receipt.blockHash,blockNumber:receipt.blockNumber,contractAddress:receipt.contractAddress,from:receipt.from,status:receipt.status,to:receipt.to,transactionHash:receipt.transactionHash,transactionIndex:receipt.transactionIndex}}));var tx=(_transactions$chainId=transactions[chainId])===null||_transactions$chainId===void 0?void 0:_transactions$chainId[hash];if(tx.info.type===TransactionType.SWAP&&trade){sendAnalyticsEvent(EventName.SWAP_TRANSACTION_COMPLETED,formatAnalyticsEventProperties({trade:trade,hash:hash,allowedSlippage:allowedSlippage,succeeded:receipt.status===1}));}addPopup({txn:{hash:hash}},hash,isL2?L2_TXN_DISMISS_MS:DEFAULT_TXN_DISMISS_MS);},[addPopup,allowedSlippage,dispatch,isL2,trade,transactions]);var pendingTransactions=useMemo(function(){var _transactions$chainId2;return chainId?(_transactions$chainId2=transactions[chainId])!==null&&_transactions$chainId2!==void 0?_transactions$chainId2:{}:{};},[chainId,transactions]);return/*#__PURE__*/_jsx(LibUpdater,{pendingTransactions:pendingTransactions,onCheck:onCheck,onReceipt:onReceipt});}","map":{"version":3,"names":["sendAnalyticsEvent","EventName","useWeb3React","DEFAULT_TXN_DISMISS_MS","L2_TXN_DISMISS_MS","LibUpdater","formatPercentInBasisPointsNumber","formatToDecimal","getTokenAddress","useCallback","useMemo","useAppDispatch","useAppSelector","TransactionType","computeRealizedPriceImpact","L2_CHAIN_IDS","useDerivedSwapInfo","useAddPopup","checkedTransaction","finalizeTransaction","formatAnalyticsEventProperties","trade","hash","allowedSlippage","succeeded","estimated_network_fee_usd","gasUseEstimateUSD","undefined","transaction_hash","token_in_address","inputAmount","currency","token_out_address","outputAmount","token_in_symbol","symbol","token_out_symbol","token_in_amount","decimals","token_out_amount","price_impact_basis_points","allowed_slippage_basis_points","chain_id","chainId","swap_quote_block_number","blockNumber","Updater","addPopup","isL2","Boolean","includes","transactions","state","dispatch","onCheck","onReceipt","receipt","blockHash","contractAddress","from","status","to","transactionHash","transactionIndex","tx","info","type","SWAP","SWAP_TRANSACTION_COMPLETED","txn","pendingTransactions"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/state/transactions/updater.tsx"],"sourcesContent":["import { sendAnalyticsEvent } from '@uniswap/analytics'\nimport { EventName } from '@uniswap/analytics-events'\nimport { Currency, Percent, TradeType } from '@uniswap/sdk-core'\nimport { useWeb3React } from '@web3-react/core'\nimport { DEFAULT_TXN_DISMISS_MS, L2_TXN_DISMISS_MS } from 'constants/misc'\nimport LibUpdater from 'lib/hooks/transactions/updater'\nimport { formatPercentInBasisPointsNumber, formatToDecimal, getTokenAddress } from 'lib/utils/analytics'\nimport { useCallback, useMemo } from 'react'\nimport { useAppDispatch, useAppSelector } from 'state/hooks'\nimport { InterfaceTrade } from 'state/routing/types'\nimport { TransactionType } from 'state/transactions/types'\nimport { computeRealizedPriceImpact } from 'utils/prices'\n\nimport { L2_CHAIN_IDS } from '../../constants/chains'\nimport { useDerivedSwapInfo } from '../../state/swap/hooks'\nimport { useAddPopup } from '../application/hooks'\nimport { checkedTransaction, finalizeTransaction } from './reducer'\nimport { SerializableTransactionReceipt } from './types'\n\ninterface AnalyticsEventProps {\n  trade: InterfaceTrade<Currency, Currency, TradeType>\n  hash: string | undefined\n  allowedSlippage: Percent\n  succeeded: boolean\n}\n\nconst formatAnalyticsEventProperties = ({ trade, hash, allowedSlippage, succeeded }: AnalyticsEventProps) => ({\n  estimated_network_fee_usd: trade.gasUseEstimateUSD ? formatToDecimal(trade.gasUseEstimateUSD, 2) : undefined,\n  transaction_hash: hash,\n  token_in_address: getTokenAddress(trade.inputAmount.currency),\n  token_out_address: getTokenAddress(trade.outputAmount.currency),\n  token_in_symbol: trade.inputAmount.currency.symbol,\n  token_out_symbol: trade.outputAmount.currency.symbol,\n  token_in_amount: formatToDecimal(trade.inputAmount, trade.inputAmount.currency.decimals),\n  token_out_amount: formatToDecimal(trade.outputAmount, trade.outputAmount.currency.decimals),\n  price_impact_basis_points: formatPercentInBasisPointsNumber(computeRealizedPriceImpact(trade)),\n  allowed_slippage_basis_points: formatPercentInBasisPointsNumber(allowedSlippage),\n  chain_id:\n    trade.inputAmount.currency.chainId === trade.outputAmount.currency.chainId\n      ? trade.inputAmount.currency.chainId\n      : undefined,\n  swap_quote_block_number: trade.blockNumber,\n  succeeded,\n})\n\nexport default function Updater() {\n  const { chainId } = useWeb3React()\n  const addPopup = useAddPopup()\n  // speed up popup dismisall time if on L2\n  const isL2 = Boolean(chainId && L2_CHAIN_IDS.includes(chainId))\n  const transactions = useAppSelector((state) => state.transactions)\n  const {\n    trade: { trade },\n    allowedSlippage,\n  } = useDerivedSwapInfo()\n\n  const dispatch = useAppDispatch()\n  const onCheck = useCallback(\n    ({ chainId, hash, blockNumber }: { chainId: number; hash: string; blockNumber: number }) =>\n      dispatch(checkedTransaction({ chainId, hash, blockNumber })),\n    [dispatch]\n  )\n  const onReceipt = useCallback(\n    ({ chainId, hash, receipt }: { chainId: number; hash: string; receipt: SerializableTransactionReceipt }) => {\n      dispatch(\n        finalizeTransaction({\n          chainId,\n          hash,\n          receipt: {\n            blockHash: receipt.blockHash,\n            blockNumber: receipt.blockNumber,\n            contractAddress: receipt.contractAddress,\n            from: receipt.from,\n            status: receipt.status,\n            to: receipt.to,\n            transactionHash: receipt.transactionHash,\n            transactionIndex: receipt.transactionIndex,\n          },\n        })\n      )\n\n      const tx = transactions[chainId]?.[hash]\n\n      if (tx.info.type === TransactionType.SWAP && trade) {\n        sendAnalyticsEvent(\n          EventName.SWAP_TRANSACTION_COMPLETED,\n          formatAnalyticsEventProperties({\n            trade,\n            hash,\n            allowedSlippage,\n            succeeded: receipt.status === 1,\n          })\n        )\n      }\n      addPopup(\n        {\n          txn: { hash },\n        },\n        hash,\n        isL2 ? L2_TXN_DISMISS_MS : DEFAULT_TXN_DISMISS_MS\n      )\n    },\n    [addPopup, allowedSlippage, dispatch, isL2, trade, transactions]\n  )\n\n  const pendingTransactions = useMemo(() => (chainId ? transactions[chainId] ?? {} : {}), [chainId, transactions])\n\n  return <LibUpdater pendingTransactions={pendingTransactions} onCheck={onCheck} onReceipt={onReceipt} />\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}