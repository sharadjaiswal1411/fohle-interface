{"ast":null,"code":"import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useWeb3React}from'@web3-react/core';import{getYear,isSameDay,isSameWeek,isSameYear}from'date-fns';import{useCallback,useMemo}from'react';import{useAppDispatch}from'state/hooks';import{flexColumnNoWrap}from'theme/styles';import{useAllTransactions}from'../../state/transactions/hooks';import{clearAllTransactions}from'../../state/transactions/reducer';import{TransactionSummary}from'../AccountDetailsV2';import{SlideOutMenu}from'./SlideOutMenu';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var THIRTY_DAYS=2592000000;var Divider=_styled.div.withConfig({componentId:\"sc-mp36hl-0\"})([\"margin-top:16px;border-bottom:\",\";\"],function(_ref){var theme=_ref.theme;return\"1px solid \".concat(theme.backgroundOutline);});var TransactionListWrapper=_styled.div.withConfig({componentId:\"sc-mp36hl-1\"})([\"\",\";\"],flexColumnNoWrap);var TransactionTitle=_styled.span.withConfig({componentId:\"sc-mp36hl-2\"})([\"padding-bottom:8px;padding-top:20px;padding-left:12px;padding-right:12px;font-weight:600;color:\",\";\"],function(_ref2){var theme=_ref2.theme;return theme.textTertiary;});var TransactionList=function TransactionList(_ref3){var transactionInformation=_ref3.transactionInformation;var title=transactionInformation.title,transactions=transactionInformation.transactions;return/*#__PURE__*/_jsxs(TransactionListWrapper,{children:[/*#__PURE__*/_jsx(TransactionTitle,{children:title}),transactions.map(function(transactionDetails,index){return/*#__PURE__*/_jsx(TransactionSummary,{transactionDetails:transactionDetails,isLastTransactionInList:index===transactions.length-1},transactionDetails.hash);})]},title);};var getConfirmedTransactions=function getConfirmedTransactions(confirmedTransactions){var now=new Date().getTime();var today=[];var currentWeek=[];var last30Days=[];var currentYear=[];var yearMap={};confirmedTransactions.forEach(function(transaction){var addedTime=transaction.addedTime;if(isSameDay(now,addedTime)){today.push(transaction);}else if(isSameWeek(addedTime,now)){currentWeek.push(transaction);}else if(now-addedTime<THIRTY_DAYS){last30Days.push(transaction);}else if(isSameYear(addedTime,now)){currentYear.push(transaction);}else{var year=getYear(addedTime);if(!yearMap[year]){yearMap[year]=[transaction];}else{yearMap[year].push(transaction);}}});var transactionGroups=[{title:'Today',transactions:today},{title:'This week',transactions:currentWeek},{title:'Past 30 Days',transactions:last30Days},{title:'This year',transactions:currentYear}];var sortedYears=Object.keys(yearMap).sort(function(a,b){return parseInt(b)-parseInt(a);}).map(function(year){return{title:year,transactions:yearMap[year]};});transactionGroups.push.apply(transactionGroups,_toConsumableArray(sortedYears));return transactionGroups.filter(function(transactionInformation){return transactionInformation.transactions.length>0;});};var EmptyTransaction=_styled.div.withConfig({componentId:\"sc-mp36hl-3\"})([\"text-align:center;margin-top:24px;font-weight:400;font-size:14px;padding-left:12px;padding-right:12px;color:\",\";\"],function(_ref4){var theme=_ref4.theme;return theme.textSecondary;});export var TransactionHistoryMenu=function TransactionHistoryMenu(_ref5){var onClose=_ref5.onClose;var allTransactions=useAllTransactions();var _useWeb3React=useWeb3React(),chainId=_useWeb3React.chainId;var dispatch=useAppDispatch();var transactionGroupsInformation=[];var clearAllTransactionsCallback=useCallback(function(){if(chainId)dispatch(clearAllTransactions({chainId:chainId}));},[dispatch,chainId]);var _useMemo=useMemo(function(){var confirmed=[];var pending=[];var sorted=Object.values(allTransactions).sort(function(a,b){return b.addedTime-a.addedTime;});sorted.forEach(function(transaction){return transaction.receipt?confirmed.push(transaction):pending.push(transaction);});return[confirmed,pending];},[allTransactions]),_useMemo2=_slicedToArray(_useMemo,2),confirmed=_useMemo2[0],pending=_useMemo2[1];var confirmedTransactions=useMemo(function(){return getConfirmedTransactions(confirmed);},[confirmed]);if(pending.length)transactionGroupsInformation.push({title:\"Pending (\".concat(pending.length,\")\"),transactions:pending});if(confirmedTransactions.length)transactionGroupsInformation.push.apply(transactionGroupsInformation,_toConsumableArray(confirmedTransactions));return/*#__PURE__*/_jsxs(SlideOutMenu,{onClose:onClose,onClear:transactionGroupsInformation.length>0?clearAllTransactionsCallback:undefined,title:/*#__PURE__*/_jsx(Trans,{id:\"Transactions\"}),children:[/*#__PURE__*/_jsx(Divider,{}),transactionGroupsInformation.length>0?/*#__PURE__*/_jsx(_Fragment,{children:transactionGroupsInformation.map(function(transactionInformation){return/*#__PURE__*/_jsx(TransactionList,{transactionInformation:transactionInformation},transactionInformation.title);})}):/*#__PURE__*/_jsx(EmptyTransaction,{\"data-testid\":\"wallet-empty-transaction-text\",children:/*#__PURE__*/_jsx(Trans,{id:\"Your transactions will appear here\"})})]});};","map":{"version":3,"names":["useWeb3React","getYear","isSameDay","isSameWeek","isSameYear","useCallback","useMemo","useAppDispatch","flexColumnNoWrap","useAllTransactions","clearAllTransactions","TransactionSummary","SlideOutMenu","THIRTY_DAYS","Divider","styled","div","theme","backgroundOutline","TransactionListWrapper","TransactionTitle","span","textTertiary","TransactionList","transactionInformation","title","transactions","map","transactionDetails","index","length","hash","getConfirmedTransactions","confirmedTransactions","now","Date","getTime","today","currentWeek","last30Days","currentYear","yearMap","forEach","transaction","addedTime","push","year","transactionGroups","sortedYears","Object","keys","sort","a","b","parseInt","filter","EmptyTransaction","textSecondary","TransactionHistoryMenu","onClose","allTransactions","chainId","dispatch","transactionGroupsInformation","clearAllTransactionsCallback","confirmed","pending","sorted","values","receipt","undefined"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/WalletDropdown/TransactionMenu.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { useWeb3React } from '@web3-react/core'\nimport { getYear, isSameDay, isSameWeek, isSameYear } from 'date-fns'\nimport ms from 'ms.macro'\nimport { useCallback, useMemo } from 'react'\nimport { useAppDispatch } from 'state/hooks'\nimport styled from 'styled-components/macro'\nimport { flexColumnNoWrap } from 'theme/styles'\n\nimport { useAllTransactions } from '../../state/transactions/hooks'\nimport { clearAllTransactions } from '../../state/transactions/reducer'\nimport { TransactionDetails } from '../../state/transactions/types'\nimport { TransactionSummary } from '../AccountDetailsV2'\nimport { SlideOutMenu } from './SlideOutMenu'\n\nconst THIRTY_DAYS = ms`30 days`\n\nconst Divider = styled.div`\n  margin-top: 16px;\n  border-bottom: ${({ theme }) => `1px solid ${theme.backgroundOutline}`};\n`\n\nconst TransactionListWrapper = styled.div`\n  ${flexColumnNoWrap};\n`\n\ninterface TransactionInformation {\n  title: string\n  transactions: TransactionDetails[]\n}\n\nconst TransactionTitle = styled.span`\n  padding-bottom: 8px;\n  padding-top: 20px;\n  padding-left: 12px;\n  padding-right: 12px;\n  font-weight: 600;\n  color: ${({ theme }) => theme.textTertiary};\n`\n\nconst TransactionList = ({ transactionInformation }: { transactionInformation: TransactionInformation }) => {\n  const { title, transactions } = transactionInformation\n\n  return (\n    <TransactionListWrapper key={title}>\n      <TransactionTitle>{title}</TransactionTitle>\n      {transactions.map((transactionDetails, index) => (\n        <TransactionSummary\n          key={transactionDetails.hash}\n          transactionDetails={transactionDetails}\n          isLastTransactionInList={index === transactions.length - 1}\n        />\n      ))}\n    </TransactionListWrapper>\n  )\n}\n\nconst getConfirmedTransactions = (confirmedTransactions: Array<TransactionDetails>) => {\n  const now = new Date().getTime()\n\n  const today: Array<TransactionDetails> = []\n  const currentWeek: Array<TransactionDetails> = []\n  const last30Days: Array<TransactionDetails> = []\n  const currentYear: Array<TransactionDetails> = []\n  const yearMap: { [key: string]: Array<TransactionDetails> } = {}\n\n  confirmedTransactions.forEach((transaction) => {\n    const { addedTime } = transaction\n\n    if (isSameDay(now, addedTime)) {\n      today.push(transaction)\n    } else if (isSameWeek(addedTime, now)) {\n      currentWeek.push(transaction)\n    } else if (now - addedTime < THIRTY_DAYS) {\n      last30Days.push(transaction)\n    } else if (isSameYear(addedTime, now)) {\n      currentYear.push(transaction)\n    } else {\n      const year = getYear(addedTime)\n\n      if (!yearMap[year]) {\n        yearMap[year] = [transaction]\n      } else {\n        yearMap[year].push(transaction)\n      }\n    }\n  })\n\n  const transactionGroups: Array<TransactionInformation> = [\n    {\n      title: 'Today',\n      transactions: today,\n    },\n    {\n      title: 'This week',\n      transactions: currentWeek,\n    },\n    {\n      title: 'Past 30 Days',\n      transactions: last30Days,\n    },\n    {\n      title: 'This year',\n      transactions: currentYear,\n    },\n  ]\n\n  const sortedYears = Object.keys(yearMap)\n    .sort((a, b) => parseInt(b) - parseInt(a))\n    .map((year) => ({ title: year, transactions: yearMap[year] }))\n\n  transactionGroups.push(...sortedYears)\n\n  return transactionGroups.filter((transactionInformation) => transactionInformation.transactions.length > 0)\n}\n\nconst EmptyTransaction = styled.div`\n  text-align: center;\n  margin-top: 24px;\n  font-weight: 400;\n  font-size: 14px;\n  padding-left: 12px;\n  padding-right: 12px;\n  color: ${({ theme }) => theme.textSecondary};\n`\n\nexport const TransactionHistoryMenu = ({ onClose }: { onClose: () => void }) => {\n  const allTransactions = useAllTransactions()\n  const { chainId } = useWeb3React()\n  const dispatch = useAppDispatch()\n  const transactionGroupsInformation = []\n\n  const clearAllTransactionsCallback = useCallback(() => {\n    if (chainId) dispatch(clearAllTransactions({ chainId }))\n  }, [dispatch, chainId])\n\n  const [confirmed, pending] = useMemo(() => {\n    const confirmed: Array<TransactionDetails> = []\n    const pending: Array<TransactionDetails> = []\n\n    const sorted = Object.values(allTransactions).sort((a, b) => b.addedTime - a.addedTime)\n    sorted.forEach((transaction) => (transaction.receipt ? confirmed.push(transaction) : pending.push(transaction)))\n\n    return [confirmed, pending]\n  }, [allTransactions])\n\n  const confirmedTransactions = useMemo(() => getConfirmedTransactions(confirmed), [confirmed])\n\n  if (pending.length) transactionGroupsInformation.push({ title: `Pending (${pending.length})`, transactions: pending })\n  if (confirmedTransactions.length) transactionGroupsInformation.push(...confirmedTransactions)\n\n  return (\n    <SlideOutMenu\n      onClose={onClose}\n      onClear={transactionGroupsInformation.length > 0 ? clearAllTransactionsCallback : undefined}\n      title={<Trans>Transactions</Trans>}\n    >\n      <Divider />\n      {transactionGroupsInformation.length > 0 ? (\n        <>\n          {transactionGroupsInformation.map((transactionInformation) => (\n            <TransactionList key={transactionInformation.title} transactionInformation={transactionInformation} />\n          ))}\n        </>\n      ) : (\n        <EmptyTransaction data-testid=\"wallet-empty-transaction-text\">\n          <Trans>Your transactions will appear here</Trans>\n        </EmptyTransaction>\n      )}\n    </SlideOutMenu>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}