{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _styled from\"styled-components\";var _initialFilterState;import{OpacityHoverState,ScrollBarStyles}from'components/Common';import Resource from'components/Tokens/TokenDetails/Resource';import{MouseoverTooltip}from'components/Tooltip/index';import{Box}from'nft/components/Box';import{reduceFilters}from'nft/components/collection/Activity';import{LoadingSparkle}from'nft/components/common/Loading/LoadingSparkle';import{AssetPriceDetails}from'nft/components/details/AssetPriceDetails';import{Center}from'nft/components/Flex';import{themeVars,vars}from'nft/css/sprinkles.css';import{ActivityFetcher}from'nft/queries/genie/ActivityFetcher';import{ActivityEventType}from'nft/types';import{shortenAddress}from'nft/utils/address';import{formatEthPrice}from'nft/utils/currency';import{isAudio}from'nft/utils/isAudio';import{isVideo}from'nft/utils/isVideo';import{putCommas}from'nft/utils/putCommas';import{fallbackProvider,getRarityProviderLogo}from'nft/utils/rarity';import{useCallback,useMemo,useReducer,useState}from'react';import InfiniteScroll from'react-infinite-scroll-component';import{useInfiniteQuery,useQuery}from'react-query';import{Link as RouterLink}from'react-router-dom';import{useIsDarkMode}from'state/user/hooks';import AssetActivity,{LoadingAssetActivity}from'./AssetActivity';import*as styles from'./AssetDetails.css';import DetailsContainer from'./DetailsContainer';import InfoContainer from'./InfoContainer';import TraitsContainer from'./TraitsContainer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AssetPriceDetailsContainer=_styled.div.withConfig({componentId:\"sc-163qykm-0\"})([\"margin-top:20px;display:none;@media (max-width:960px){display:block;}\"]);var MediaContainer=_styled.div.withConfig({componentId:\"sc-163qykm-1\"})([\"display:flex;justify-content:center;\"]);var Column=_styled.div.withConfig({componentId:\"sc-163qykm-2\"})([\"display:flex;flex-direction:column;width:100%;max-width:780px;\"]);var AddressTextLink=_styled.a.withConfig({componentId:\"sc-163qykm-3\"})([\"display:inline-block;color:\",\";text-decoration:none;max-width:100%;word-wrap:break-word;\",\";\"],function(_ref){var theme=_ref.theme;return theme.textSecondary;},OpacityHoverState);var SocialsContainer=_styled.div.withConfig({componentId:\"sc-163qykm-4\"})([\"display:flex;gap:16px;margin-top:20px;\"]);var DescriptionText=_styled.div.withConfig({componentId:\"sc-163qykm-5\"})([\"margin-top:8px;font-size:14px;line-height:20px;\"]);var RarityWrap=_styled.span.withConfig({componentId:\"sc-163qykm-6\"})([\"display:flex;color:\",\";padding:2px 4px;border-radius:4px;align-items:center;gap:4px;\"],function(_ref2){var theme=_ref2.theme;return theme.textSecondary;});var EmptyActivitiesContainer=_styled.div.withConfig({componentId:\"sc-163qykm-7\"})([\"display:flex;justify-content:center;align-items:center;flex-direction:column;color:\",\";font-size:28px;line-height:36px;padding:56px 0px;\"],function(_ref3){var theme=_ref3.theme;return theme.textPrimary;});var Link=_styled(RouterLink).withConfig({componentId:\"sc-163qykm-8\"})([\"color:\",\";text-decoration:none;font-size:14px;line-height:16px;margin-top:12px;cursor:pointer;\",\";\"],function(_ref4){var theme=_ref4.theme;return theme.accentAction;},OpacityHoverState);var ActivitySelectContainer=_styled.div.withConfig({componentId:\"sc-163qykm-9\"})([\"display:flex;gap:8px;margin-bottom:34px;overflow-x:auto;\",\" @media (max-width:720px){padding-bottom:8px;}\"],ScrollBarStyles);var ContentNotAvailable=_styled.div.withConfig({componentId:\"sc-163qykm-10\"})([\"display:flex;background-color:\",\";color:\",\";font-size:14px;line-height:20px;align-items:center;justify-content:center;border-radius:12px;width:450px;height:450px;\"],function(_ref5){var theme=_ref5.theme;return theme.backgroundSurface;},function(_ref6){var theme=_ref6.theme;return theme.textSecondary;});var FilterBox=_styled.div.withConfig({componentId:\"sc-163qykm-11\"})([\"box-sizing:border-box;background-color:\",\";font-size:14px;font-weight:600;line-height:14px;color:\",\";padding:8px 16px;border-radius:12px;cursor:pointer;box-sizing:border-box;\",\";\"],function(_ref7){var backgroundColor=_ref7.backgroundColor;return backgroundColor;},function(_ref8){var theme=_ref8.theme;return theme.textPrimary;},OpacityHoverState);var ByText=_styled.span.withConfig({componentId:\"sc-163qykm-12\"})([\"font-size:14px;line-height:20px;\"]);var Img=_styled.img.withConfig({componentId:\"sc-163qykm-13\"})([\"background-color:white;\"]);var HoverImageContainer=_styled.div.withConfig({componentId:\"sc-163qykm-14\"})([\"display:flex;margin-right:4px;\"]);var HoverContainer=_styled.div.withConfig({componentId:\"sc-163qykm-15\"})([\"display:flex;\"]);var ContainerText=_styled.span.withConfig({componentId:\"sc-163qykm-16\"})([\"font-size:14px;\"]);var AudioPlayer=function AudioPlayer(_ref9){var _ref10;var imageUrl=_ref9.imageUrl,animationUrl=_ref9.animationUrl,name=_ref9.name,collectionName=_ref9.collectionName,dominantColor=_ref9.dominantColor;return/*#__PURE__*/_jsxs(Box,{position:\"relative\",display:\"inline-block\",alignSelf:\"center\",children:[/*#__PURE__*/_jsx(Box,{as:\"audio\",className:styles.audioControls,width:\"292\",controls:true,src:animationUrl}),/*#__PURE__*/_jsx(\"img\",{className:styles.image,src:imageUrl,alt:name||collectionName,style:(_ref10={},_defineProperty(_ref10,'--shadow',\"rgba(\".concat(dominantColor.join(', '),\", 0.5)\")),_defineProperty(_ref10,\"minWidth\",'300px'),_defineProperty(_ref10,\"minHeight\",'300px'),_ref10)})]});};var initialFilterState=(_initialFilterState={},_defineProperty(_initialFilterState,ActivityEventType.Listing,true),_defineProperty(_initialFilterState,ActivityEventType.Sale,true),_defineProperty(_initialFilterState,ActivityEventType.Transfer,false),_defineProperty(_initialFilterState,ActivityEventType.CancelListing,false),_initialFilterState);var MediaType;(function(MediaType){MediaType[\"Audio\"]=\"audio\";MediaType[\"Video\"]=\"video\";MediaType[\"Image\"]=\"image\";MediaType[\"Embed\"]=\"embed\";})(MediaType||(MediaType={}));var AssetView=function AssetView(_ref11){var _asset$name;var mediaType=_ref11.mediaType,asset=_ref11.asset,dominantColor=_ref11.dominantColor;var style=_defineProperty({},'--shadow',\"rgba(\".concat(dominantColor.join(', '),\", 0.5)\"));switch(mediaType){case MediaType.Video:return/*#__PURE__*/_jsx(\"video\",{src:asset.animationUrl,className:styles.image,autoPlay:true,controls:true,muted:true,loop:true,style:style});case MediaType.Image:return/*#__PURE__*/_jsx(\"img\",{className:styles.image,src:asset.imageUrl,alt:asset.name||asset.collectionName,style:style});case MediaType.Audio:return/*#__PURE__*/_jsx(AudioPlayer,_objectSpread(_objectSpread({},asset),{},{dominantColor:dominantColor}));case MediaType.Embed:return/*#__PURE__*/_jsx(\"div\",{className:styles.embedContainer,children:/*#__PURE__*/_jsx(\"iframe\",{title:(_asset$name=asset.name)!==null&&_asset$name!==void 0?_asset$name:\"\".concat(asset.collectionName,\" #\").concat(asset.tokenId),src:asset.animationUrl,className:styles.embed,style:style,frameBorder:0,height:\"100%\",width:\"100%\",sandbox:\"allow-scripts\",allow:\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\",allowFullScreen:true})});}};export var AssetDetails=function AssetDetails(_ref12){var _priceData$events$0$p,_priceData$events$,_asset$rarity3,_asset$rarity3$provid,_asset$rarity4,_asset$rarity4$provid,_events$length,_asset$creator;var asset=_ref12.asset,collection=_ref12.collection;var _useState=useState([0,0,0]),_useState2=_slicedToArray(_useState,1),dominantColor=_useState2[0];var _useMemo=useMemo(function(){var _asset$rarity,_asset$rarity$provide;return asset.rarity?{rarityProvider:asset===null||asset===void 0?void 0:(_asset$rarity=asset.rarity)===null||_asset$rarity===void 0?void 0:(_asset$rarity$provide=_asset$rarity.providers)===null||_asset$rarity$provide===void 0?void 0:_asset$rarity$provide.find(function(_ref13){var _asset$rarity2;var _provider=_ref13.provider;return _provider===((_asset$rarity2=asset.rarity)===null||_asset$rarity2===void 0?void 0:_asset$rarity2.primaryProvider);})}:{};},[asset.rarity]),rarityProvider=_useMemo.rarityProvider;var assetMediaType=useMemo(function(){var _asset$animationUrl,_asset$animationUrl2;if(isAudio((_asset$animationUrl=asset.animationUrl)!==null&&_asset$animationUrl!==void 0?_asset$animationUrl:'')){return MediaType.Audio;}else if(isVideo((_asset$animationUrl2=asset.animationUrl)!==null&&_asset$animationUrl2!==void 0?_asset$animationUrl2:'')){return MediaType.Video;}else if(asset.animationUrl){return MediaType.Embed;}return MediaType.Image;},[asset]);var contractAddress=asset.address,token_id=asset.tokenId;var _useQuery=useQuery(['collectionActivity',{contractAddress:contractAddress}],/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref14){var _ref14$pageParam,pageParam;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref14$pageParam=_ref14.pageParam,pageParam=_ref14$pageParam===void 0?'':_ref14$pageParam;_context.next=3;return ActivityFetcher(contractAddress,{token_id:token_id,eventTypes:[ActivityEventType.Sale]},pageParam,'1');case 3:return _context.abrupt(\"return\",_context.sent);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref15.apply(this,arguments);};}(),{getNextPageParam:function getNextPageParam(lastPage){var _lastPage$events;return((_lastPage$events=lastPage.events)===null||_lastPage$events===void 0?void 0:_lastPage$events.length)===25?lastPage.cursor:undefined;},refetchInterval:15000,refetchIntervalInBackground:false,refetchOnWindowFocus:false,refetchOnMount:false}),priceData=_useQuery.data;var lastSalePrice=(_priceData$events$0$p=priceData===null||priceData===void 0?void 0:(_priceData$events$=priceData.events[0])===null||_priceData$events$===void 0?void 0:_priceData$events$.price)!==null&&_priceData$events$0$p!==void 0?_priceData$events$0$p:null;var formattedEthprice=formatEthPrice(lastSalePrice!==null&&lastSalePrice!==void 0?lastSalePrice:'')||0;var formattedPrice=lastSalePrice?putCommas(formattedEthprice).toString():null;var _useReducer=useReducer(reduceFilters,initialFilterState),_useReducer2=_slicedToArray(_useReducer,2),activeFilters=_useReducer2[0],filtersDispatch=_useReducer2[1];var Filter=useCallback(function ActivityFilter(_ref16){var eventType=_ref16.eventType;var isActive=activeFilters[eventType];var isDarkMode=useIsDarkMode();return/*#__PURE__*/_jsx(FilterBox,{backgroundColor:isActive?isDarkMode?vars.color.gray500:vars.color.gray200:themeVars.colors.backgroundInteractive,onClick:function onClick(){return filtersDispatch({eventType:eventType});},children:eventType===ActivityEventType.CancelListing?'Cancellations':eventType.charAt(0)+eventType.slice(1).toLowerCase()+'s'});},[activeFilters]);var _useInfiniteQuery=useInfiniteQuery(['collectionActivity',{contractAddress:contractAddress,activeFilters:activeFilters,token_id:token_id}],/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref17){var _ref17$pageParam,pageParam;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref17$pageParam=_ref17.pageParam,pageParam=_ref17$pageParam===void 0?'':_ref17$pageParam;_context2.next=3;return ActivityFetcher(contractAddress,{token_id:token_id,eventTypes:Object.keys(activeFilters).map(function(key){return key;}).filter(function(key){return activeFilters[key];})},pageParam);case 3:return _context2.abrupt(\"return\",_context2.sent);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref18.apply(this,arguments);};}(),{getNextPageParam:function getNextPageParam(lastPage){var _lastPage$events2;return((_lastPage$events2=lastPage.events)===null||_lastPage$events2===void 0?void 0:_lastPage$events2.length)===25?lastPage.cursor:undefined;},refetchInterval:15000,refetchIntervalInBackground:false,refetchOnWindowFocus:false,refetchOnMount:false}),eventsData=_useInfiniteQuery.data,fetchNextPage=_useInfiniteQuery.fetchNextPage,hasNextPage=_useInfiniteQuery.hasNextPage,isFetchingNextPage=_useInfiniteQuery.isFetchingNextPage,isSuccess=_useInfiniteQuery.isSuccess,isActivityLoading=_useInfiniteQuery.isLoading;var rarity=(asset===null||asset===void 0?void 0:(_asset$rarity3=asset.rarity)===null||_asset$rarity3===void 0?void 0:(_asset$rarity3$provid=_asset$rarity3.providers)===null||_asset$rarity3$provid===void 0?void 0:_asset$rarity3$provid.length)?asset===null||asset===void 0?void 0:(_asset$rarity4=asset.rarity)===null||_asset$rarity4===void 0?void 0:(_asset$rarity4$provid=_asset$rarity4.providers)===null||_asset$rarity4$provid===void 0?void 0:_asset$rarity4$provid[0]:undefined;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showHolder=_useState4[0],setShowHolder=_useState4[1];var rarityProviderLogo=getRarityProviderLogo(rarity===null||rarity===void 0?void 0:rarity.provider);var events=useMemo(function(){return isSuccess?eventsData===null||eventsData===void 0?void 0:eventsData.pages.map(function(page){return page.events;}).flat():null;},[isSuccess,eventsData]);return/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(MediaContainer,{children:asset.imageUrl===undefined||showHolder?/*#__PURE__*/_jsx(ContentNotAvailable,{children:\"Content not available yet\"}):assetMediaType===MediaType.Image?/*#__PURE__*/_jsx(Img,{className:styles.image,src:asset.imageUrl,alt:asset.name||collection.collectionName,onError:function onError(){return setShowHolder(true);}}):/*#__PURE__*/_jsx(AssetView,{asset:asset,mediaType:assetMediaType,dominantColor:dominantColor})}),/*#__PURE__*/_jsx(AssetPriceDetailsContainer,{children:/*#__PURE__*/_jsx(AssetPriceDetails,{asset:asset,collection:collection})}),asset.traits&&/*#__PURE__*/_jsx(InfoContainer,{\"data-testid\":\"nft-details-traits\",primaryHeader:\"Traits\",defaultOpen:true,secondaryHeader:rarityProvider&&rarity&&rarity.score?/*#__PURE__*/_jsx(MouseoverTooltip,{text:/*#__PURE__*/_jsxs(HoverContainer,{children:[/*#__PURE__*/_jsx(HoverImageContainer,{children:/*#__PURE__*/_jsx(\"img\",{src:rarityProviderLogo,alt:\"cardLogo\",width:16})}),/*#__PURE__*/_jsx(ContainerText,{children:\"Ranking by \".concat(rarity.provider==='Genie'?fallbackProvider:rarity.provider)})]}),placement:\"top\",children:/*#__PURE__*/_jsxs(RarityWrap,{children:[\"Rarity: \",putCommas(rarity.score)]})}):null,children:/*#__PURE__*/_jsx(TraitsContainer,{asset:asset})}),/*#__PURE__*/_jsx(InfoContainer,{primaryHeader:\"Activity\",defaultOpen:true,secondaryHeader:formattedPrice?\"Last Sale: \".concat(formattedPrice,\" ETH\"):undefined,\"data-testid\":\"nft-details-activity\",children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ActivitySelectContainer,{$isHorizontalScroll:true,children:[/*#__PURE__*/_jsx(Filter,{eventType:ActivityEventType.Listing}),/*#__PURE__*/_jsx(Filter,{eventType:ActivityEventType.Sale}),/*#__PURE__*/_jsx(Filter,{eventType:ActivityEventType.Transfer}),/*#__PURE__*/_jsx(Filter,{eventType:ActivityEventType.CancelListing})]}),isActivityLoading&&/*#__PURE__*/_jsx(LoadingAssetActivity,{rowCount:10}),events&&events.length>0?/*#__PURE__*/_jsx(InfiniteScroll,{next:fetchNextPage,hasMore:!!hasNextPage,loader:isFetchingNextPage&&/*#__PURE__*/_jsx(Center,{children:/*#__PURE__*/_jsx(LoadingSparkle,{})}),dataLength:(_events$length=events===null||events===void 0?void 0:events.length)!==null&&_events$length!==void 0?_events$length:0,scrollableTarget:\"activityContainer\",children:/*#__PURE__*/_jsx(AssetActivity,{eventsData:{events:events}})}):/*#__PURE__*/_jsx(_Fragment,{children:!isActivityLoading&&/*#__PURE__*/_jsxs(EmptyActivitiesContainer,{children:[/*#__PURE__*/_jsx(\"div\",{children:\"No activities yet\"}),/*#__PURE__*/_jsx(Link,{to:\"/nfts/collection/\".concat(asset.address),children:\"View collection items\"}),' ']})})]})}),/*#__PURE__*/_jsx(InfoContainer,{primaryHeader:\"Description\",defaultOpen:true,secondaryHeader:null,\"data-testid\":\"nft-details-description\",children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ByText,{children:\"By \"}),(asset===null||asset===void 0?void 0:asset.creator)&&((_asset$creator=asset.creator)===null||_asset$creator===void 0?void 0:_asset$creator.address)&&/*#__PURE__*/_jsx(AddressTextLink,{href:\"https://etherscan.io/address/\".concat(asset.creator.address),target:\"_blank\",rel:\"noopener noreferrer\",children:shortenAddress(asset.creator.address,2,4)}),/*#__PURE__*/_jsx(DescriptionText,{\"data-testid\":\"nft-details-description-text\",children:collection.collectionDescription}),/*#__PURE__*/_jsxs(SocialsContainer,{children:[collection.externalUrl&&/*#__PURE__*/_jsx(Resource,{name:\"Website\",link:\"\".concat(collection.externalUrl)}),collection.twitterUrl&&/*#__PURE__*/_jsx(Resource,{name:\"Twitter\",link:\"https://twitter.com/\".concat(collection.twitterUrl)}),collection.discordUrl&&/*#__PURE__*/_jsx(Resource,{name:\"Discord\",link:collection.discordUrl})]})]})}),/*#__PURE__*/_jsx(InfoContainer,{primaryHeader:\"Details\",defaultOpen:true,secondaryHeader:null,\"data-testid\":\"nft-details-asset-details\",children:/*#__PURE__*/_jsx(DetailsContainer,{asset:asset,collection:collection})})]});};","map":{"version":3,"names":["OpacityHoverState","ScrollBarStyles","Resource","MouseoverTooltip","Box","reduceFilters","LoadingSparkle","AssetPriceDetails","Center","themeVars","vars","ActivityFetcher","ActivityEventType","shortenAddress","formatEthPrice","isAudio","isVideo","putCommas","fallbackProvider","getRarityProviderLogo","useCallback","useMemo","useReducer","useState","InfiniteScroll","useInfiniteQuery","useQuery","Link","RouterLink","useIsDarkMode","AssetActivity","LoadingAssetActivity","styles","DetailsContainer","InfoContainer","TraitsContainer","AssetPriceDetailsContainer","styled","div","MediaContainer","Column","AddressTextLink","a","theme","textSecondary","SocialsContainer","DescriptionText","RarityWrap","span","EmptyActivitiesContainer","textPrimary","accentAction","ActivitySelectContainer","ContentNotAvailable","backgroundSurface","FilterBox","backgroundColor","ByText","Img","img","HoverImageContainer","HoverContainer","ContainerText","AudioPlayer","imageUrl","animationUrl","name","collectionName","dominantColor","audioControls","image","join","initialFilterState","Listing","Sale","Transfer","CancelListing","MediaType","AssetView","mediaType","asset","style","Video","Image","Audio","Embed","embedContainer","tokenId","embed","AssetDetails","collection","rarity","rarityProvider","providers","find","_provider","provider","primaryProvider","assetMediaType","contractAddress","address","token_id","pageParam","eventTypes","getNextPageParam","lastPage","events","length","cursor","undefined","refetchInterval","refetchIntervalInBackground","refetchOnWindowFocus","refetchOnMount","priceData","data","lastSalePrice","price","formattedEthprice","formattedPrice","toString","activeFilters","filtersDispatch","Filter","ActivityFilter","eventType","isActive","isDarkMode","color","gray500","gray200","colors","backgroundInteractive","charAt","slice","toLowerCase","Object","keys","map","key","filter","eventsData","fetchNextPage","hasNextPage","isFetchingNextPage","isSuccess","isActivityLoading","isLoading","showHolder","setShowHolder","rarityProviderLogo","pages","page","flat","traits","score","creator","collectionDescription","externalUrl","twitterUrl","discordUrl"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/nft/components/details/AssetDetails.tsx"],"sourcesContent":["import { OpacityHoverState, ScrollBarStyles } from 'components/Common'\nimport Resource from 'components/Tokens/TokenDetails/Resource'\nimport { MouseoverTooltip } from 'components/Tooltip/index'\nimport { Box } from 'nft/components/Box'\nimport { reduceFilters } from 'nft/components/collection/Activity'\nimport { LoadingSparkle } from 'nft/components/common/Loading/LoadingSparkle'\nimport { AssetPriceDetails } from 'nft/components/details/AssetPriceDetails'\nimport { Center } from 'nft/components/Flex'\nimport { themeVars, vars } from 'nft/css/sprinkles.css'\nimport { ActivityFetcher } from 'nft/queries/genie/ActivityFetcher'\nimport { ActivityEventResponse, ActivityEventType, CollectionInfoForAsset, GenieAsset } from 'nft/types'\nimport { shortenAddress } from 'nft/utils/address'\nimport { formatEthPrice } from 'nft/utils/currency'\nimport { isAudio } from 'nft/utils/isAudio'\nimport { isVideo } from 'nft/utils/isVideo'\nimport { putCommas } from 'nft/utils/putCommas'\nimport { fallbackProvider, getRarityProviderLogo } from 'nft/utils/rarity'\nimport { useCallback, useMemo, useReducer, useState } from 'react'\nimport InfiniteScroll from 'react-infinite-scroll-component'\nimport { useInfiniteQuery, useQuery } from 'react-query'\nimport { Link as RouterLink } from 'react-router-dom'\nimport { useIsDarkMode } from 'state/user/hooks'\nimport styled from 'styled-components/macro'\n\nimport AssetActivity, { LoadingAssetActivity } from './AssetActivity'\nimport * as styles from './AssetDetails.css'\nimport DetailsContainer from './DetailsContainer'\nimport InfoContainer from './InfoContainer'\nimport TraitsContainer from './TraitsContainer'\n\nconst AssetPriceDetailsContainer = styled.div`\n  margin-top: 20px;\n  display: none;\n  @media (max-width: 960px) {\n    display: block;\n  }\n`\n\nconst MediaContainer = styled.div`\n  display: flex;\n  justify-content: center;\n`\n\nconst Column = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  max-width: 780px;\n`\n\nconst AddressTextLink = styled.a`\n  display: inline-block;\n  color: ${({ theme }) => theme.textSecondary};\n  text-decoration: none;\n  max-width: 100%;\n  word-wrap: break-word;\n  ${OpacityHoverState};\n`\n\nconst SocialsContainer = styled.div`\n  display: flex;\n  gap: 16px;\n  margin-top: 20px;\n`\n\nconst DescriptionText = styled.div`\n  margin-top: 8px;\n  font-size: 14px;\n  line-height: 20px;\n`\n\nconst RarityWrap = styled.span`\n  display: flex;\n  color: ${({ theme }) => theme.textSecondary};\n  padding: 2px 4px;\n  border-radius: 4px;\n  align-items: center;\n  gap: 4px;\n`\n\nconst EmptyActivitiesContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  color: ${({ theme }) => theme.textPrimary};\n  font-size: 28px;\n  line-height: 36px;\n  padding: 56px 0px;\n`\n\nconst Link = styled(RouterLink)`\n  color: ${({ theme }) => theme.accentAction};\n  text-decoration: none;\n  font-size: 14px;\n  line-height: 16px;\n  margin-top: 12px;\n  cursor: pointer;\n  ${OpacityHoverState};\n`\n\nconst ActivitySelectContainer = styled.div`\n  display: flex;\n  gap: 8px;\n  margin-bottom: 34px;\n  overflow-x: auto;\n  ${ScrollBarStyles}\n\n  @media (max-width: 720px) {\n    padding-bottom: 8px;\n  }\n`\n\nconst ContentNotAvailable = styled.div`\n  display: flex;\n  background-color: ${({ theme }) => theme.backgroundSurface};\n  color: ${({ theme }) => theme.textSecondary};\n  font-size: 14px;\n  line-height: 20px;\n  align-items: center;\n  justify-content: center;\n  border-radius: 12px;\n  width: 450px;\n  height: 450px;\n`\n\nconst FilterBox = styled.div<{ backgroundColor: string }>`\n  box-sizing: border-box;\n  background-color: ${({ backgroundColor }) => backgroundColor};\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 14px;\n  color: ${({ theme }) => theme.textPrimary};\n  padding: 8px 16px;\n  border-radius: 12px;\n  cursor: pointer;\n  box-sizing: border-box;\n  ${OpacityHoverState};\n`\n\nconst ByText = styled.span`\n  font-size: 14px;\n  line-height: 20px;\n`\n\nconst Img = styled.img`\n  background-color: white;\n`\n\nconst HoverImageContainer = styled.div`\n  display: flex;\n  margin-right: 4px;\n`\n\nconst HoverContainer = styled.div`\n  display: flex;\n`\n\nconst ContainerText = styled.span`\n  font-size: 14px;\n`\n\nconst AudioPlayer = ({\n  imageUrl,\n  animationUrl,\n  name,\n  collectionName,\n  dominantColor,\n}: GenieAsset & { dominantColor: [number, number, number] }) => {\n  return (\n    <Box position=\"relative\" display=\"inline-block\" alignSelf=\"center\">\n      <Box as=\"audio\" className={styles.audioControls} width=\"292\" controls src={animationUrl} />\n      <img\n        className={styles.image}\n        src={imageUrl}\n        alt={name || collectionName}\n        style={{\n          ['--shadow' as string]: `rgba(${dominantColor.join(', ')}, 0.5)`,\n          minWidth: '300px',\n          minHeight: '300px',\n        }}\n      />\n    </Box>\n  )\n}\n\nconst initialFilterState = {\n  [ActivityEventType.Listing]: true,\n  [ActivityEventType.Sale]: true,\n  [ActivityEventType.Transfer]: false,\n  [ActivityEventType.CancelListing]: false,\n}\n\nenum MediaType {\n  Audio = 'audio',\n  Video = 'video',\n  Image = 'image',\n  Embed = 'embed',\n}\n\nconst AssetView = ({\n  mediaType,\n  asset,\n  dominantColor,\n}: {\n  mediaType: MediaType\n  asset: GenieAsset\n  dominantColor: [number, number, number]\n}) => {\n  const style = { ['--shadow' as string]: `rgba(${dominantColor.join(', ')}, 0.5)` }\n\n  switch (mediaType) {\n    case MediaType.Video:\n      return <video src={asset.animationUrl} className={styles.image} autoPlay controls muted loop style={style} />\n    case MediaType.Image:\n      return (\n        <img className={styles.image} src={asset.imageUrl} alt={asset.name || asset.collectionName} style={style} />\n      )\n    case MediaType.Audio:\n      return <AudioPlayer {...asset} dominantColor={dominantColor} />\n    case MediaType.Embed:\n      return (\n        <div className={styles.embedContainer}>\n          <iframe\n            title={asset.name ?? `${asset.collectionName} #${asset.tokenId}`}\n            src={asset.animationUrl}\n            className={styles.embed}\n            style={style}\n            frameBorder={0}\n            height=\"100%\"\n            width=\"100%\"\n            sandbox=\"allow-scripts\"\n            allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n            allowFullScreen\n          />\n        </div>\n      )\n  }\n}\n\ninterface AssetDetailsProps {\n  asset: GenieAsset\n  collection: CollectionInfoForAsset\n}\n\nexport const AssetDetails = ({ asset, collection }: AssetDetailsProps) => {\n  const [dominantColor] = useState<[number, number, number]>([0, 0, 0])\n\n  const { rarityProvider } = useMemo(\n    () =>\n      asset.rarity\n        ? {\n            rarityProvider: asset?.rarity?.providers?.find(\n              ({ provider: _provider }) => _provider === asset.rarity?.primaryProvider\n            ),\n          }\n        : {},\n    [asset.rarity]\n  )\n\n  const assetMediaType = useMemo(() => {\n    if (isAudio(asset.animationUrl ?? '')) {\n      return MediaType.Audio\n    } else if (isVideo(asset.animationUrl ?? '')) {\n      return MediaType.Video\n    } else if (asset.animationUrl) {\n      return MediaType.Embed\n    }\n    return MediaType.Image\n  }, [asset])\n\n  const { address: contractAddress, tokenId: token_id } = asset\n\n  const { data: priceData } = useQuery<ActivityEventResponse>(\n    [\n      'collectionActivity',\n      {\n        contractAddress,\n      },\n    ],\n    async ({ pageParam = '' }) => {\n      return await ActivityFetcher(\n        contractAddress,\n        {\n          token_id,\n          eventTypes: [ActivityEventType.Sale],\n        },\n        pageParam,\n        '1'\n      )\n    },\n    {\n      getNextPageParam: (lastPage) => {\n        return lastPage.events?.length === 25 ? lastPage.cursor : undefined\n      },\n      refetchInterval: 15000,\n      refetchIntervalInBackground: false,\n      refetchOnWindowFocus: false,\n      refetchOnMount: false,\n    }\n  )\n\n  const lastSalePrice = priceData?.events[0]?.price ?? null\n  const formattedEthprice = formatEthPrice(lastSalePrice ?? '') || 0\n  const formattedPrice = lastSalePrice ? putCommas(formattedEthprice).toString() : null\n  const [activeFilters, filtersDispatch] = useReducer(reduceFilters, initialFilterState)\n\n  const Filter = useCallback(\n    function ActivityFilter({ eventType }: { eventType: ActivityEventType }) {\n      const isActive = activeFilters[eventType]\n      const isDarkMode = useIsDarkMode()\n\n      return (\n        <FilterBox\n          backgroundColor={\n            isActive ? (isDarkMode ? vars.color.gray500 : vars.color.gray200) : themeVars.colors.backgroundInteractive\n          }\n          onClick={() => filtersDispatch({ eventType })}\n        >\n          {eventType === ActivityEventType.CancelListing\n            ? 'Cancellations'\n            : eventType.charAt(0) + eventType.slice(1).toLowerCase() + 's'}\n        </FilterBox>\n      )\n    },\n    [activeFilters]\n  )\n\n  const {\n    data: eventsData,\n    fetchNextPage,\n    hasNextPage,\n    isFetchingNextPage,\n    isSuccess,\n    isLoading: isActivityLoading,\n  } = useInfiniteQuery<ActivityEventResponse>(\n    [\n      'collectionActivity',\n      {\n        contractAddress,\n        activeFilters,\n        token_id,\n      },\n    ],\n    async ({ pageParam = '' }) => {\n      return await ActivityFetcher(\n        contractAddress,\n        {\n          token_id,\n          eventTypes: Object.keys(activeFilters)\n            .map((key) => key as ActivityEventType)\n            .filter((key) => activeFilters[key]),\n        },\n        pageParam\n      )\n    },\n    {\n      getNextPageParam: (lastPage) => {\n        return lastPage.events?.length === 25 ? lastPage.cursor : undefined\n      },\n      refetchInterval: 15000,\n      refetchIntervalInBackground: false,\n      refetchOnWindowFocus: false,\n      refetchOnMount: false,\n    }\n  )\n\n  const rarity = asset?.rarity?.providers?.length ? asset?.rarity?.providers?.[0] : undefined\n  const [showHolder, setShowHolder] = useState(false)\n  const rarityProviderLogo = getRarityProviderLogo(rarity?.provider)\n  const events = useMemo(\n    () => (isSuccess ? eventsData?.pages.map((page) => page.events).flat() : null),\n    [isSuccess, eventsData]\n  )\n\n  return (\n    <Column>\n      <MediaContainer>\n        {asset.imageUrl === undefined || showHolder ? (\n          <ContentNotAvailable>Content not available yet</ContentNotAvailable>\n        ) : assetMediaType === MediaType.Image ? (\n          <Img\n            className={styles.image}\n            src={asset.imageUrl}\n            alt={asset.name || collection.collectionName}\n            onError={() => setShowHolder(true)}\n          />\n        ) : (\n          <AssetView asset={asset} mediaType={assetMediaType} dominantColor={dominantColor} />\n        )}\n      </MediaContainer>\n      <AssetPriceDetailsContainer>\n        <AssetPriceDetails asset={asset} collection={collection} />\n      </AssetPriceDetailsContainer>\n      {asset.traits && (\n        <InfoContainer\n          data-testid=\"nft-details-traits\"\n          primaryHeader=\"Traits\"\n          defaultOpen\n          secondaryHeader={\n            rarityProvider && rarity && rarity.score ? (\n              <MouseoverTooltip\n                text={\n                  <HoverContainer>\n                    <HoverImageContainer>\n                      <img src={rarityProviderLogo} alt=\"cardLogo\" width={16} />\n                    </HoverImageContainer>\n                    <ContainerText>\n                      {`Ranking by ${rarity.provider === 'Genie' ? fallbackProvider : rarity.provider}`}\n                    </ContainerText>\n                  </HoverContainer>\n                }\n                placement=\"top\"\n              >\n                <RarityWrap>Rarity: {putCommas(rarity.score)}</RarityWrap>\n              </MouseoverTooltip>\n            ) : null\n          }\n        >\n          <TraitsContainer asset={asset} />\n        </InfoContainer>\n      )}\n      <InfoContainer\n        primaryHeader=\"Activity\"\n        defaultOpen\n        secondaryHeader={formattedPrice ? `Last Sale: ${formattedPrice} ETH` : undefined}\n        data-testid=\"nft-details-activity\"\n      >\n        <>\n          <ActivitySelectContainer $isHorizontalScroll>\n            <Filter eventType={ActivityEventType.Listing} />\n            <Filter eventType={ActivityEventType.Sale} />\n            <Filter eventType={ActivityEventType.Transfer} />\n            <Filter eventType={ActivityEventType.CancelListing} />\n          </ActivitySelectContainer>\n          {isActivityLoading && <LoadingAssetActivity rowCount={10} />}\n          {events && events.length > 0 ? (\n            <InfiniteScroll\n              next={fetchNextPage}\n              hasMore={!!hasNextPage}\n              loader={\n                isFetchingNextPage && (\n                  <Center>\n                    <LoadingSparkle />\n                  </Center>\n                )\n              }\n              dataLength={events?.length ?? 0}\n              scrollableTarget=\"activityContainer\"\n            >\n              <AssetActivity eventsData={{ events }} />\n            </InfiniteScroll>\n          ) : (\n            <>\n              {!isActivityLoading && (\n                <EmptyActivitiesContainer>\n                  <div>No activities yet</div>\n                  <Link to={`/nfts/collection/${asset.address}`}>View collection items</Link>{' '}\n                </EmptyActivitiesContainer>\n              )}\n            </>\n          )}\n        </>\n      </InfoContainer>\n      <InfoContainer\n        primaryHeader=\"Description\"\n        defaultOpen\n        secondaryHeader={null}\n        data-testid=\"nft-details-description\"\n      >\n        <>\n          <ByText>By </ByText>\n          {asset?.creator && asset.creator?.address && (\n            <AddressTextLink\n              href={`https://etherscan.io/address/${asset.creator.address}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              {shortenAddress(asset.creator.address, 2, 4)}\n            </AddressTextLink>\n          )}\n\n          <DescriptionText data-testid=\"nft-details-description-text\">\n            {collection.collectionDescription}\n          </DescriptionText>\n          <SocialsContainer>\n            {collection.externalUrl && <Resource name=\"Website\" link={`${collection.externalUrl}`} />}\n            {collection.twitterUrl && <Resource name=\"Twitter\" link={`https://twitter.com/${collection.twitterUrl}`} />}\n            {collection.discordUrl && <Resource name=\"Discord\" link={collection.discordUrl} />}\n          </SocialsContainer>\n        </>\n      </InfoContainer>\n      <InfoContainer primaryHeader=\"Details\" defaultOpen secondaryHeader={null} data-testid=\"nft-details-asset-details\">\n        <DetailsContainer asset={asset} collection={collection} />\n      </InfoContainer>\n    </Column>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}