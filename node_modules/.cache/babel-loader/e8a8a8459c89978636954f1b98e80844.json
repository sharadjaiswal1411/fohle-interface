{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{isAddress}from'@ethersproject/address';import{useWeb3React}from'@web3-react/core';import{useState}from'react';import{X}from'react-feather';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import{UNI}from'../../constants/tokens';import useENS from'../../hooks/useENS';import{useTokenBalance}from'../../state/connection/hooks';import{useDelegateCallback}from'../../state/governance/hooks';import{ThemedText}from'../../theme';import AddressInputPanel from'../AddressInputPanel';import{ButtonPrimary}from'../Button';import{AutoColumn}from'../Column';import Modal from'../Modal';import{LoadingView,SubmittedView}from'../ModalViews';import{RowBetween}from'../Row';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-1t2p2c9-0\"})([\"width:100%;padding:24px;\"]);var StyledClosed=_styled(X).withConfig({componentId:\"sc-1t2p2c9-1\"})([\":hover{cursor:pointer;}\"]);var TextButton=_styled.div.withConfig({componentId:\"sc-1t2p2c9-2\"})([\":hover{cursor:pointer;}\"]);export default function DelegateModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,title=_ref.title;var _useWeb3React=useWeb3React(),account=_useWeb3React.account,chainId=_useWeb3React.chainId;// state for delegate input\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),usingDelegate=_useState2[0],setUsingDelegate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),typed=_useState4[0],setTyped=_useState4[1];function handleRecipientType(val){setTyped(val);}// monitor for self delegation or input for third part delegate\n// default is self delegation\nvar activeDelegate=usingDelegate?typed:account;var _useENS=useENS(activeDelegate),parsedAddress=_useENS.address;// get the number of votes available to delegate\nvar uniBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,chainId?UNI[chainId]:undefined);var delegateCallback=useDelegateCallback();// monitor call to help UI loading state\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),hash=_useState6[0],setHash=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),attempting=_useState8[0],setAttempting=_useState8[1];// wrapper to reset state on modal close\nfunction wrappedOnDismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onDelegate(){return _onDelegate.apply(this,arguments);}function _onDelegate(){_onDelegate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _delegateCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(delegateCallback){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_delegateCallback=delegateCallback(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:undefined))===null||_delegateCallback===void 0?void 0:_delegateCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onDelegate.apply(this,arguments);}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOnDismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsx(ContentWrapper,{gap:\"lg\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.DeprecatedMediumHeader,{fontWeight:500,children:title}),/*#__PURE__*/_jsx(StyledClosed,{stroke:\"black\",onClick:wrappedOnDismiss})]}),/*#__PURE__*/_jsx(ThemedText.DeprecatedBody,{children:/*#__PURE__*/_jsx(Trans,{id:\"Earned UNI tokens represent voting shares in Uniswap governance.\"})}),/*#__PURE__*/_jsx(ThemedText.DeprecatedBody,{children:/*#__PURE__*/_jsx(Trans,{id:\"You can either vote on each proposal yourself or delegate your votes to a third party.\"})}),usingDelegate&&/*#__PURE__*/_jsx(AddressInputPanel,{value:typed,onChange:handleRecipientType}),/*#__PURE__*/_jsx(ButtonPrimary,{disabled:!isAddress(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:''),onClick:onDelegate,children:/*#__PURE__*/_jsx(ThemedText.DeprecatedMediumHeader,{color:\"white\",children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegate Votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Self Delegate\"})})}),/*#__PURE__*/_jsx(TextButton,{onClick:function onClick(){return setUsingDelegate(!usingDelegate);},children:/*#__PURE__*/_jsx(ThemedText.DeprecatedBlue,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Remove Delegate\"}):/*#__PURE__*/_jsx(Trans,{id:\"Add Delegate +\"})})})]})}),attempting&&!hash&&/*#__PURE__*/_jsx(LoadingView,{onDismiss:wrappedOnDismiss,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",justify:\"center\",children:[/*#__PURE__*/_jsx(ThemedText.DeprecatedLargeHeader,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegating votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Unlocking Votes\"})}),/*#__PURE__*/_jsxs(ThemedText.DeprecatedMain,{fontSize:36,children:[\" \",formatCurrencyAmount(uniBalance,4)]})]})}),hash&&/*#__PURE__*/_jsx(SubmittedView,{onDismiss:wrappedOnDismiss,hash:hash,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",justify:\"center\",children:[/*#__PURE__*/_jsx(ThemedText.DeprecatedLargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})}),/*#__PURE__*/_jsx(ThemedText.DeprecatedMain,{fontSize:36,children:formatCurrencyAmount(uniBalance,4)})]})})]});}","map":{"version":3,"names":["isAddress","useWeb3React","useState","X","formatCurrencyAmount","UNI","useENS","useTokenBalance","useDelegateCallback","ThemedText","AddressInputPanel","ButtonPrimary","AutoColumn","Modal","LoadingView","SubmittedView","RowBetween","ContentWrapper","styled","StyledClosed","TextButton","div","DelegateModal","isOpen","onDismiss","title","account","chainId","usingDelegate","setUsingDelegate","typed","setTyped","handleRecipientType","val","activeDelegate","parsedAddress","address","uniBalance","undefined","delegateCallback","hash","setHash","attempting","setAttempting","wrappedOnDismiss","onDelegate","catch","error","console","log"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/vote/DelegateModal.tsx"],"sourcesContent":["import { isAddress } from '@ethersproject/address'\nimport { Trans } from '@lingui/macro'\nimport { useWeb3React } from '@web3-react/core'\nimport { ReactNode, useState } from 'react'\nimport { X } from 'react-feather'\nimport styled from 'styled-components/macro'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\n\nimport { UNI } from '../../constants/tokens'\nimport useENS from '../../hooks/useENS'\nimport { useTokenBalance } from '../../state/connection/hooks'\nimport { useDelegateCallback } from '../../state/governance/hooks'\nimport { ThemedText } from '../../theme'\nimport AddressInputPanel from '../AddressInputPanel'\nimport { ButtonPrimary } from '../Button'\nimport { AutoColumn } from '../Column'\nimport Modal from '../Modal'\nimport { LoadingView, SubmittedView } from '../ModalViews'\nimport { RowBetween } from '../Row'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst TextButton = styled.div`\n  :hover {\n    cursor: pointer;\n  }\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  title: ReactNode\n}\n\nexport default function DelegateModal({ isOpen, onDismiss, title }: VoteModalProps) {\n  const { account, chainId } = useWeb3React()\n\n  // state for delegate input\n  const [usingDelegate, setUsingDelegate] = useState(false)\n  const [typed, setTyped] = useState('')\n  function handleRecipientType(val: string) {\n    setTyped(val)\n  }\n\n  // monitor for self delegation or input for third part delegate\n  // default is self delegation\n  const activeDelegate = usingDelegate ? typed : account\n  const { address: parsedAddress } = useENS(activeDelegate)\n\n  // get the number of votes available to delegate\n  const uniBalance = useTokenBalance(account ?? undefined, chainId ? UNI[chainId] : undefined)\n\n  const delegateCallback = useDelegateCallback()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState(false)\n\n  // wrapper to reset state on modal close\n  function wrappedOnDismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onDelegate() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!delegateCallback) return\n\n    // try delegation and store hash\n    const hash = await delegateCallback(parsedAddress ?? undefined)?.catch((error) => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOnDismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <ThemedText.DeprecatedMediumHeader fontWeight={500}>{title}</ThemedText.DeprecatedMediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOnDismiss} />\n            </RowBetween>\n            <ThemedText.DeprecatedBody>\n              <Trans>Earned UNI tokens represent voting shares in Uniswap governance.</Trans>\n            </ThemedText.DeprecatedBody>\n            <ThemedText.DeprecatedBody>\n              <Trans>You can either vote on each proposal yourself or delegate your votes to a third party.</Trans>\n            </ThemedText.DeprecatedBody>\n            {usingDelegate && <AddressInputPanel value={typed} onChange={handleRecipientType} />}\n            <ButtonPrimary disabled={!isAddress(parsedAddress ?? '')} onClick={onDelegate}>\n              <ThemedText.DeprecatedMediumHeader color=\"white\">\n                {usingDelegate ? <Trans>Delegate Votes</Trans> : <Trans>Self Delegate</Trans>}\n              </ThemedText.DeprecatedMediumHeader>\n            </ButtonPrimary>\n            <TextButton onClick={() => setUsingDelegate(!usingDelegate)}>\n              <ThemedText.DeprecatedBlue>\n                {usingDelegate ? <Trans>Remove Delegate</Trans> : <Trans>Add Delegate +</Trans>}\n              </ThemedText.DeprecatedBlue>\n            </TextButton>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <LoadingView onDismiss={wrappedOnDismiss}>\n          <AutoColumn gap=\"md\" justify=\"center\">\n            <ThemedText.DeprecatedLargeHeader>\n              {usingDelegate ? <Trans>Delegating votes</Trans> : <Trans>Unlocking Votes</Trans>}\n            </ThemedText.DeprecatedLargeHeader>\n            <ThemedText.DeprecatedMain fontSize={36}> {formatCurrencyAmount(uniBalance, 4)}</ThemedText.DeprecatedMain>\n          </AutoColumn>\n        </LoadingView>\n      )}\n      {hash && (\n        <SubmittedView onDismiss={wrappedOnDismiss} hash={hash}>\n          <AutoColumn gap=\"md\" justify=\"center\">\n            <ThemedText.DeprecatedLargeHeader>\n              <Trans>Transaction Submitted</Trans>\n            </ThemedText.DeprecatedLargeHeader>\n            <ThemedText.DeprecatedMain fontSize={36}>{formatCurrencyAmount(uniBalance, 4)}</ThemedText.DeprecatedMain>\n          </AutoColumn>\n        </SubmittedView>\n      )}\n    </Modal>\n  )\n}\n"],"mappings":"ykBAAA,OAASA,SAAS,KAAQ,wBAAwB,CAElD,OAASC,YAAY,KAAQ,kBAAkB,CAC/C,OAAoBC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,CAAC,KAAQ,eAAe,CAEjC,OAASC,oBAAoB,KAAQ,4BAA4B,CAEjE,OAASC,GAAG,KAAQ,wBAAwB,CAC5C,MAAOC,OAAM,KAAM,oBAAoB,CACvC,OAASC,eAAe,KAAQ,8BAA8B,CAC9D,OAASC,mBAAmB,KAAQ,8BAA8B,CAClE,OAASC,UAAU,KAAQ,aAAa,CACxC,MAAOC,kBAAiB,KAAM,sBAAsB,CACpD,OAASC,aAAa,KAAQ,WAAW,CACzC,OAASC,UAAU,KAAQ,WAAW,CACtC,MAAOC,MAAK,KAAM,UAAU,CAC5B,OAASC,WAAW,CAAEC,aAAa,KAAQ,eAAe,CAC1D,OAASC,UAAU,KAAQ,QAAQ,yFAEnC,GAAMC,eAAc,CAAGC,OAAM,CAACN,UAAU,CAAC,uEAGxC,CAED,GAAMO,aAAY,CAAGD,OAAM,CAACf,CAAC,CAAC,sEAI7B,CAED,GAAMiB,WAAU,CAAGF,OAAM,CAACG,GAAG,sEAI5B,CAQD,cAAe,SAASC,cAAa,MAA+C,IAA5CC,OAAM,MAANA,MAAM,CAAEC,SAAS,MAATA,SAAS,CAAEC,KAAK,MAALA,KAAK,CAC9D,kBAA6BxB,YAAY,EAAE,CAAnCyB,OAAO,eAAPA,OAAO,CAAEC,OAAO,eAAPA,OAAO,CAExB;AACA,cAA0CzB,QAAQ,CAAC,KAAK,CAAC,wCAAlD0B,aAAa,eAAEC,gBAAgB,eACtC,eAA0B3B,QAAQ,CAAC,EAAE,CAAC,yCAA/B4B,KAAK,eAAEC,QAAQ,eACtB,QAASC,oBAAmB,CAACC,GAAW,CAAE,CACxCF,QAAQ,CAACE,GAAG,CAAC,CACf,CAEA;AACA;AACA,GAAMC,eAAc,CAAGN,aAAa,CAAGE,KAAK,CAAGJ,OAAO,CACtD,YAAmCpB,MAAM,CAAC4B,cAAc,CAAC,CAAxCC,aAAa,SAAtBC,OAAO,CAEf;AACA,GAAMC,WAAU,CAAG9B,eAAe,CAACmB,OAAO,SAAPA,OAAO,UAAPA,OAAO,CAAIY,SAAS,CAAEX,OAAO,CAAGtB,GAAG,CAACsB,OAAO,CAAC,CAAGW,SAAS,CAAC,CAE5F,GAAMC,iBAAgB,CAAG/B,mBAAmB,EAAE,CAE9C;AACA,eAAwBN,QAAQ,EAAsB,yCAA/CsC,IAAI,eAAEC,OAAO,eACpB,eAAoCvC,QAAQ,CAAC,KAAK,CAAC,yCAA5CwC,UAAU,eAAEC,aAAa,eAEhC;AACA,QAASC,iBAAgB,EAAG,CAC1BH,OAAO,CAACH,SAAS,CAAC,CAClBK,aAAa,CAAC,KAAK,CAAC,CACpBnB,SAAS,EAAE,CACb,CAAC,QAEcqB,WAAU,wIAAzB,kKACEF,aAAa,CAAC,IAAI,CAAC,CAEnB;AAAA,GACKJ,gBAAgB,0GAGFA,gBAAgB,CAACJ,aAAa,SAAbA,aAAa,UAAbA,aAAa,CAAIG,SAAS,CAAC,4CAA5C,kBAA8CQ,KAAK,CAAC,SAACC,KAAK,CAAK,CAChFJ,aAAa,CAAC,KAAK,CAAC,CACpBK,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACpB,CAAC,CAAC,QAHIP,IAAI,eAKV,GAAIA,IAAI,CAAE,CACRC,OAAO,CAACD,IAAI,CAAC,CACf,CAAC,sDACF,6CAED,mBACE,MAAC,KAAK,EAAC,MAAM,CAAEjB,MAAO,CAAC,SAAS,CAAEqB,gBAAiB,CAAC,SAAS,CAAE,EAAG,WAC/D,CAACF,UAAU,EAAI,CAACF,IAAI,eACnB,KAAC,cAAc,EAAC,GAAG,CAAC,IAAI,uBACtB,MAAC,UAAU,EAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,wBACnC,MAAC,UAAU,yBACT,KAAC,UAAU,CAAC,sBAAsB,EAAC,UAAU,CAAE,GAAI,UAAEf,KAAK,EAAqC,cAC/F,KAAC,YAAY,EAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAEmB,gBAAiB,EAAG,GAC/C,cACb,KAAC,UAAU,CAAC,cAAc,wBACxB,mFAA+E,EACrD,cAC5B,KAAC,UAAU,CAAC,cAAc,wBACxB,yGAAqG,EAC3E,CAC3BhB,aAAa,eAAI,KAAC,iBAAiB,EAAC,KAAK,CAAEE,KAAM,CAAC,QAAQ,CAAEE,mBAAoB,EAAG,cACpF,KAAC,aAAa,EAAC,QAAQ,CAAE,CAAChC,SAAS,CAACmC,aAAa,SAAbA,aAAa,UAAbA,aAAa,CAAI,EAAE,CAAE,CAAC,OAAO,CAAEU,UAAW,uBAC5E,KAAC,UAAU,CAAC,sBAAsB,EAAC,KAAK,CAAC,OAAO,UAC7CjB,aAAa,cAAG,iCAA6B,cAAG,gCAA4B,EAC3C,EACtB,cAChB,KAAC,UAAU,EAAC,OAAO,CAAE,yBAAMC,iBAAgB,CAAC,CAACD,aAAa,CAAC,EAAC,uBAC1D,KAAC,UAAU,CAAC,cAAc,WACvBA,aAAa,cAAG,kCAA8B,cAAG,iCAA6B,EACrD,EACjB,GACF,EAEhB,CACAc,UAAU,EAAI,CAACF,IAAI,eAClB,KAAC,WAAW,EAAC,SAAS,CAAEI,gBAAiB,uBACvC,MAAC,UAAU,EAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,wBACnC,KAAC,UAAU,CAAC,qBAAqB,WAC9BhB,aAAa,cAAG,mCAA+B,cAAG,kCAA8B,EAChD,cACnC,MAAC,UAAU,CAAC,cAAc,EAAC,QAAQ,CAAE,EAAG,eAAGxB,oBAAoB,CAACiC,UAAU,CAAE,CAAC,CAAC,GAA6B,GAChG,EAEhB,CACAG,IAAI,eACH,KAAC,aAAa,EAAC,SAAS,CAAEI,gBAAiB,CAAC,IAAI,CAAEJ,IAAK,uBACrD,MAAC,UAAU,EAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,wBACnC,KAAC,UAAU,CAAC,qBAAqB,wBAC/B,wCAAoC,EACH,cACnC,KAAC,UAAU,CAAC,cAAc,EAAC,QAAQ,CAAE,EAAG,UAAEpC,oBAAoB,CAACiC,UAAU,CAAE,CAAC,CAAC,EAA6B,GAC/F,EAEhB,GACK,CAEZ"},"metadata":{},"sourceType":"module"}