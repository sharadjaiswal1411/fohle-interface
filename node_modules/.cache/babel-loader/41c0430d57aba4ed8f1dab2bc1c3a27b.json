{"ast":null,"code":"import{MixedRouteSDK,Protocol}from'@uniswap/router-sdk';import{CurrencyAmount,Token}from'@uniswap/sdk-core';import{Pair,Route as V2Route}from'@uniswap/v2-sdk';import{Pool,Route as V3Route}from'@uniswap/v3-sdk';import{InterfaceTrade}from'./types';/**\n * Transforms a Routing API quote into an array of routes that can be used to create\n * a `Trade`.\n */export function computeRoutes(currencyIn,currencyOut,tradeType,quoteResult){if(!quoteResult||!quoteResult.route||!currencyIn||!currencyOut)return undefined;if(quoteResult.route.length===0)return[];var parsedTokenIn=parseToken(quoteResult.route[0][0].tokenIn);var parsedTokenOut=parseToken(quoteResult.route[0][quoteResult.route[0].length-1].tokenOut);if(parsedTokenIn.address!==currencyIn.wrapped.address)return undefined;if(parsedTokenOut.address!==currencyOut.wrapped.address)return undefined;try{return quoteResult.route.map(function(route){if(route.length===0){throw new Error('Expected route to have at least one pair or pool');}var rawAmountIn=route[0].amountIn;var rawAmountOut=route[route.length-1].amountOut;if(!rawAmountIn||!rawAmountOut){throw new Error('Expected both amountIn and amountOut to be present');}var routeProtocol=getRouteProtocol(route);return{routev3:routeProtocol===Protocol.V3?new V3Route(route.map(genericPoolPairParser),currencyIn,currencyOut):null,routev2:routeProtocol===Protocol.V2?new V2Route(route.map(genericPoolPairParser),currencyIn,currencyOut):null,mixedRoute:routeProtocol===Protocol.MIXED?new MixedRouteSDK(route.map(genericPoolPairParser),currencyIn,currencyOut):null,inputAmount:CurrencyAmount.fromRawAmount(currencyIn,rawAmountIn),outputAmount:CurrencyAmount.fromRawAmount(currencyOut,rawAmountOut)};});}catch(e){// `Route` constructor may throw if inputs/outputs are temporarily out of sync\n// (RTK-Query always returns the latest data which may not be the right inputs/outputs)\n// This is not fatal and will fix itself in future render cycles\nconsole.error(e);return undefined;}}export function transformRoutesToTrade(route,tradeType,blockNumber,gasUseEstimateUSD){var _route$filter$map,_route$filter$map2,_route$filter$map3;return new InterfaceTrade({v2Routes:(_route$filter$map=route===null||route===void 0?void 0:route.filter(function(r){return r.routev2!==null;}).map(function(_ref){var routev2=_ref.routev2,inputAmount=_ref.inputAmount,outputAmount=_ref.outputAmount;return{routev2:routev2,inputAmount:inputAmount,outputAmount:outputAmount};}))!==null&&_route$filter$map!==void 0?_route$filter$map:[],v3Routes:(_route$filter$map2=route===null||route===void 0?void 0:route.filter(function(r){return r.routev3!==null;}).map(function(_ref2){var routev3=_ref2.routev3,inputAmount=_ref2.inputAmount,outputAmount=_ref2.outputAmount;return{routev3:routev3,inputAmount:inputAmount,outputAmount:outputAmount};}))!==null&&_route$filter$map2!==void 0?_route$filter$map2:[],mixedRoutes:(_route$filter$map3=route===null||route===void 0?void 0:route.filter(function(r){return r.mixedRoute!==null;}).map(function(_ref3){var mixedRoute=_ref3.mixedRoute,inputAmount=_ref3.inputAmount,outputAmount=_ref3.outputAmount;return{mixedRoute:mixedRoute,inputAmount:inputAmount,outputAmount:outputAmount};}))!==null&&_route$filter$map3!==void 0?_route$filter$map3:[],tradeType:tradeType,gasUseEstimateUSD:gasUseEstimateUSD,blockNumber:blockNumber});}var parseToken=function parseToken(_ref4){var address=_ref4.address,chainId=_ref4.chainId,decimals=_ref4.decimals,symbol=_ref4.symbol;return new Token(chainId,address,parseInt(decimals.toString()),symbol);};var parsePool=function parsePool(_ref5){var fee=_ref5.fee,sqrtRatioX96=_ref5.sqrtRatioX96,liquidity=_ref5.liquidity,tickCurrent=_ref5.tickCurrent,tokenIn=_ref5.tokenIn,tokenOut=_ref5.tokenOut;return new Pool(parseToken(tokenIn),parseToken(tokenOut),parseInt(fee),sqrtRatioX96,liquidity,parseInt(tickCurrent));};var parsePair=function parsePair(_ref6){var reserve0=_ref6.reserve0,reserve1=_ref6.reserve1;return new Pair(CurrencyAmount.fromRawAmount(parseToken(reserve0.token),reserve0.quotient),CurrencyAmount.fromRawAmount(parseToken(reserve1.token),reserve1.quotient));};var genericPoolPairParser=function genericPoolPairParser(pool){return pool.type==='v3-pool'?parsePool(pool):parsePair(pool);};function getRouteProtocol(route){if(route.every(function(pool){return pool.type==='v2-pool';}))return Protocol.V2;if(route.every(function(pool){return pool.type==='v3-pool';}))return Protocol.V3;return Protocol.MIXED;}","map":{"version":3,"names":["MixedRouteSDK","Protocol","CurrencyAmount","Token","Pair","Route","V2Route","Pool","V3Route","InterfaceTrade","computeRoutes","currencyIn","currencyOut","tradeType","quoteResult","route","undefined","length","parsedTokenIn","parseToken","tokenIn","parsedTokenOut","tokenOut","address","wrapped","map","Error","rawAmountIn","amountIn","rawAmountOut","amountOut","routeProtocol","getRouteProtocol","routev3","V3","genericPoolPairParser","routev2","V2","mixedRoute","MIXED","inputAmount","fromRawAmount","outputAmount","e","console","error","transformRoutesToTrade","blockNumber","gasUseEstimateUSD","v2Routes","filter","r","v3Routes","mixedRoutes","chainId","decimals","symbol","parseInt","toString","parsePool","fee","sqrtRatioX96","liquidity","tickCurrent","parsePair","reserve0","reserve1","token","quotient","pool","type","every"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/state/routing/utils.ts"],"sourcesContent":["import { MixedRouteSDK, Protocol } from '@uniswap/router-sdk'\nimport { Currency, CurrencyAmount, Token, TradeType } from '@uniswap/sdk-core'\nimport { Pair, Route as V2Route } from '@uniswap/v2-sdk'\nimport { FeeAmount, Pool, Route as V3Route } from '@uniswap/v3-sdk'\n\nimport { GetQuoteResult, InterfaceTrade, V2PoolInRoute, V3PoolInRoute } from './types'\n\n/**\n * Transforms a Routing API quote into an array of routes that can be used to create\n * a `Trade`.\n */\nexport function computeRoutes(\n  currencyIn: Currency | undefined,\n  currencyOut: Currency | undefined,\n  tradeType: TradeType,\n  quoteResult: Pick<GetQuoteResult, 'route'> | undefined\n) {\n  if (!quoteResult || !quoteResult.route || !currencyIn || !currencyOut) return undefined\n\n  if (quoteResult.route.length === 0) return []\n\n  const parsedTokenIn = parseToken(quoteResult.route[0][0].tokenIn)\n  const parsedTokenOut = parseToken(quoteResult.route[0][quoteResult.route[0].length - 1].tokenOut)\n\n  if (parsedTokenIn.address !== currencyIn.wrapped.address) return undefined\n  if (parsedTokenOut.address !== currencyOut.wrapped.address) return undefined\n\n  try {\n    return quoteResult.route.map((route) => {\n      if (route.length === 0) {\n        throw new Error('Expected route to have at least one pair or pool')\n      }\n      const rawAmountIn = route[0].amountIn\n      const rawAmountOut = route[route.length - 1].amountOut\n\n      if (!rawAmountIn || !rawAmountOut) {\n        throw new Error('Expected both amountIn and amountOut to be present')\n      }\n\n      const routeProtocol = getRouteProtocol(route)\n\n      return {\n        routev3:\n          routeProtocol === Protocol.V3\n            ? new V3Route(route.map(genericPoolPairParser) as Pool[], currencyIn, currencyOut)\n            : null,\n        routev2:\n          routeProtocol === Protocol.V2\n            ? new V2Route(route.map(genericPoolPairParser) as Pair[], currencyIn, currencyOut)\n            : null,\n        mixedRoute:\n          routeProtocol === Protocol.MIXED\n            ? new MixedRouteSDK(route.map(genericPoolPairParser), currencyIn, currencyOut)\n            : null,\n        inputAmount: CurrencyAmount.fromRawAmount(currencyIn, rawAmountIn),\n        outputAmount: CurrencyAmount.fromRawAmount(currencyOut, rawAmountOut),\n      }\n    })\n  } catch (e) {\n    // `Route` constructor may throw if inputs/outputs are temporarily out of sync\n    // (RTK-Query always returns the latest data which may not be the right inputs/outputs)\n    // This is not fatal and will fix itself in future render cycles\n    console.error(e)\n    return undefined\n  }\n}\n\nexport function transformRoutesToTrade<TTradeType extends TradeType>(\n  route: ReturnType<typeof computeRoutes>,\n  tradeType: TTradeType,\n  blockNumber?: string | null,\n  gasUseEstimateUSD?: CurrencyAmount<Token> | null\n): InterfaceTrade<Currency, Currency, TTradeType> {\n  return new InterfaceTrade({\n    v2Routes:\n      route\n        ?.filter((r): r is typeof route[0] & { routev2: NonNullable<typeof route[0]['routev2']> } => r.routev2 !== null)\n        .map(({ routev2, inputAmount, outputAmount }) => ({ routev2, inputAmount, outputAmount })) ?? [],\n    v3Routes:\n      route\n        ?.filter((r): r is typeof route[0] & { routev3: NonNullable<typeof route[0]['routev3']> } => r.routev3 !== null)\n        .map(({ routev3, inputAmount, outputAmount }) => ({ routev3, inputAmount, outputAmount })) ?? [],\n    mixedRoutes:\n      route\n        ?.filter(\n          (r): r is typeof route[0] & { mixedRoute: NonNullable<typeof route[0]['mixedRoute']> } =>\n            r.mixedRoute !== null\n        )\n        .map(({ mixedRoute, inputAmount, outputAmount }) => ({ mixedRoute, inputAmount, outputAmount })) ?? [],\n    tradeType,\n    gasUseEstimateUSD,\n    blockNumber,\n  })\n}\n\nconst parseToken = ({ address, chainId, decimals, symbol }: GetQuoteResult['route'][0][0]['tokenIn']): Token => {\n  return new Token(chainId, address, parseInt(decimals.toString()), symbol)\n}\n\nconst parsePool = ({ fee, sqrtRatioX96, liquidity, tickCurrent, tokenIn, tokenOut }: V3PoolInRoute): Pool =>\n  new Pool(\n    parseToken(tokenIn),\n    parseToken(tokenOut),\n    parseInt(fee) as FeeAmount,\n    sqrtRatioX96,\n    liquidity,\n    parseInt(tickCurrent)\n  )\n\nconst parsePair = ({ reserve0, reserve1 }: V2PoolInRoute): Pair =>\n  new Pair(\n    CurrencyAmount.fromRawAmount(parseToken(reserve0.token), reserve0.quotient),\n    CurrencyAmount.fromRawAmount(parseToken(reserve1.token), reserve1.quotient)\n  )\n\nconst genericPoolPairParser = (pool: V3PoolInRoute | V2PoolInRoute): Pool | Pair => {\n  return pool.type === 'v3-pool' ? parsePool(pool) : parsePair(pool)\n}\n\nfunction getRouteProtocol(route: (V3PoolInRoute | V2PoolInRoute)[]): Protocol {\n  if (route.every((pool) => pool.type === 'v2-pool')) return Protocol.V2\n  if (route.every((pool) => pool.type === 'v3-pool')) return Protocol.V3\n  return Protocol.MIXED\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}