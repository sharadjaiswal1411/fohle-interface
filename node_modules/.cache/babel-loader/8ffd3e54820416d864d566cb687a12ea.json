{"ast":null,"code":"import { BigNumber } from '@ethersproject/bignumber';\nimport { Protocol } from '@uniswap/router-sdk';\nimport { CurrencyAmount, Token, TradeType } from '@uniswap/sdk-core';\nimport { FeeAmount } from '@uniswap/v3-sdk';\nimport _ from 'lodash';\nimport { MixedRouteWithValidQuote, usdGasTokensByChain, V2RouteWithValidQuote, V3RouteWithValidQuote } from '../routers';\nimport { ChainId, log, WRAPPED_NATIVE_CURRENCY } from '../util';\nimport { buildTrade } from './methodParameters';\nexport async function getV2NativePool(token, poolProvider) {\n  const chainId = token.chainId;\n  const weth = WRAPPED_NATIVE_CURRENCY[chainId];\n  const poolAccessor = await poolProvider.getPools([[weth, token]]);\n  const pool = poolAccessor.getPool(weth, token);\n  if (!pool || pool.reserve0.equalTo(0) || pool.reserve1.equalTo(0)) {\n    log.error({\n      weth,\n      token,\n      reserve0: pool === null || pool === void 0 ? void 0 : pool.reserve0.toExact(),\n      reserve1: pool === null || pool === void 0 ? void 0 : pool.reserve1.toExact()\n    }, `Could not find a valid WETH pool with ${token.symbol} for computing gas costs.`);\n    return null;\n  }\n  return pool;\n}\nexport async function getHighestLiquidityV3NativePool(token, poolProvider) {\n  const nativeCurrency = WRAPPED_NATIVE_CURRENCY[token.chainId];\n  const nativePools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW]).map(feeAmount => {\n    return [nativeCurrency, token, feeAmount];\n  }).value();\n  const poolAccessor = await poolProvider.getPools(nativePools);\n  const pools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW]).map(feeAmount => {\n    return poolAccessor.getPool(nativeCurrency, token, feeAmount);\n  }).compact().value();\n  if (pools.length == 0) {\n    log.error({\n      pools\n    }, `Could not find a ${nativeCurrency.symbol} pool with ${token.symbol} for computing gas costs.`);\n    return null;\n  }\n  const maxPool = _.maxBy(pools, pool => pool.liquidity);\n  return maxPool;\n}\nexport async function getHighestLiquidityV3USDPool(chainId, poolProvider) {\n  const usdTokens = usdGasTokensByChain[chainId];\n  const wrappedCurrency = WRAPPED_NATIVE_CURRENCY[chainId];\n  if (!usdTokens) {\n    throw new Error(`Could not find a USD token for computing gas costs on ${chainId}`);\n  }\n  const usdPools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW, FeeAmount.LOWEST]).flatMap(feeAmount => {\n    return _.map(usdTokens, usdToken => [wrappedCurrency, usdToken, feeAmount]);\n  }).value();\n  const poolAccessor = await poolProvider.getPools(usdPools);\n  const pools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW, FeeAmount.LOWEST]).flatMap(feeAmount => {\n    const pools = [];\n    for (const usdToken of usdTokens) {\n      const pool = poolAccessor.getPool(wrappedCurrency, usdToken, feeAmount);\n      if (pool) {\n        pools.push(pool);\n      }\n    }\n    return pools;\n  }).compact().value();\n  if (pools.length == 0) {\n    const message = `Could not find a USD/${wrappedCurrency.symbol} pool for computing gas costs.`;\n    log.error({\n      pools\n    }, message);\n    throw new Error(message);\n  }\n  const maxPool = _.maxBy(pools, pool => pool.liquidity);\n  return maxPool;\n}\nexport function getGasCostInUSD(usdPool, costNativeCurrency) {\n  const nativeCurrency = costNativeCurrency.currency;\n  // convert fee into usd\n  const nativeTokenPrice = usdPool.token0.address == nativeCurrency.address ? usdPool.token0Price : usdPool.token1Price;\n  const gasCostUSD = nativeTokenPrice.quote(costNativeCurrency);\n  return gasCostUSD;\n}\nexport function getGasCostInNativeCurrency(nativeCurrency, gasCostInWei) {\n  // wrap fee to native currency\n  const costNativeCurrency = CurrencyAmount.fromRawAmount(nativeCurrency, gasCostInWei.toString());\n  return costNativeCurrency;\n}\nexport async function getGasCostInQuoteToken(quoteToken, nativePool, costNativeCurrency) {\n  const nativeTokenPrice = nativePool.token0.address == quoteToken.address ? nativePool.token1Price : nativePool.token0Price;\n  const gasCostQuoteToken = nativeTokenPrice.quote(costNativeCurrency);\n  return gasCostQuoteToken;\n}\nexport function calculateArbitrumToL1FeeFromCalldata(calldata, gasData) {\n  const {\n    perL2TxFee,\n    perL1CalldataFee\n  } = gasData;\n  // calculates gas amounts based on bytes of calldata, use 0 as overhead.\n  const l1GasUsed = getL2ToL1GasUsed(calldata, BigNumber.from(0));\n  // multiply by the fee per calldata and add the flat l2 fee\n  let l1Fee = l1GasUsed.mul(perL1CalldataFee);\n  l1Fee = l1Fee.add(perL2TxFee);\n  return [l1GasUsed, l1Fee];\n}\nexport function calculateOptimismToL1FeeFromCalldata(calldata, gasData) {\n  const {\n    l1BaseFee,\n    scalar,\n    decimals,\n    overhead\n  } = gasData;\n  const l1GasUsed = getL2ToL1GasUsed(calldata, overhead);\n  // l1BaseFee is L1 Gas Price on etherscan\n  const l1Fee = l1GasUsed.mul(l1BaseFee);\n  const unscaled = l1Fee.mul(scalar);\n  // scaled = unscaled / (10 ** decimals)\n  const scaledConversion = BigNumber.from(10).pow(decimals);\n  const scaled = unscaled.div(scaledConversion);\n  return [l1GasUsed, scaled];\n}\n// based on the code from the optimism OVM_GasPriceOracle contract\nexport function getL2ToL1GasUsed(data, overhead) {\n  // data is hex encoded\n  const dataArr = data.slice(2).match(/.{1,2}/g);\n  const numBytes = dataArr.length;\n  let count = 0;\n  for (let i = 0; i < numBytes; i += 1) {\n    const byte = parseInt(dataArr[i], 16);\n    if (byte == 0) {\n      count += 4;\n    } else {\n      count += 16;\n    }\n  }\n  const unsigned = overhead.add(count);\n  const signedConversion = 68 * 16;\n  return unsigned.add(signedConversion);\n}\nexport async function calculateGasUsed(chainId, route, simulatedGasUsed, v2PoolProvider, v3PoolProvider, l2GasData) {\n  const quoteToken = route.quote.currency.wrapped;\n  const gasPriceWei = route.gasPriceWei;\n  // calculate L2 to L1 security fee if relevant\n  let l2toL1FeeInWei = BigNumber.from(0);\n  if ([ChainId.ARBITRUM_ONE, ChainId.ARBITRUM_RINKEBY].includes(chainId)) {\n    l2toL1FeeInWei = calculateArbitrumToL1FeeFromCalldata(route.methodParameters.calldata, l2GasData)[1];\n  } else if ([ChainId.OPTIMISM, ChainId.OPTIMISTIC_KOVAN].includes(chainId)) {\n    l2toL1FeeInWei = calculateOptimismToL1FeeFromCalldata(route.methodParameters.calldata, l2GasData)[1];\n  }\n  // add l2 to l1 fee and wrap fee to native currency\n  const gasCostInWei = gasPriceWei.mul(simulatedGasUsed).add(l2toL1FeeInWei);\n  const nativeCurrency = WRAPPED_NATIVE_CURRENCY[chainId];\n  const costNativeCurrency = getGasCostInNativeCurrency(nativeCurrency, gasCostInWei);\n  const usdPool = await getHighestLiquidityV3USDPool(chainId, v3PoolProvider);\n  const gasCostUSD = await getGasCostInUSD(usdPool, costNativeCurrency);\n  let gasCostQuoteToken = costNativeCurrency;\n  // get fee in terms of quote token\n  if (!quoteToken.equals(nativeCurrency)) {\n    const nativePools = await Promise.all([getHighestLiquidityV3NativePool(quoteToken, v3PoolProvider), getV2NativePool(quoteToken, v2PoolProvider)]);\n    const nativePool = nativePools.find(pool => pool !== null);\n    if (!nativePool) {\n      log.info('Could not find any V2 or V3 pools to convert the cost into the quote token');\n      gasCostQuoteToken = CurrencyAmount.fromRawAmount(quoteToken, 0);\n    } else {\n      gasCostQuoteToken = await getGasCostInQuoteToken(quoteToken, nativePool, costNativeCurrency);\n    }\n  }\n  // Adjust quote for gas fees\n  let quoteGasAdjusted;\n  if (route.trade.tradeType == TradeType.EXACT_OUTPUT) {\n    // Exact output - need more of tokenIn to get the desired amount of tokenOut\n    quoteGasAdjusted = route.quote.add(gasCostQuoteToken);\n  } else {\n    // Exact input - can get less of tokenOut due to fees\n    quoteGasAdjusted = route.quote.subtract(gasCostQuoteToken);\n  }\n  return {\n    estimatedGasUsedUSD: gasCostUSD,\n    estimatedGasUsedQuoteToken: gasCostQuoteToken,\n    quoteGasAdjusted: quoteGasAdjusted\n  };\n}\nexport function initSwapRouteFromExisting(swapRoute, v2PoolProvider, v3PoolProvider, quoteGasAdjusted, estimatedGasUsed, estimatedGasUsedQuoteToken, estimatedGasUsedUSD) {\n  const currencyIn = swapRoute.trade.inputAmount.currency;\n  const currencyOut = swapRoute.trade.outputAmount.currency;\n  const tradeType = swapRoute.trade.tradeType.valueOf() ? TradeType.EXACT_OUTPUT : TradeType.EXACT_INPUT;\n  const routesWithValidQuote = swapRoute.route.map(route => {\n    switch (route.protocol) {\n      case Protocol.V3:\n        return new V3RouteWithValidQuote({\n          amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n          rawQuote: BigNumber.from(route.rawQuote),\n          sqrtPriceX96AfterList: route.sqrtPriceX96AfterList.map(num => BigNumber.from(num)),\n          initializedTicksCrossedList: [...route.initializedTicksCrossedList],\n          quoterGasEstimate: BigNumber.from(route.gasEstimate),\n          percent: route.percent,\n          route: route.route,\n          gasModel: route.gasModel,\n          quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n          tradeType: tradeType,\n          v3PoolProvider: v3PoolProvider\n        });\n      case Protocol.V2:\n        return new V2RouteWithValidQuote({\n          amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n          rawQuote: BigNumber.from(route.rawQuote),\n          percent: route.percent,\n          route: route.route,\n          gasModel: route.gasModel,\n          quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n          tradeType: tradeType,\n          v2PoolProvider: v2PoolProvider\n        });\n      case Protocol.MIXED:\n        return new MixedRouteWithValidQuote({\n          amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n          rawQuote: BigNumber.from(route.rawQuote),\n          sqrtPriceX96AfterList: route.sqrtPriceX96AfterList.map(num => BigNumber.from(num)),\n          initializedTicksCrossedList: [...route.initializedTicksCrossedList],\n          quoterGasEstimate: BigNumber.from(route.gasEstimate),\n          percent: route.percent,\n          route: route.route,\n          mixedRouteGasModel: route.gasModel,\n          v2PoolProvider,\n          quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n          tradeType: tradeType,\n          v3PoolProvider: v3PoolProvider\n        });\n    }\n  });\n  const trade = buildTrade(currencyIn, currencyOut, tradeType, routesWithValidQuote);\n  return {\n    quote: swapRoute.quote,\n    quoteGasAdjusted,\n    estimatedGasUsed,\n    estimatedGasUsedQuoteToken,\n    estimatedGasUsedUSD,\n    gasPriceWei: BigNumber.from(swapRoute.gasPriceWei),\n    trade,\n    route: routesWithValidQuote,\n    blockNumber: BigNumber.from(swapRoute.blockNumber),\n    methodParameters: swapRoute.methodParameters ? {\n      calldata: swapRoute.methodParameters.calldata,\n      value: swapRoute.methodParameters.value\n    } : undefined\n  };\n}","map":{"version":3,"sources":["../../../src/util/gas-factory-helpers.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { BigNumber } from '@ethersproject/bignumber';\nimport { Protocol } from '@uniswap/router-sdk';\nimport { CurrencyAmount, Token, TradeType } from '@uniswap/sdk-core';\nimport { FeeAmount } from '@uniswap/v3-sdk';\nimport _ from 'lodash';\nimport { MixedRouteWithValidQuote, usdGasTokensByChain, V2RouteWithValidQuote, V3RouteWithValidQuote, } from '../routers';\nimport { ChainId, log, WRAPPED_NATIVE_CURRENCY } from '../util';\nimport { buildTrade } from './methodParameters';\nexport async function getV2NativePool(token, poolProvider) {\n    const chainId = token.chainId;\n    const weth = WRAPPED_NATIVE_CURRENCY[chainId];\n    const poolAccessor = await poolProvider.getPools([[weth, token]]);\n    const pool = poolAccessor.getPool(weth, token);\n    if (!pool || pool.reserve0.equalTo(0) || pool.reserve1.equalTo(0)) {\n        log.error({\n            weth,\n            token,\n            reserve0: pool === null || pool === void 0 ? void 0 : pool.reserve0.toExact(),\n            reserve1: pool === null || pool === void 0 ? void 0 : pool.reserve1.toExact(),\n        }, `Could not find a valid WETH pool with ${token.symbol} for computing gas costs.`);\n        return null;\n    }\n    return pool;\n}\nexport async function getHighestLiquidityV3NativePool(token, poolProvider) {\n    const nativeCurrency = WRAPPED_NATIVE_CURRENCY[token.chainId];\n    const nativePools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW])\n        .map((feeAmount) => {\n        return [nativeCurrency, token, feeAmount];\n    })\n        .value();\n    const poolAccessor = await poolProvider.getPools(nativePools);\n    const pools = _([FeeAmount.HIGH, FeeAmount.MEDIUM, FeeAmount.LOW])\n        .map((feeAmount) => {\n        return poolAccessor.getPool(nativeCurrency, token, feeAmount);\n    })\n        .compact()\n        .value();\n    if (pools.length == 0) {\n        log.error({ pools }, `Could not find a ${nativeCurrency.symbol} pool with ${token.symbol} for computing gas costs.`);\n        return null;\n    }\n    const maxPool = _.maxBy(pools, (pool) => pool.liquidity);\n    return maxPool;\n}\nexport async function getHighestLiquidityV3USDPool(chainId, poolProvider) {\n    const usdTokens = usdGasTokensByChain[chainId];\n    const wrappedCurrency = WRAPPED_NATIVE_CURRENCY[chainId];\n    if (!usdTokens) {\n        throw new Error(`Could not find a USD token for computing gas costs on ${chainId}`);\n    }\n    const usdPools = _([\n        FeeAmount.HIGH,\n        FeeAmount.MEDIUM,\n        FeeAmount.LOW,\n        FeeAmount.LOWEST,\n    ])\n        .flatMap((feeAmount) => {\n        return _.map(usdTokens, (usdToken) => [\n            wrappedCurrency,\n            usdToken,\n            feeAmount,\n        ]);\n    })\n        .value();\n    const poolAccessor = await poolProvider.getPools(usdPools);\n    const pools = _([\n        FeeAmount.HIGH,\n        FeeAmount.MEDIUM,\n        FeeAmount.LOW,\n        FeeAmount.LOWEST,\n    ])\n        .flatMap((feeAmount) => {\n        const pools = [];\n        for (const usdToken of usdTokens) {\n            const pool = poolAccessor.getPool(wrappedCurrency, usdToken, feeAmount);\n            if (pool) {\n                pools.push(pool);\n            }\n        }\n        return pools;\n    })\n        .compact()\n        .value();\n    if (pools.length == 0) {\n        const message = `Could not find a USD/${wrappedCurrency.symbol} pool for computing gas costs.`;\n        log.error({ pools }, message);\n        throw new Error(message);\n    }\n    const maxPool = _.maxBy(pools, (pool) => pool.liquidity);\n    return maxPool;\n}\nexport function getGasCostInUSD(usdPool, costNativeCurrency) {\n    const nativeCurrency = costNativeCurrency.currency;\n    // convert fee into usd\n    const nativeTokenPrice = usdPool.token0.address == nativeCurrency.address\n        ? usdPool.token0Price\n        : usdPool.token1Price;\n    const gasCostUSD = nativeTokenPrice.quote(costNativeCurrency);\n    return gasCostUSD;\n}\nexport function getGasCostInNativeCurrency(nativeCurrency, gasCostInWei) {\n    // wrap fee to native currency\n    const costNativeCurrency = CurrencyAmount.fromRawAmount(nativeCurrency, gasCostInWei.toString());\n    return costNativeCurrency;\n}\nexport async function getGasCostInQuoteToken(quoteToken, nativePool, costNativeCurrency) {\n    const nativeTokenPrice = nativePool.token0.address == quoteToken.address\n        ? nativePool.token1Price\n        : nativePool.token0Price;\n    const gasCostQuoteToken = nativeTokenPrice.quote(costNativeCurrency);\n    return gasCostQuoteToken;\n}\nexport function calculateArbitrumToL1FeeFromCalldata(calldata, gasData) {\n    const { perL2TxFee, perL1CalldataFee } = gasData;\n    // calculates gas amounts based on bytes of calldata, use 0 as overhead.\n    const l1GasUsed = getL2ToL1GasUsed(calldata, BigNumber.from(0));\n    // multiply by the fee per calldata and add the flat l2 fee\n    let l1Fee = l1GasUsed.mul(perL1CalldataFee);\n    l1Fee = l1Fee.add(perL2TxFee);\n    return [l1GasUsed, l1Fee];\n}\nexport function calculateOptimismToL1FeeFromCalldata(calldata, gasData) {\n    const { l1BaseFee, scalar, decimals, overhead } = gasData;\n    const l1GasUsed = getL2ToL1GasUsed(calldata, overhead);\n    // l1BaseFee is L1 Gas Price on etherscan\n    const l1Fee = l1GasUsed.mul(l1BaseFee);\n    const unscaled = l1Fee.mul(scalar);\n    // scaled = unscaled / (10 ** decimals)\n    const scaledConversion = BigNumber.from(10).pow(decimals);\n    const scaled = unscaled.div(scaledConversion);\n    return [l1GasUsed, scaled];\n}\n// based on the code from the optimism OVM_GasPriceOracle contract\nexport function getL2ToL1GasUsed(data, overhead) {\n    // data is hex encoded\n    const dataArr = data.slice(2).match(/.{1,2}/g);\n    const numBytes = dataArr.length;\n    let count = 0;\n    for (let i = 0; i < numBytes; i += 1) {\n        const byte = parseInt(dataArr[i], 16);\n        if (byte == 0) {\n            count += 4;\n        }\n        else {\n            count += 16;\n        }\n    }\n    const unsigned = overhead.add(count);\n    const signedConversion = 68 * 16;\n    return unsigned.add(signedConversion);\n}\nexport async function calculateGasUsed(chainId, route, simulatedGasUsed, v2PoolProvider, v3PoolProvider, l2GasData) {\n    const quoteToken = route.quote.currency.wrapped;\n    const gasPriceWei = route.gasPriceWei;\n    // calculate L2 to L1 security fee if relevant\n    let l2toL1FeeInWei = BigNumber.from(0);\n    if ([ChainId.ARBITRUM_ONE, ChainId.ARBITRUM_RINKEBY].includes(chainId)) {\n        l2toL1FeeInWei = calculateArbitrumToL1FeeFromCalldata(route.methodParameters.calldata, l2GasData)[1];\n    }\n    else if ([ChainId.OPTIMISM, ChainId.OPTIMISTIC_KOVAN].includes(chainId)) {\n        l2toL1FeeInWei = calculateOptimismToL1FeeFromCalldata(route.methodParameters.calldata, l2GasData)[1];\n    }\n    // add l2 to l1 fee and wrap fee to native currency\n    const gasCostInWei = gasPriceWei.mul(simulatedGasUsed).add(l2toL1FeeInWei);\n    const nativeCurrency = WRAPPED_NATIVE_CURRENCY[chainId];\n    const costNativeCurrency = getGasCostInNativeCurrency(nativeCurrency, gasCostInWei);\n    const usdPool = await getHighestLiquidityV3USDPool(chainId, v3PoolProvider);\n    const gasCostUSD = await getGasCostInUSD(usdPool, costNativeCurrency);\n    let gasCostQuoteToken = costNativeCurrency;\n    // get fee in terms of quote token\n    if (!quoteToken.equals(nativeCurrency)) {\n        const nativePools = await Promise.all([\n            getHighestLiquidityV3NativePool(quoteToken, v3PoolProvider),\n            getV2NativePool(quoteToken, v2PoolProvider),\n        ]);\n        const nativePool = nativePools.find((pool) => pool !== null);\n        if (!nativePool) {\n            log.info('Could not find any V2 or V3 pools to convert the cost into the quote token');\n            gasCostQuoteToken = CurrencyAmount.fromRawAmount(quoteToken, 0);\n        }\n        else {\n            gasCostQuoteToken = await getGasCostInQuoteToken(quoteToken, nativePool, costNativeCurrency);\n        }\n    }\n    // Adjust quote for gas fees\n    let quoteGasAdjusted;\n    if (route.trade.tradeType == TradeType.EXACT_OUTPUT) {\n        // Exact output - need more of tokenIn to get the desired amount of tokenOut\n        quoteGasAdjusted = route.quote.add(gasCostQuoteToken);\n    }\n    else {\n        // Exact input - can get less of tokenOut due to fees\n        quoteGasAdjusted = route.quote.subtract(gasCostQuoteToken);\n    }\n    return {\n        estimatedGasUsedUSD: gasCostUSD,\n        estimatedGasUsedQuoteToken: gasCostQuoteToken,\n        quoteGasAdjusted: quoteGasAdjusted,\n    };\n}\nexport function initSwapRouteFromExisting(swapRoute, v2PoolProvider, v3PoolProvider, quoteGasAdjusted, estimatedGasUsed, estimatedGasUsedQuoteToken, estimatedGasUsedUSD) {\n    const currencyIn = swapRoute.trade.inputAmount.currency;\n    const currencyOut = swapRoute.trade.outputAmount.currency;\n    const tradeType = swapRoute.trade.tradeType.valueOf()\n        ? TradeType.EXACT_OUTPUT\n        : TradeType.EXACT_INPUT;\n    const routesWithValidQuote = swapRoute.route.map((route) => {\n        switch (route.protocol) {\n            case Protocol.V3:\n                return new V3RouteWithValidQuote({\n                    amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n                    rawQuote: BigNumber.from(route.rawQuote),\n                    sqrtPriceX96AfterList: route.sqrtPriceX96AfterList.map((num) => BigNumber.from(num)),\n                    initializedTicksCrossedList: [...route.initializedTicksCrossedList],\n                    quoterGasEstimate: BigNumber.from(route.gasEstimate),\n                    percent: route.percent,\n                    route: route.route,\n                    gasModel: route.gasModel,\n                    quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n                    tradeType: tradeType,\n                    v3PoolProvider: v3PoolProvider,\n                });\n            case Protocol.V2:\n                return new V2RouteWithValidQuote({\n                    amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n                    rawQuote: BigNumber.from(route.rawQuote),\n                    percent: route.percent,\n                    route: route.route,\n                    gasModel: route.gasModel,\n                    quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n                    tradeType: tradeType,\n                    v2PoolProvider: v2PoolProvider,\n                });\n            case Protocol.MIXED:\n                return new MixedRouteWithValidQuote({\n                    amount: CurrencyAmount.fromFractionalAmount(route.amount.currency, route.amount.numerator, route.amount.denominator),\n                    rawQuote: BigNumber.from(route.rawQuote),\n                    sqrtPriceX96AfterList: route.sqrtPriceX96AfterList.map((num) => BigNumber.from(num)),\n                    initializedTicksCrossedList: [...route.initializedTicksCrossedList],\n                    quoterGasEstimate: BigNumber.from(route.gasEstimate),\n                    percent: route.percent,\n                    route: route.route,\n                    mixedRouteGasModel: route.gasModel,\n                    v2PoolProvider,\n                    quoteToken: new Token(currencyIn.chainId, route.quoteToken.address, route.quoteToken.decimals, route.quoteToken.symbol, route.quoteToken.name),\n                    tradeType: tradeType,\n                    v3PoolProvider: v3PoolProvider,\n                });\n        }\n    });\n    const trade = buildTrade(currencyIn, currencyOut, tradeType, routesWithValidQuote);\n    return {\n        quote: swapRoute.quote,\n        quoteGasAdjusted,\n        estimatedGasUsed,\n        estimatedGasUsedQuoteToken,\n        estimatedGasUsedUSD,\n        gasPriceWei: BigNumber.from(swapRoute.gasPriceWei),\n        trade,\n        route: routesWithValidQuote,\n        blockNumber: BigNumber.from(swapRoute.blockNumber),\n        methodParameters: swapRoute.methodParameters\n            ? {\n                calldata: swapRoute.methodParameters.calldata,\n                value: swapRoute.methodParameters.value,\n            }\n            : undefined,\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FzLWZhY3RvcnktaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlsL2dhcy1mYWN0b3J5LWhlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMvQyxPQUFPLEVBQVksY0FBYyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUUvRSxPQUFPLEVBQUUsU0FBUyxFQUEwQixNQUFNLGlCQUFpQixDQUFDO0FBQ3BFLE9BQU8sQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQVF2QixPQUFPLEVBQ0wsd0JBQXdCLEVBRXhCLG1CQUFtQixFQUNuQixxQkFBcUIsRUFDckIscUJBQXFCLEdBQ3RCLE1BQU0sWUFBWSxDQUFDO0FBQ3BCLE9BQU8sRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sU0FBUyxDQUFDO0FBRWhFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVoRCxNQUFNLENBQUMsS0FBSyxVQUFVLGVBQWUsQ0FDbkMsS0FBWSxFQUNaLFlBQTZCO0lBRTdCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFrQixDQUFDO0lBQ3pDLE1BQU0sSUFBSSxHQUFHLHVCQUF1QixDQUFDLE9BQU8sQ0FBRSxDQUFDO0lBRS9DLE1BQU0sWUFBWSxHQUFHLE1BQU0sWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsRSxNQUFNLElBQUksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUUvQyxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsT0FB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"]},"metadata":{},"sourceType":"module"}