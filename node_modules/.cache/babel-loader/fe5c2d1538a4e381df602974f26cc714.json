{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { BigNumber } from '@ethersproject/bignumber';\nimport { useSingleCallResult, useSingleContractMultipleData } from 'lib/hooks/multicall';\nimport { useMemo } from 'react';\nimport { useV3NFTPositionManagerContract } from './useContract';\nfunction useV3PositionsFromTokenIds(tokenIds) {\n  _s();\n  const positionManager = useV3NFTPositionManagerContract();\n  const inputs = useMemo(() => tokenIds ? tokenIds.map(tokenId => [BigNumber.from(tokenId)]) : [], [tokenIds]);\n  const results = useSingleContractMultipleData(positionManager, 'positions', inputs);\n  const loading = useMemo(() => results.some(_ref => {\n    let {\n      loading\n    } = _ref;\n    return loading;\n  }), [results]);\n  const error = useMemo(() => results.some(_ref2 => {\n    let {\n      error\n    } = _ref2;\n    return error;\n  }), [results]);\n  const positions = useMemo(() => {\n    if (!loading && !error && tokenIds) {\n      return results.map((call, i) => {\n        const tokenId = tokenIds[i];\n        const result = call.result;\n        return {\n          tokenId,\n          fee: result.fee,\n          feeGrowthInside0LastX128: result.feeGrowthInside0LastX128,\n          feeGrowthInside1LastX128: result.feeGrowthInside1LastX128,\n          liquidity: result.liquidity,\n          nonce: result.nonce,\n          operator: result.operator,\n          tickLower: result.tickLower,\n          tickUpper: result.tickUpper,\n          token0: result.token0,\n          token1: result.token1,\n          tokensOwed0: result.tokensOwed0,\n          tokensOwed1: result.tokensOwed1\n        };\n      });\n    }\n    return undefined;\n  }, [loading, error, results, tokenIds]);\n  return {\n    loading,\n    positions: positions === null || positions === void 0 ? void 0 : positions.map((position, i) => ({\n      ...position,\n      tokenId: inputs[i][0]\n    }))\n  };\n}\n_s(useV3PositionsFromTokenIds, \"YRxTTsoT3bu74+lEuX8pfafu9C8=\", false, function () {\n  return [useV3NFTPositionManagerContract, useSingleContractMultipleData];\n});\nexport function useV3PositionFromTokenId(tokenId) {\n  _s2();\n  var _position$positions;\n  const position = useV3PositionsFromTokenIds(tokenId ? [tokenId] : undefined);\n  return {\n    loading: position.loading,\n    position: (_position$positions = position.positions) === null || _position$positions === void 0 ? void 0 : _position$positions[0]\n  };\n}\n_s2(useV3PositionFromTokenId, \"NkhzZcSxooTC76ciFtDPedpgZnk=\", false, function () {\n  return [useV3PositionsFromTokenIds];\n});\nexport function useV3Positions(account) {\n  _s3();\n  var _balanceResult$;\n  const positionManager = useV3NFTPositionManagerContract();\n  const {\n    loading: balanceLoading,\n    result: balanceResult\n  } = useSingleCallResult(positionManager, 'balanceOf', [account !== null && account !== void 0 ? account : undefined]);\n\n  // we don't expect any account balance to ever exceed the bounds of max safe int\n  const accountBalance = balanceResult === null || balanceResult === void 0 ? void 0 : (_balanceResult$ = balanceResult[0]) === null || _balanceResult$ === void 0 ? void 0 : _balanceResult$.toNumber();\n  const tokenIdsArgs = useMemo(() => {\n    if (accountBalance && account) {\n      const tokenRequests = [];\n      for (let i = 0; i < accountBalance; i++) {\n        tokenRequests.push([account, i]);\n      }\n      return tokenRequests;\n    }\n    return [];\n  }, [account, accountBalance]);\n  const tokenIdResults = useSingleContractMultipleData(positionManager, 'tokenOfOwnerByIndex', tokenIdsArgs);\n  const someTokenIdsLoading = useMemo(() => tokenIdResults.some(_ref3 => {\n    let {\n      loading\n    } = _ref3;\n    return loading;\n  }), [tokenIdResults]);\n  const tokenIds = useMemo(() => {\n    if (account) {\n      return tokenIdResults.map(_ref4 => {\n        let {\n          result\n        } = _ref4;\n        return result;\n      }).filter(result => !!result).map(result => BigNumber.from(result[0]));\n    }\n    return [];\n  }, [account, tokenIdResults]);\n  const {\n    positions,\n    loading: positionsLoading\n  } = useV3PositionsFromTokenIds(tokenIds);\n  return {\n    loading: someTokenIdsLoading || balanceLoading || positionsLoading,\n    positions\n  };\n}\n_s3(useV3Positions, \"2DSrPpQkPaMxGmL0OCV/do6Pazw=\", false, function () {\n  return [useV3NFTPositionManagerContract, useSingleCallResult, useSingleContractMultipleData, useV3PositionsFromTokenIds];\n});","map":{"version":3,"names":["BigNumber","useSingleCallResult","useSingleContractMultipleData","useMemo","useV3NFTPositionManagerContract","useV3PositionsFromTokenIds","tokenIds","positionManager","inputs","map","tokenId","from","results","loading","some","error","positions","call","i","result","fee","feeGrowthInside0LastX128","feeGrowthInside1LastX128","liquidity","nonce","operator","tickLower","tickUpper","token0","token1","tokensOwed0","tokensOwed1","undefined","position","useV3PositionFromTokenId","useV3Positions","account","balanceLoading","balanceResult","accountBalance","toNumber","tokenIdsArgs","tokenRequests","push","tokenIdResults","someTokenIdsLoading","filter","positionsLoading"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/hooks/useV3Positions.ts"],"sourcesContent":["import { BigNumber } from '@ethersproject/bignumber'\nimport { CallStateResult, useSingleCallResult, useSingleContractMultipleData } from 'lib/hooks/multicall'\nimport { useMemo } from 'react'\nimport { PositionDetails } from 'types/position'\n\nimport { useV3NFTPositionManagerContract } from './useContract'\n\ninterface UseV3PositionsResults {\n  loading: boolean\n  positions: PositionDetails[] | undefined\n}\n\nfunction useV3PositionsFromTokenIds(tokenIds: BigNumber[] | undefined): UseV3PositionsResults {\n  const positionManager = useV3NFTPositionManagerContract()\n  const inputs = useMemo(() => (tokenIds ? tokenIds.map((tokenId) => [BigNumber.from(tokenId)]) : []), [tokenIds])\n  const results = useSingleContractMultipleData(positionManager, 'positions', inputs)\n\n  const loading = useMemo(() => results.some(({ loading }) => loading), [results])\n  const error = useMemo(() => results.some(({ error }) => error), [results])\n\n  const positions = useMemo(() => {\n    if (!loading && !error && tokenIds) {\n      return results.map((call, i) => {\n        const tokenId = tokenIds[i]\n        const result = call.result as CallStateResult\n        return {\n          tokenId,\n          fee: result.fee,\n          feeGrowthInside0LastX128: result.feeGrowthInside0LastX128,\n          feeGrowthInside1LastX128: result.feeGrowthInside1LastX128,\n          liquidity: result.liquidity,\n          nonce: result.nonce,\n          operator: result.operator,\n          tickLower: result.tickLower,\n          tickUpper: result.tickUpper,\n          token0: result.token0,\n          token1: result.token1,\n          tokensOwed0: result.tokensOwed0,\n          tokensOwed1: result.tokensOwed1,\n        }\n      })\n    }\n    return undefined\n  }, [loading, error, results, tokenIds])\n\n  return {\n    loading,\n    positions: positions?.map((position, i) => ({ ...position, tokenId: inputs[i][0] })),\n  }\n}\n\ninterface UseV3PositionResults {\n  loading: boolean\n  position: PositionDetails | undefined\n}\n\nexport function useV3PositionFromTokenId(tokenId: BigNumber | undefined): UseV3PositionResults {\n  const position = useV3PositionsFromTokenIds(tokenId ? [tokenId] : undefined)\n  return {\n    loading: position.loading,\n    position: position.positions?.[0],\n  }\n}\n\nexport function useV3Positions(account: string | null | undefined): UseV3PositionsResults {\n  const positionManager = useV3NFTPositionManagerContract()\n\n  const { loading: balanceLoading, result: balanceResult } = useSingleCallResult(positionManager, 'balanceOf', [\n    account ?? undefined,\n  ])\n\n  // we don't expect any account balance to ever exceed the bounds of max safe int\n  const accountBalance: number | undefined = balanceResult?.[0]?.toNumber()\n\n  const tokenIdsArgs = useMemo(() => {\n    if (accountBalance && account) {\n      const tokenRequests = []\n      for (let i = 0; i < accountBalance; i++) {\n        tokenRequests.push([account, i])\n      }\n      return tokenRequests\n    }\n    return []\n  }, [account, accountBalance])\n\n  const tokenIdResults = useSingleContractMultipleData(positionManager, 'tokenOfOwnerByIndex', tokenIdsArgs)\n  const someTokenIdsLoading = useMemo(() => tokenIdResults.some(({ loading }) => loading), [tokenIdResults])\n\n  const tokenIds = useMemo(() => {\n    if (account) {\n      return tokenIdResults\n        .map(({ result }) => result)\n        .filter((result): result is CallStateResult => !!result)\n        .map((result) => BigNumber.from(result[0]))\n    }\n    return []\n  }, [account, tokenIdResults])\n\n  const { positions, loading: positionsLoading } = useV3PositionsFromTokenIds(tokenIds)\n\n  return {\n    loading: someTokenIdsLoading || balanceLoading || positionsLoading,\n    positions,\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}