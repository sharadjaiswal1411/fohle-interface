{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useTheme as _useTheme}from\"styled-components\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useWeb3React}from'@web3-react/core';import{useCallback,useEffect,useState}from'react';import{useCloseModal,useModalIsOpen}from'state/application/hooks';import{ApplicationModal}from'state/application/reducer';import{CustomLightSpinner,ThemedText}from'theme';import Circle from\"../../assets/images/blue-loader.svg\";import Modal from'../Modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Wrapper=_styled.div.withConfig({componentId:\"sc-jqtzb4-0\"})([\"background-color:\",\";border-radius:20px;box-shadow:\",\";display:flex;flex-flow:column nowrap;margin:0;min-height:720px;min-width:375px;position:relative;width:100%;\"],function(_ref){var theme=_ref.theme;return theme.white;},function(_ref2){var theme=_ref2.theme;return theme.deepShadow;});var ErrorText=_styled(ThemedText.BodyPrimary).withConfig({componentId:\"sc-jqtzb4-1\"})([\"color:\",\";margin:auto !important;text-align:center;width:90%;\"],function(_ref3){var theme=_ref3.theme;return theme.accentFailure;});var StyledIframe=_styled.iframe.withConfig({componentId:\"sc-jqtzb4-2\"})([\"background-color:\",\";border-radius:12px;bottom:0;left:0;height:calc(100% - 16px);margin:8px;padding:0;position:absolute;right:0;top:0;width:calc(100% - 16px);\"],function(_ref4){var theme=_ref4.theme;return theme.white;});var StyledSpinner=_styled(CustomLightSpinner).withConfig({componentId:\"sc-jqtzb4-3\"})([\"bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;\"]);var MOONPAY_SUPPORTED_CURRENCY_CODES=['eth','eth_arbitrum','eth_optimism','eth_polygon','weth','wbtc','matic_polygon','polygon','usdc_arbitrum','usdc_optimism','usdc_polygon'];export default function FiatOnrampModal(){var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var theme=_useTheme();var closeModal=useCloseModal();var fiatOnrampModalOpen=useModalIsOpen(ApplicationModal.FIAT_ONRAMP);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),signedIframeUrl=_useState2[0],setSignedIframeUrl=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var fetchSignedIframeUrl=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var signedIframeUrlFetchEndpoint,res,_yield$res$json,url;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(account){_context.next=3;break;}setError('Please connect an account before making a purchase.');return _context.abrupt(\"return\");case 3:setLoading(true);setError(null);_context.prev=5;signedIframeUrlFetchEndpoint=process.env.REACT_APP_MOONPAY_LINK;_context.next=9;return fetch(signedIframeUrlFetchEndpoint,{headers:{Accept:'application/json','Content-Type':'application/json'},method:'POST',body:JSON.stringify({colorCode:theme.accentAction,defaultCurrencyCode:'eth',redirectUrl:'https://app.uniswap.org/#/swap',walletAddresses:JSON.stringify(MOONPAY_SUPPORTED_CURRENCY_CODES.reduce(function(acc,currencyCode){return _objectSpread(_objectSpread({},acc),{},_defineProperty({},currencyCode,account));},{}))})});case 9:res=_context.sent;_context.next=12;return res.json();case 12:_yield$res$json=_context.sent;url=_yield$res$json.url;setSignedIframeUrl(url);_context.next=21;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](5);console.log('there was an error fetching the link',_context.t0);setError(_context.t0.toString());case 21:_context.prev=21;setLoading(false);return _context.finish(21);case 24:case\"end\":return _context.stop();}}},_callee,null,[[5,17,21,24]]);})),[account,theme.accentAction]);useEffect(function(){fetchSignedIframeUrl();},[fetchSignedIframeUrl]);return/*#__PURE__*/_jsx(Modal,{isOpen:fiatOnrampModalOpen,onDismiss:closeModal,maxHeight:720,children:/*#__PURE__*/_jsx(Wrapper,{\"data-testid\":\"fiat-onramp-modal\",children:error?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Moonpay Fiat On-ramp iframe\"})}),/*#__PURE__*/_jsxs(ErrorText,{children:[/*#__PURE__*/_jsx(Trans,{id:\"something went wrong!\"}),/*#__PURE__*/_jsx(\"br\",{}),error]})]}):loading?/*#__PURE__*/_jsx(StyledSpinner,{src:Circle,alt:\"loading spinner\",size:\"90px\"}):/*#__PURE__*/_jsx(StyledIframe,{src:signedIframeUrl!==null&&signedIframeUrl!==void 0?signedIframeUrl:'',frameBorder:\"0\",title:\"fiat-onramp-iframe\"})})});}","map":{"version":3,"names":["useWeb3React","useCallback","useEffect","useState","useCloseModal","useModalIsOpen","ApplicationModal","CustomLightSpinner","ThemedText","Modal","Wrapper","styled","div","theme","white","deepShadow","ErrorText","BodyPrimary","accentFailure","StyledIframe","iframe","StyledSpinner","MOONPAY_SUPPORTED_CURRENCY_CODES","FiatOnrampModal","account","useTheme","closeModal","fiatOnrampModalOpen","FIAT_ONRAMP","signedIframeUrl","setSignedIframeUrl","error","setError","loading","setLoading","fetchSignedIframeUrl","signedIframeUrlFetchEndpoint","process","env","REACT_APP_MOONPAY_LINK","fetch","headers","Accept","method","body","JSON","stringify","colorCode","accentAction","defaultCurrencyCode","redirectUrl","walletAddresses","reduce","acc","currencyCode","res","json","url","console","log","toString","Circle"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/FiatOnrampModal/index.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { useWeb3React } from '@web3-react/core'\nimport { useCallback, useEffect, useState } from 'react'\nimport { useCloseModal, useModalIsOpen } from 'state/application/hooks'\nimport { ApplicationModal } from 'state/application/reducer'\nimport styled, { useTheme } from 'styled-components/macro'\nimport { CustomLightSpinner, ThemedText } from 'theme'\n\nimport Circle from '../../assets/images/blue-loader.svg'\nimport Modal from '../Modal'\n\nconst Wrapper = styled.div`\n  background-color: ${({ theme }) => theme.white};\n  border-radius: 20px;\n  box-shadow: ${({ theme }) => theme.deepShadow};\n  display: flex;\n  flex-flow: column nowrap;\n  margin: 0;\n  min-height: 720px;\n  min-width: 375px;\n  position: relative;\n  width: 100%;\n`\n\nconst ErrorText = styled(ThemedText.BodyPrimary)`\n  color: ${({ theme }) => theme.accentFailure};\n  margin: auto !important;\n  text-align: center;\n  width: 90%;\n`\nconst StyledIframe = styled.iframe`\n  background-color: ${({ theme }) => theme.white};\n  border-radius: 12px;\n  bottom: 0;\n  left: 0;\n  height: calc(100% - 16px);\n  margin: 8px;\n  padding: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: calc(100% - 16px);\n`\nconst StyledSpinner = styled(CustomLightSpinner)`\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n`\n\nconst MOONPAY_SUPPORTED_CURRENCY_CODES = [\n  'eth',\n  'eth_arbitrum',\n  'eth_optimism',\n  'eth_polygon',\n  'weth',\n  'wbtc',\n  'matic_polygon',\n  'polygon',\n  'usdc_arbitrum',\n  'usdc_optimism',\n  'usdc_polygon',\n]\n\nexport default function FiatOnrampModal() {\n  const { account } = useWeb3React()\n  const theme = useTheme()\n  const closeModal = useCloseModal()\n  const fiatOnrampModalOpen = useModalIsOpen(ApplicationModal.FIAT_ONRAMP)\n\n  const [signedIframeUrl, setSignedIframeUrl] = useState<string | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  const [loading, setLoading] = useState(false)\n\n  const fetchSignedIframeUrl = useCallback(async () => {\n    if (!account) {\n      setError('Please connect an account before making a purchase.')\n      return\n    }\n    setLoading(true)\n    setError(null)\n    try {\n      const signedIframeUrlFetchEndpoint = process.env.REACT_APP_MOONPAY_LINK as string\n      const res = await fetch(signedIframeUrlFetchEndpoint, {\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n        body: JSON.stringify({\n          colorCode: theme.accentAction,\n          defaultCurrencyCode: 'eth',\n          redirectUrl: 'https://app.uniswap.org/#/swap',\n          walletAddresses: JSON.stringify(\n            MOONPAY_SUPPORTED_CURRENCY_CODES.reduce(\n              (acc, currencyCode) => ({\n                ...acc,\n                [currencyCode]: account,\n              }),\n              {}\n            )\n          ),\n        }),\n      })\n      const { url } = await res.json()\n      setSignedIframeUrl(url)\n    } catch (e) {\n      console.log('there was an error fetching the link', e)\n      setError(e.toString())\n    } finally {\n      setLoading(false)\n    }\n  }, [account, theme.accentAction])\n\n  useEffect(() => {\n    fetchSignedIframeUrl()\n  }, [fetchSignedIframeUrl])\n\n  return (\n    <Modal isOpen={fiatOnrampModalOpen} onDismiss={closeModal} maxHeight={720}>\n      <Wrapper data-testid=\"fiat-onramp-modal\">\n        {error ? (\n          <>\n            <ThemedText.MediumHeader>\n              <Trans>Moonpay Fiat On-ramp iframe</Trans>\n            </ThemedText.MediumHeader>\n            <ErrorText>\n              <Trans>something went wrong!</Trans>\n              <br />\n              {error}\n            </ErrorText>\n          </>\n        ) : loading ? (\n          <StyledSpinner src={Circle} alt=\"loading spinner\" size=\"90px\" />\n        ) : (\n          <StyledIframe src={signedIframeUrl ?? ''} frameBorder=\"0\" title=\"fiat-onramp-iframe\" />\n        )}\n      </Wrapper>\n    </Modal>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}