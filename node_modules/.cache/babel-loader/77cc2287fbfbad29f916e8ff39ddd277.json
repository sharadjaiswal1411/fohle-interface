{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{isAddress}from'@ethersproject/address';var MAX_SEARCH_RESULTS=6;var NFT_API_URL=process.env.REACT_APP_TEMP_API_URL;export var fetchSearchCollections=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(addressOrName){var recursive,url,isName,filters,payload,r,_data,formattedData,data,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:recursive=_args.length>1&&_args[1]!==undefined?_args[1]:false;if(NFT_API_URL){_context.next=3;break;}return _context.abrupt(\"return\",Promise.resolve([]));case 3:url=\"\".concat(NFT_API_URL,\"/nft/searchCollections\");isName=!isAddress(addressOrName.toLowerCase());if(!(!isName&&!recursive)){_context.next=15;break;}_context.prev=6;_context.next=9;return fetchSearchCollections(addressOrName.toLowerCase(),true);case 9:return _context.abrupt(\"return\",_context.sent);case 12:_context.prev=12;_context.t0=_context[\"catch\"](6);return _context.abrupt(\"return\",[]);case 15:filters=isName?{$or:[{name:{$regex:addressOrName,$options:'i'}}]}:{address:addressOrName};payload={filters:filters,limit:6,fields:{name:1,imageUrl:1,address:1,floorPrice:1},offset:0};_context.next=19;return fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});case 19:r=_context.sent;if(!isName){_context.next=26;break;}_context.next=23;return r.json();case 23:_data=_context.sent;formattedData=(_data===null||_data===void 0?void 0:_data.data)?_data.data.map(function(collection){return _objectSpread(_objectSpread({},collection),{},{stats:_objectSpread(_objectSpread({},collection.stats),{},{floor_price:collection.floorPrice})});}):[];return _context.abrupt(\"return\",formattedData.slice(0,MAX_SEARCH_RESULTS));case 26:_context.next=28;return r.json();case 28:data=_context.sent;return _context.abrupt(\"return\",data.data?[_objectSpread(_objectSpread({},data.data[0]),{},{stats:_objectSpread(_objectSpread({},data.data[0].stats),{},{floor_price:data.data[0].floorPrice})})]:[]);case 30:case\"end\":return _context.stop();}}},_callee,null,[[6,12]]);}));return function fetchSearchCollections(_x){return _ref.apply(this,arguments);};}();","map":{"version":3,"names":["isAddress","MAX_SEARCH_RESULTS","NFT_API_URL","process","env","REACT_APP_TEMP_API_URL","fetchSearchCollections","addressOrName","recursive","Promise","resolve","url","isName","toLowerCase","filters","$or","name","$regex","$options","address","payload","limit","fields","imageUrl","floorPrice","offset","fetch","method","headers","body","JSON","stringify","r","json","data","formattedData","map","collection","stats","floor_price","slice"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/nft/queries/genie/SearchCollectionsFetcher.ts"],"sourcesContent":["import { isAddress } from '@ethersproject/address'\n\nimport { GenieCollection } from '../../types'\n\nconst MAX_SEARCH_RESULTS = 6\n\nconst NFT_API_URL = process.env.REACT_APP_TEMP_API_URL\nexport const fetchSearchCollections = async (addressOrName: string, recursive = false): Promise<GenieCollection[]> => {\n  if (!NFT_API_URL) return Promise.resolve([])\n  const url = `${NFT_API_URL}/nft/searchCollections`\n  const isName = !isAddress(addressOrName.toLowerCase())\n\n  if (!isName && !recursive) {\n    try {\n      return await fetchSearchCollections(addressOrName.toLowerCase(), true)\n    } catch {\n      return []\n    }\n  }\n\n  const filters = isName\n    ? {\n        $or: [{ name: { $regex: addressOrName, $options: 'i' } }],\n      }\n    : { address: addressOrName }\n\n  const payload = {\n    filters,\n    limit: 6,\n    fields: {\n      name: 1,\n      imageUrl: 1,\n      address: 1,\n      floorPrice: 1,\n    },\n    offset: 0,\n  }\n  const r = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(payload),\n  })\n  if (isName) {\n    const data = await r.json()\n    const formattedData = data?.data\n      ? data.data.map((collection: { stats: Record<string, unknown>; floorPrice: string }) => {\n          return {\n            ...collection,\n            stats: {\n              ...collection.stats,\n              floor_price: collection.floorPrice,\n            },\n          }\n        })\n      : []\n    return formattedData.slice(0, MAX_SEARCH_RESULTS)\n  }\n  const data = await r.json()\n\n  return data.data ? [{ ...data.data[0], stats: { ...data.data[0].stats, floor_price: data.data[0].floorPrice } }] : []\n}\n"],"mappings":"ggBAAA,OAASA,SAAS,KAAQ,wBAAwB,CAIlD,GAAMC,mBAAkB,CAAG,CAAC,CAE5B,GAAMC,YAAW,CAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,CACtD,MAAO,IAAMC,uBAAsB,0FAAG,iBAAOC,aAAqB,sMAAEC,SAAS,+CAAG,KAAK,IAC9EN,WAAW,yDAASO,OAAO,CAACC,OAAO,CAAC,EAAE,CAAC,SACtCC,GAAG,WAAMT,WAAW,2BACpBU,MAAM,CAAG,CAACZ,SAAS,CAACO,aAAa,CAACM,WAAW,EAAE,CAAC,MAElD,CAACD,MAAM,EAAI,CAACJ,SAAS,iEAERF,uBAAsB,CAACC,aAAa,CAACM,WAAW,EAAE,CAAE,IAAI,CAAC,iJAE/D,EAAE,UAIPC,OAAO,CAAGF,MAAM,CAClB,CACEG,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,CAAEC,MAAM,CAAEV,aAAa,CAAEW,QAAQ,CAAE,GAAI,CAAE,CAAC,CAC1D,CAAC,CACD,CAAEC,OAAO,CAAEZ,aAAc,CAAC,CAExBa,OAAO,CAAG,CACdN,OAAO,CAAPA,OAAO,CACPO,KAAK,CAAE,CAAC,CACRC,MAAM,CAAE,CACNN,IAAI,CAAE,CAAC,CACPO,QAAQ,CAAE,CAAC,CACXJ,OAAO,CAAE,CAAC,CACVK,UAAU,CAAE,CACd,CAAC,CACDC,MAAM,CAAE,CACV,CAAC,wBACeC,MAAK,CAACf,GAAG,CAAE,CACzBgB,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACX,OAAO,CAC9B,CAAC,CAAC,SANIY,CAAC,mBAOHpB,MAAM,iDACWoB,EAAC,CAACC,IAAI,EAAE,SAArBC,KAAI,eACJC,aAAa,CAAG,CAAAD,KAAI,SAAJA,KAAI,iBAAJA,KAAI,CAAEA,IAAI,EAC5BA,KAAI,CAACA,IAAI,CAACE,GAAG,CAAC,SAACC,UAAkE,CAAK,CACpF,sCACKA,UAAU,MACbC,KAAK,gCACAD,UAAU,CAACC,KAAK,MACnBC,WAAW,CAAEF,UAAU,CAACb,UAAU,EACnC,GAEL,CAAC,CAAC,CACF,EAAE,iCACCW,aAAa,CAACK,KAAK,CAAC,CAAC,CAAEvC,kBAAkB,CAAC,iCAEhC+B,EAAC,CAACC,IAAI,EAAE,SAArBC,IAAI,+CAEHA,IAAI,CAACA,IAAI,CAAG,gCAAMA,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,MAAEI,KAAK,gCAAOJ,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAACI,KAAK,MAAEC,WAAW,CAAEL,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAACV,UAAU,EAAE,GAAG,CAAG,EAAE,uEACtH,kBAvDYlB,uBAAsB,4CAuDlC"},"metadata":{},"sourceType":"module"}