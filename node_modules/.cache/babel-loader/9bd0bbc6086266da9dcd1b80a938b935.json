{"ast":null,"code":"import _createForOfIteratorHelper from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import{createSlice}from'@reduxjs/toolkit';import{filterToKey}from'./utils';var slice=createSlice({name:'logs',initialState:{},reducers:{addListener:function addListener(state,_ref){var _ref$payload=_ref.payload,chainId=_ref$payload.chainId,filter=_ref$payload.filter;if(!state[chainId])state[chainId]={};var key=filterToKey(filter);if(!state[chainId][key])state[chainId][key]={listeners:1};else state[chainId][key].listeners++;},fetchingLogs:function fetchingLogs(state,_ref2){var _ref2$payload=_ref2.payload,chainId=_ref2$payload.chainId,filters=_ref2$payload.filters,blockNumber=_ref2$payload.blockNumber;if(!state[chainId])return;var _iterator=_createForOfIteratorHelper(filters),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var filter=_step.value;var key=filterToKey(filter);if(!state[chainId][key])continue;state[chainId][key].fetchingBlockNumber=blockNumber;}}catch(err){_iterator.e(err);}finally{_iterator.f();}},fetchedLogs:function fetchedLogs(state,_ref3){var _ref3$payload=_ref3.payload,chainId=_ref3$payload.chainId,filter=_ref3$payload.filter,results=_ref3$payload.results;if(!state[chainId])return;var key=filterToKey(filter);var fetchState=state[chainId][key];if(!fetchState||fetchState.results&&fetchState.results.blockNumber>results.blockNumber)return;fetchState.results=results;},fetchedLogsError:function fetchedLogsError(state,_ref4){var _ref4$payload=_ref4.payload,chainId=_ref4$payload.chainId,filter=_ref4$payload.filter,blockNumber=_ref4$payload.blockNumber;if(!state[chainId])return;var key=filterToKey(filter);var fetchState=state[chainId][key];if(!fetchState||fetchState.results&&fetchState.results.blockNumber>blockNumber)return;fetchState.results={blockNumber:blockNumber,error:true};},removeListener:function removeListener(state,_ref5){var _ref5$payload=_ref5.payload,chainId=_ref5$payload.chainId,filter=_ref5$payload.filter;if(!state[chainId])return;var key=filterToKey(filter);if(!state[chainId][key])return;state[chainId][key].listeners--;}}});export default slice.reducer;var _slice$actions=slice.actions,addListener=_slice$actions.addListener,removeListener=_slice$actions.removeListener,fetchedLogs=_slice$actions.fetchedLogs,fetchedLogsError=_slice$actions.fetchedLogsError,fetchingLogs=_slice$actions.fetchingLogs;export{addListener,removeListener,fetchedLogs,fetchedLogsError,fetchingLogs};","map":{"version":3,"names":["createSlice","filterToKey","slice","name","initialState","reducers","addListener","state","payload","chainId","filter","key","listeners","fetchingLogs","filters","blockNumber","fetchingBlockNumber","fetchedLogs","results","fetchState","fetchedLogsError","error","removeListener","reducer","actions"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/state/logs/slice.ts"],"sourcesContent":["import type { Filter } from '@ethersproject/providers'\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit'\n\nimport { filterToKey, Log } from './utils'\n\ninterface LogsState {\n  [chainId: number]: {\n    [filterKey: string]: {\n      listeners: number\n      fetchingBlockNumber?: number\n      results?:\n        | {\n            blockNumber: number\n            logs: Log[]\n            error?: undefined\n          }\n        | {\n            blockNumber: number\n            logs?: undefined\n            error: true\n          }\n    }\n  }\n}\n\nconst slice = createSlice({\n  name: 'logs',\n  initialState: {} as LogsState,\n  reducers: {\n    addListener(state, { payload: { chainId, filter } }: PayloadAction<{ chainId: number; filter: Filter }>) {\n      if (!state[chainId]) state[chainId] = {}\n      const key = filterToKey(filter)\n      if (!state[chainId][key])\n        state[chainId][key] = {\n          listeners: 1,\n        }\n      else state[chainId][key].listeners++\n    },\n    fetchingLogs(\n      state,\n      {\n        payload: { chainId, filters, blockNumber },\n      }: PayloadAction<{ chainId: number; filters: Filter[]; blockNumber: number }>\n    ) {\n      if (!state[chainId]) return\n      for (const filter of filters) {\n        const key = filterToKey(filter)\n        if (!state[chainId][key]) continue\n        state[chainId][key].fetchingBlockNumber = blockNumber\n      }\n    },\n    fetchedLogs(\n      state,\n      {\n        payload: { chainId, filter, results },\n      }: PayloadAction<{ chainId: number; filter: Filter; results: { blockNumber: number; logs: Log[] } }>\n    ) {\n      if (!state[chainId]) return\n      const key = filterToKey(filter)\n      const fetchState = state[chainId][key]\n      if (!fetchState || (fetchState.results && fetchState.results.blockNumber > results.blockNumber)) return\n      fetchState.results = results\n    },\n    fetchedLogsError(\n      state,\n      {\n        payload: { chainId, filter, blockNumber },\n      }: PayloadAction<{ chainId: number; blockNumber: number; filter: Filter }>\n    ) {\n      if (!state[chainId]) return\n      const key = filterToKey(filter)\n      const fetchState = state[chainId][key]\n      if (!fetchState || (fetchState.results && fetchState.results.blockNumber > blockNumber)) return\n      fetchState.results = {\n        blockNumber,\n        error: true,\n      }\n    },\n    removeListener(state, { payload: { chainId, filter } }: PayloadAction<{ chainId: number; filter: Filter }>) {\n      if (!state[chainId]) return\n      const key = filterToKey(filter)\n      if (!state[chainId][key]) return\n      state[chainId][key].listeners--\n    },\n  },\n})\n\nexport default slice.reducer\nexport const { addListener, removeListener, fetchedLogs, fetchedLogsError, fetchingLogs } = slice.actions\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}