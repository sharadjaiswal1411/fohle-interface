{"ast":null,"code":"import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{SortDropdown}from'nft/components/common/SortDropdown';import{Column,Row}from'nft/components/Flex';import{NumericInput}from'nft/components/layout/Input';import{bodySmall,buttonTextMedium,caption}from'nft/css/common.css';import{useSellAsset}from'nft/hooks';import{pluralize}from'nft/utils/roundAndPluralize';import{useEffect,useMemo,useState}from'react';import{AlertTriangle}from'react-feather';import{ThemedText}from'theme';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ModalWrapper=_styled(Column).withConfig({componentId:\"sc-1d5ev1f-0\"})([\"gap:4px;position:relative;\"]);var InputWrapper=_styled(Row).withConfig({componentId:\"sc-1d5ev1f-1\"})([\"padding:12px 8px 12px 12px;border:1px solid;position:relative;height:44px;border-radius:8px;border-color:\",\";\"],function(_ref){var isInvalid=_ref.isInvalid,theme=_ref.theme;return isInvalid?theme.accentCritical:theme.backgroundOutline;});var DropdownWrapper=_styled(ThemedText.BodyPrimary).withConfig({componentId:\"sc-1d5ev1f-2\"})([\"cursor:pointer;display:flex;justify-content:flex-end;height:min-content;width:80px;&:hover{background-color:\",\";}border-radius:12px;padding:8px;\"],function(_ref2){var theme=_ref2.theme;return theme.backgroundInteractive;});var ErrorMessage=_styled(Row).withConfig({componentId:\"sc-1d5ev1f-3\"})([\"color:\",\";gap:4px;position:absolute;top:44px;\"],function(_ref3){var theme=_ref3.theme;return theme.accentCritical;});var WarningIcon=_styled(AlertTriangle).withConfig({componentId:\"sc-1d5ev1f-4\"})([\"width:16px;color:\",\";\"],function(_ref4){var theme=_ref4.theme;return theme.accentCritical;});var Duration;(function(Duration){Duration[\"hour\"]=\"hour\";Duration[\"day\"]=\"day\";Duration[\"week\"]=\"week\";Duration[\"month\"]=\"month\";})(Duration||(Duration={}));var ErrorState;(function(ErrorState){ErrorState[ErrorState[\"valid\"]=0]=\"valid\";ErrorState[ErrorState[\"empty\"]=1]=\"empty\";ErrorState[ErrorState[\"overMax\"]=2]=\"overMax\";})(ErrorState||(ErrorState={}));export var SetDurationModal=function SetDurationModal(){var _useState=useState(Duration.day),_useState2=_slicedToArray(_useState,2),duration=_useState2[0],setDuration=_useState2[1];var _useState3=useState(Duration.day),_useState4=_slicedToArray(_useState3,2),displayDuration=_useState4[0],setDisplayDuration=_useState4[1];var _useState5=useState('7'),_useState6=_slicedToArray(_useState5,2),amount=_useState6[0],setAmount=_useState6[1];var _useState7=useState(ErrorState.valid),_useState8=_slicedToArray(_useState7,2),errorState=_useState8[0],setErrorState=_useState8[1];var setGlobalExpiration=useSellAsset(function(state){return state.setGlobalExpiration;});var setCustomExpiration=function setCustomExpiration(event){setAmount(event.target.value.length?event.target.value:'');setDuration(displayDuration);};var selectDuration=function selectDuration(duration){setDuration(duration);setDisplayDuration(duration);};var durationOptions=useMemo(function(){return[{displayText:'Hours',onClick:function onClick(){return selectDuration(Duration.hour);}},{displayText:'Days',onClick:function onClick(){return selectDuration(Duration.day);}},{displayText:'Weeks',onClick:function onClick(){return selectDuration(Duration.week);}},{displayText:'Months',onClick:function onClick(){return selectDuration(Duration.month);}}];},[]);useEffect(function(){var expiration=convertDurationToExpiration(parseFloat(amount),duration);if(expiration*1000-Date.now()<60000||isNaN(expiration))setErrorState(ErrorState.empty);else if(expiration*1000-Date.now()>15552000000)setErrorState(ErrorState.overMax);else setErrorState(ErrorState.valid);setGlobalExpiration(expiration);},[amount,duration,setGlobalExpiration]);return/*#__PURE__*/_jsxs(ModalWrapper,{children:[/*#__PURE__*/_jsxs(InputWrapper,{isInvalid:errorState!==ErrorState.valid,children:[/*#__PURE__*/_jsx(NumericInput,{as:\"input\",type:\"number\",pattern:\"[0-9]\",borderStyle:\"none\",className:bodySmall,color:{placeholder:'textSecondary',default:'textPrimary'},value:amount,width:\"32\",marginRight:\"4\",backgroundColor:\"none\",onChange:setCustomExpiration,flexShrink:\"0\"}),/*#__PURE__*/_jsx(DropdownWrapper,{className:buttonTextMedium,children:/*#__PURE__*/_jsx(SortDropdown,{dropDownOptions:durationOptions,mini:true,miniPrompt:displayDuration+(displayDuration===duration?pluralize(parseFloat(amount)):'s'),left:38,top:38})})]}),errorState!==ErrorState.valid&&/*#__PURE__*/_jsxs(ErrorMessage,{className:caption,children:[' ',/*#__PURE__*/_jsx(WarningIcon,{}),\" \",errorState===ErrorState.overMax?'Maximum 6 months':'Set duration']})]});};var convertDurationToExpiration=function convertDurationToExpiration(amount,duration){var durationFactor=function durationFactor(){switch(duration){case Duration.hour:return 1;case Duration.day:return 24;case Duration.week:return 24*7;default:// month\nreturn 24*30;}};return Math.round((Date.now()+3600000*durationFactor()*amount)/1000);};","map":{"version":3,"names":["SortDropdown","Column","Row","NumericInput","bodySmall","buttonTextMedium","caption","useSellAsset","pluralize","useEffect","useMemo","useState","AlertTriangle","ThemedText","ModalWrapper","styled","InputWrapper","isInvalid","theme","accentCritical","backgroundOutline","DropdownWrapper","BodyPrimary","backgroundInteractive","ErrorMessage","WarningIcon","Duration","ErrorState","SetDurationModal","day","duration","setDuration","displayDuration","setDisplayDuration","amount","setAmount","valid","errorState","setErrorState","setGlobalExpiration","state","setCustomExpiration","event","target","value","length","selectDuration","durationOptions","displayText","onClick","hour","week","month","expiration","convertDurationToExpiration","parseFloat","Date","now","isNaN","empty","overMax","placeholder","default","durationFactor","Math","round"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/nft/components/profile/list/SetDurationModal.tsx"],"sourcesContent":["import ms from 'ms.macro'\nimport { SortDropdown } from 'nft/components/common/SortDropdown'\nimport { Column, Row } from 'nft/components/Flex'\nimport { NumericInput } from 'nft/components/layout/Input'\nimport { bodySmall, buttonTextMedium, caption } from 'nft/css/common.css'\nimport { useSellAsset } from 'nft/hooks'\nimport { DropDownOption } from 'nft/types'\nimport { pluralize } from 'nft/utils/roundAndPluralize'\nimport { useEffect, useMemo, useState } from 'react'\nimport { AlertTriangle } from 'react-feather'\nimport styled from 'styled-components/macro'\nimport { ThemedText } from 'theme'\n\nconst ModalWrapper = styled(Column)`\n  gap: 4px;\n  position: relative;\n`\n\nconst InputWrapper = styled(Row)<{ isInvalid: boolean }>`\n  padding: 12px 8px 12px 12px;\n  border: 1px solid;\n  position: relative;\n  height: 44px;\n  border-radius: 8px;\n  border-color: ${({ isInvalid, theme }) => (isInvalid ? theme.accentCritical : theme.backgroundOutline)};\n`\n\nconst DropdownWrapper = styled(ThemedText.BodyPrimary)`\n  cursor: pointer;\n  display: flex;\n  justify-content: flex-end;\n  height: min-content;\n  width: 80px;\n  &:hover {\n    background-color: ${({ theme }) => theme.backgroundInteractive};\n  }\n  border-radius: 12px;\n  padding: 8px;\n`\n\nconst ErrorMessage = styled(Row)`\n  color: ${({ theme }) => theme.accentCritical};\n  gap: 4px;\n  position: absolute;\n  top: 44px;\n`\n\nconst WarningIcon = styled(AlertTriangle)`\n  width: 16px;\n  color: ${({ theme }) => theme.accentCritical};\n`\n\nenum Duration {\n  hour = 'hour',\n  day = 'day',\n  week = 'week',\n  month = 'month',\n}\n\nenum ErrorState {\n  valid,\n  empty,\n  overMax,\n}\n\nexport const SetDurationModal = () => {\n  const [duration, setDuration] = useState(Duration.day)\n  const [displayDuration, setDisplayDuration] = useState(Duration.day)\n  const [amount, setAmount] = useState('7')\n  const [errorState, setErrorState] = useState(ErrorState.valid)\n  const setGlobalExpiration = useSellAsset((state) => state.setGlobalExpiration)\n  const setCustomExpiration = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setAmount(event.target.value.length ? event.target.value : '')\n    setDuration(displayDuration)\n  }\n  const selectDuration = (duration: Duration) => {\n    setDuration(duration)\n    setDisplayDuration(duration)\n  }\n  const durationOptions: DropDownOption[] = useMemo(\n    () => [\n      {\n        displayText: 'Hours',\n        onClick: () => selectDuration(Duration.hour),\n      },\n      {\n        displayText: 'Days',\n        onClick: () => selectDuration(Duration.day),\n      },\n      {\n        displayText: 'Weeks',\n        onClick: () => selectDuration(Duration.week),\n      },\n      {\n        displayText: 'Months',\n        onClick: () => selectDuration(Duration.month),\n      },\n    ],\n    []\n  )\n  useEffect(() => {\n    const expiration = convertDurationToExpiration(parseFloat(amount), duration)\n\n    if (expiration * 1000 - Date.now() < ms`60 seconds` || isNaN(expiration)) setErrorState(ErrorState.empty)\n    else if (expiration * 1000 - Date.now() > ms`180 days`) setErrorState(ErrorState.overMax)\n    else setErrorState(ErrorState.valid)\n    setGlobalExpiration(expiration)\n  }, [amount, duration, setGlobalExpiration])\n\n  return (\n    <ModalWrapper>\n      <InputWrapper isInvalid={errorState !== ErrorState.valid}>\n        <NumericInput\n          as=\"input\"\n          type=\"number\"\n          pattern=\"[0-9]\"\n          borderStyle=\"none\"\n          className={bodySmall}\n          color={{ placeholder: 'textSecondary', default: 'textPrimary' }}\n          value={amount}\n          width=\"32\"\n          marginRight=\"4\"\n          backgroundColor=\"none\"\n          onChange={setCustomExpiration}\n          flexShrink=\"0\"\n        />\n        <DropdownWrapper className={buttonTextMedium}>\n          <SortDropdown\n            dropDownOptions={durationOptions}\n            mini\n            miniPrompt={displayDuration + (displayDuration === duration ? pluralize(parseFloat(amount)) : 's')}\n            left={38}\n            top={38}\n          />\n        </DropdownWrapper>\n      </InputWrapper>\n      {errorState !== ErrorState.valid && (\n        <ErrorMessage className={caption}>\n          {' '}\n          <WarningIcon /> {errorState === ErrorState.overMax ? 'Maximum 6 months' : 'Set duration'}\n        </ErrorMessage>\n      )}\n    </ModalWrapper>\n  )\n}\n\nconst convertDurationToExpiration = (amount: number, duration: Duration) => {\n  const durationFactor = () => {\n    switch (duration) {\n      case Duration.hour:\n        return 1\n      case Duration.day:\n        return 24\n      case Duration.week:\n        return 24 * 7\n      default: // month\n        return 24 * 30\n    }\n  }\n  return Math.round((Date.now() + ms`1 hour` * durationFactor() * amount) / 1000)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}