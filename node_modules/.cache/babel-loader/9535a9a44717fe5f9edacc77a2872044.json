{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-unsafe-argument */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport { Status } from '@amplitude/analytics-types';\nvar BaseTransport = /** @class */function () {\n  function BaseTransport() {}\n  BaseTransport.prototype.send = function (_serverUrl, _payload) {\n    return Promise.resolve(null);\n  };\n  BaseTransport.prototype.buildResponse = function (responseJSON) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x;\n    if (typeof responseJSON !== 'object') {\n      return null;\n    }\n    var statusCode = responseJSON.code || 0;\n    var status = this.buildStatus(statusCode);\n    switch (status) {\n      case Status.Success:\n        return {\n          status: status,\n          statusCode: statusCode,\n          body: {\n            eventsIngested: (_a = responseJSON.events_ingested) !== null && _a !== void 0 ? _a : 0,\n            payloadSizeBytes: (_b = responseJSON.payload_size_bytes) !== null && _b !== void 0 ? _b : 0,\n            serverUploadTime: (_c = responseJSON.server_upload_time) !== null && _c !== void 0 ? _c : 0\n          }\n        };\n      case Status.Invalid:\n        return {\n          status: status,\n          statusCode: statusCode,\n          body: {\n            error: (_d = responseJSON.error) !== null && _d !== void 0 ? _d : '',\n            missingField: (_e = responseJSON.missing_field) !== null && _e !== void 0 ? _e : '',\n            eventsWithInvalidFields: (_f = responseJSON.events_with_invalid_fields) !== null && _f !== void 0 ? _f : {},\n            eventsWithMissingFields: (_g = responseJSON.events_with_missing_fields) !== null && _g !== void 0 ? _g : {},\n            eventsWithInvalidIdLengths: (_h = responseJSON.events_with_invalid_id_lengths) !== null && _h !== void 0 ? _h : {},\n            epsThreshold: (_j = responseJSON.eps_threshold) !== null && _j !== void 0 ? _j : 0,\n            exceededDailyQuotaDevices: (_k = responseJSON.exceeded_daily_quota_devices) !== null && _k !== void 0 ? _k : {},\n            silencedDevices: (_l = responseJSON.silenced_devices) !== null && _l !== void 0 ? _l : [],\n            silencedEvents: (_m = responseJSON.silenced_events) !== null && _m !== void 0 ? _m : [],\n            throttledDevices: (_o = responseJSON.throttled_devices) !== null && _o !== void 0 ? _o : {},\n            throttledEvents: (_p = responseJSON.throttled_events) !== null && _p !== void 0 ? _p : []\n          }\n        };\n      case Status.PayloadTooLarge:\n        return {\n          status: status,\n          statusCode: statusCode,\n          body: {\n            error: (_q = responseJSON.error) !== null && _q !== void 0 ? _q : ''\n          }\n        };\n      case Status.RateLimit:\n        return {\n          status: status,\n          statusCode: statusCode,\n          body: {\n            error: (_r = responseJSON.error) !== null && _r !== void 0 ? _r : '',\n            epsThreshold: (_s = responseJSON.eps_threshold) !== null && _s !== void 0 ? _s : 0,\n            throttledDevices: (_t = responseJSON.throttled_devices) !== null && _t !== void 0 ? _t : {},\n            throttledUsers: (_u = responseJSON.throttled_users) !== null && _u !== void 0 ? _u : {},\n            exceededDailyQuotaDevices: (_v = responseJSON.exceeded_daily_quota_devices) !== null && _v !== void 0 ? _v : {},\n            exceededDailyQuotaUsers: (_w = responseJSON.exceeded_daily_quota_users) !== null && _w !== void 0 ? _w : {},\n            throttledEvents: (_x = responseJSON.throttled_events) !== null && _x !== void 0 ? _x : []\n          }\n        };\n      case Status.Timeout:\n      default:\n        return {\n          status: status,\n          statusCode: statusCode\n        };\n    }\n  };\n  BaseTransport.prototype.buildStatus = function (code) {\n    if (code >= 200 && code < 300) {\n      return Status.Success;\n    }\n    if (code === 429) {\n      return Status.RateLimit;\n    }\n    if (code === 413) {\n      return Status.PayloadTooLarge;\n    }\n    if (code === 408) {\n      return Status.Timeout;\n    }\n    if (code >= 400 && code < 500) {\n      return Status.Invalid;\n    }\n    if (code >= 500) {\n      return Status.Failed;\n    }\n    return Status.Unknown;\n  };\n  return BaseTransport;\n}();\nexport { BaseTransport };","map":{"version":3,"sources":["../../../src/transports/base.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-unsafe-argument */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport { Payload, Response, Status, Transport } from '@amplitude/analytics-types';\n\nexport class BaseTransport implements Transport {\n  send(_serverUrl: string, _payload: Payload): Promise<Response | null> {\n    return Promise.resolve(null);\n  }\n\n  buildResponse(responseJSON: Record<string, any>): Response | null {\n    if (typeof responseJSON !== 'object') {\n      return null;\n    }\n\n    const statusCode = responseJSON.code || 0;\n    const status = this.buildStatus(statusCode);\n\n    switch (status) {\n      case Status.Success:\n        return {\n          status,\n          statusCode,\n          body: {\n            eventsIngested: responseJSON.events_ingested ?? 0,\n            payloadSizeBytes: responseJSON.payload_size_bytes ?? 0,\n            serverUploadTime: responseJSON.server_upload_time ?? 0,\n          },\n        };\n\n      case Status.Invalid:\n        return {\n          status,\n          statusCode,\n          body: {\n            error: responseJSON.error ?? '',\n            missingField: responseJSON.missing_field ?? '',\n            eventsWithInvalidFields: responseJSON.events_with_invalid_fields ?? {},\n            eventsWithMissingFields: responseJSON.events_with_missing_fields ?? {},\n            eventsWithInvalidIdLengths: responseJSON.events_with_invalid_id_lengths ?? {},\n            epsThreshold: responseJSON.eps_threshold ?? 0,\n            exceededDailyQuotaDevices: responseJSON.exceeded_daily_quota_devices ?? {},\n            silencedDevices: responseJSON.silenced_devices ?? [],\n            silencedEvents: responseJSON.silenced_events ?? [],\n            throttledDevices: responseJSON.throttled_devices ?? {},\n            throttledEvents: responseJSON.throttled_events ?? [],\n          },\n        };\n      case Status.PayloadTooLarge:\n        return {\n          status,\n          statusCode,\n          body: {\n            error: responseJSON.error ?? '',\n          },\n        };\n      case Status.RateLimit:\n        return {\n          status,\n          statusCode,\n          body: {\n            error: responseJSON.error ?? '',\n            epsThreshold: responseJSON.eps_threshold ?? 0,\n            throttledDevices: responseJSON.throttled_devices ?? {},\n            throttledUsers: responseJSON.throttled_users ?? {},\n            exceededDailyQuotaDevices: responseJSON.exceeded_daily_quota_devices ?? {},\n            exceededDailyQuotaUsers: responseJSON.exceeded_daily_quota_users ?? {},\n            throttledEvents: responseJSON.throttled_events ?? [],\n          },\n        };\n      case Status.Timeout:\n      default:\n        return {\n          status,\n          statusCode,\n        };\n    }\n  }\n\n  buildStatus(code: number): Status {\n    if (code >= 200 && code < 300) {\n      return Status.Success;\n    }\n\n    if (code === 429) {\n      return Status.RateLimit;\n    }\n\n    if (code === 413) {\n      return Status.PayloadTooLarge;\n    }\n\n    if (code === 408) {\n      return Status.Timeout;\n    }\n\n    if (code >= 400 && code < 500) {\n      return Status.Invalid;\n    }\n\n    if (code >= 500) {\n      return Status.Failed;\n    }\n\n    return Status.Unknown;\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}