{"ast":null,"code":"import _objectSpread from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{sendAnalyticsEvent,Trace}from'@uniswap/analytics';import{EventName}from'@uniswap/analytics-events';import{BagRow,PriceChangeBagRow,UnavailableAssetsHeaderRow}from'nft/components/bag/BagRow';import{Column}from'nft/components/Flex';import{useBag,useIsMobile}from'nft/hooks';import{BagItemStatus,BagStatus}from'nft/types';import{fetchPrice,formatAssetEventProperties,recalculateBagUsingPooledAssets}from'nft/utils';import{useEffect,useMemo}from'react';import{useQuery}from'react-query';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var BagContent=function BagContent(){var bagStatus=useBag(function(s){return s.bagStatus;});var setBagStatus=useBag(function(s){return s.setBagStatus;});var markAssetAsReviewed=useBag(function(s){return s.markAssetAsReviewed;});var didOpenUnavailableAssets=useBag(function(s){return s.didOpenUnavailableAssets;});var setDidOpenUnavailableAssets=useBag(function(s){return s.setDidOpenUnavailableAssets;});var uncheckedItemsInBag=useBag(function(s){return s.itemsInBag;});var setItemsInBag=useBag(function(s){return s.setItemsInBag;});var removeAssetsFromBag=useBag(function(s){return s.removeAssetsFromBag;});var isMobile=useIsMobile();var itemsInBag=useMemo(function(){return recalculateBagUsingPooledAssets(uncheckedItemsInBag);},[uncheckedItemsInBag]);var _useQuery=useQuery(['fetchPrice',{}],function(){return fetchPrice();},{}),fetchedPriceData=_useQuery.data;var _useMemo=useMemo(function(){var unchangedAssets=itemsInBag.filter(function(item){return item.status===BagItemStatus.ADDED_TO_BAG||item.status===BagItemStatus.REVIEWED;}).map(function(item){return item.asset;});var priceChangedAssets=itemsInBag.filter(function(item){return item.status===BagItemStatus.REVIEWING_PRICE_CHANGE;}).map(function(item){return item.asset;});var unavailableAssets=itemsInBag.filter(function(item){return item.status===BagItemStatus.UNAVAILABLE;}).map(function(item){return item.asset;});var availableItems=itemsInBag.filter(function(item){return item.status!==BagItemStatus.UNAVAILABLE;});return{unchangedAssets:unchangedAssets,priceChangedAssets:priceChangedAssets,unavailableAssets:unavailableAssets,availableItems:availableItems};},[itemsInBag]),unchangedAssets=_useMemo.unchangedAssets,priceChangedAssets=_useMemo.priceChangedAssets,unavailableAssets=_useMemo.unavailableAssets,availableItems=_useMemo.availableItems;useEffect(function(){var hasAssetsInReview=priceChangedAssets.length>0;var hasAssets=itemsInBag.length>0;if(hasAssetsInReview)sendAnalyticsEvent(EventName.NFT_BUY_BAG_CHANGED,_objectSpread({usd_value:fetchedPriceData,bag_quantity:itemsInBag},formatAssetEventProperties(priceChangedAssets)));if(bagStatus===BagStatus.IN_REVIEW&&!hasAssetsInReview){if(hasAssets)setBagStatus(BagStatus.CONFIRM_REVIEW);else setBagStatus(BagStatus.ADDING_TO_BAG);}if(bagStatus===BagStatus.CONFIRM_REVIEW&&!hasAssets){setBagStatus(BagStatus.ADDING_TO_BAG);}},[bagStatus,itemsInBag,priceChangedAssets,setBagStatus,fetchedPriceData]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Column,{display:priceChangedAssets.length>0||unavailableAssets.length>0?'flex':'none',children:[unavailableAssets.length>0&&/*#__PURE__*/_jsx(Trace,{name:EventName.NFT_BUY_BAG_CHANGED,properties:_objectSpread({usd_value:fetchedPriceData,bag_quantity:itemsInBag.length},formatAssetEventProperties(unavailableAssets)),shouldLogImpression:true,children:/*#__PURE__*/_jsx(UnavailableAssetsHeaderRow,{assets:unavailableAssets,usdPrice:fetchedPriceData,clearUnavailableAssets:function clearUnavailableAssets(){return setItemsInBag(availableItems);},didOpenUnavailableAssets:didOpenUnavailableAssets,setDidOpenUnavailableAssets:setDidOpenUnavailableAssets,isMobile:isMobile})}),priceChangedAssets.map(function(asset,index){return/*#__PURE__*/_jsx(PriceChangeBagRow,{asset:asset,usdPrice:fetchedPriceData,markAssetAsReviewed:markAssetAsReviewed,top:index===0&&unavailableAssets.length===0,isMobile:isMobile},asset.id);})]}),/*#__PURE__*/_jsx(Column,{children:unchangedAssets.slice(0).reverse().map(function(asset){return/*#__PURE__*/_jsx(BagRow,{asset:asset,usdPrice:fetchedPriceData,removeAsset:removeAssetsFromBag,showRemove:true,isMobile:isMobile},asset.id);})})]});};","map":{"version":3,"names":["sendAnalyticsEvent","Trace","EventName","BagRow","PriceChangeBagRow","UnavailableAssetsHeaderRow","Column","useBag","useIsMobile","BagItemStatus","BagStatus","fetchPrice","formatAssetEventProperties","recalculateBagUsingPooledAssets","useEffect","useMemo","useQuery","BagContent","bagStatus","s","setBagStatus","markAssetAsReviewed","didOpenUnavailableAssets","setDidOpenUnavailableAssets","uncheckedItemsInBag","itemsInBag","setItemsInBag","removeAssetsFromBag","isMobile","fetchedPriceData","data","unchangedAssets","filter","item","status","ADDED_TO_BAG","REVIEWED","map","asset","priceChangedAssets","REVIEWING_PRICE_CHANGE","unavailableAssets","UNAVAILABLE","availableItems","hasAssetsInReview","length","hasAssets","NFT_BUY_BAG_CHANGED","usd_value","bag_quantity","IN_REVIEW","CONFIRM_REVIEW","ADDING_TO_BAG","index","id","slice","reverse"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/nft/components/bag/BagContent.tsx"],"sourcesContent":["import { sendAnalyticsEvent, Trace } from '@uniswap/analytics'\nimport { EventName } from '@uniswap/analytics-events'\nimport { BagRow, PriceChangeBagRow, UnavailableAssetsHeaderRow } from 'nft/components/bag/BagRow'\nimport { Column } from 'nft/components/Flex'\nimport { useBag, useIsMobile } from 'nft/hooks'\nimport { BagItemStatus, BagStatus } from 'nft/types'\nimport { fetchPrice, formatAssetEventProperties, recalculateBagUsingPooledAssets } from 'nft/utils'\nimport { useEffect, useMemo } from 'react'\nimport { useQuery } from 'react-query'\n\nexport const BagContent = () => {\n  const bagStatus = useBag((s) => s.bagStatus)\n  const setBagStatus = useBag((s) => s.setBagStatus)\n  const markAssetAsReviewed = useBag((s) => s.markAssetAsReviewed)\n  const didOpenUnavailableAssets = useBag((s) => s.didOpenUnavailableAssets)\n  const setDidOpenUnavailableAssets = useBag((s) => s.setDidOpenUnavailableAssets)\n  const uncheckedItemsInBag = useBag((s) => s.itemsInBag)\n  const setItemsInBag = useBag((s) => s.setItemsInBag)\n  const removeAssetsFromBag = useBag((s) => s.removeAssetsFromBag)\n\n  const isMobile = useIsMobile()\n\n  const itemsInBag = useMemo(() => {\n    return recalculateBagUsingPooledAssets(uncheckedItemsInBag)\n  }, [uncheckedItemsInBag])\n\n  const { data: fetchedPriceData } = useQuery(['fetchPrice', {}], () => fetchPrice(), {})\n\n  const { unchangedAssets, priceChangedAssets, unavailableAssets, availableItems } = useMemo(() => {\n    const unchangedAssets = itemsInBag\n      .filter((item) => item.status === BagItemStatus.ADDED_TO_BAG || item.status === BagItemStatus.REVIEWED)\n      .map((item) => item.asset)\n    const priceChangedAssets = itemsInBag\n      .filter((item) => item.status === BagItemStatus.REVIEWING_PRICE_CHANGE)\n      .map((item) => item.asset)\n    const unavailableAssets = itemsInBag\n      .filter((item) => item.status === BagItemStatus.UNAVAILABLE)\n      .map((item) => item.asset)\n    const availableItems = itemsInBag.filter((item) => item.status !== BagItemStatus.UNAVAILABLE)\n\n    return { unchangedAssets, priceChangedAssets, unavailableAssets, availableItems }\n  }, [itemsInBag])\n\n  useEffect(() => {\n    const hasAssetsInReview = priceChangedAssets.length > 0\n    const hasAssets = itemsInBag.length > 0\n\n    if (hasAssetsInReview)\n      sendAnalyticsEvent(EventName.NFT_BUY_BAG_CHANGED, {\n        usd_value: fetchedPriceData,\n        bag_quantity: itemsInBag,\n        ...formatAssetEventProperties(priceChangedAssets),\n      })\n\n    if (bagStatus === BagStatus.IN_REVIEW && !hasAssetsInReview) {\n      if (hasAssets) setBagStatus(BagStatus.CONFIRM_REVIEW)\n      else setBagStatus(BagStatus.ADDING_TO_BAG)\n    }\n\n    if (bagStatus === BagStatus.CONFIRM_REVIEW && !hasAssets) {\n      setBagStatus(BagStatus.ADDING_TO_BAG)\n    }\n  }, [bagStatus, itemsInBag, priceChangedAssets, setBagStatus, fetchedPriceData])\n\n  return (\n    <>\n      <Column display={priceChangedAssets.length > 0 || unavailableAssets.length > 0 ? 'flex' : 'none'}>\n        {unavailableAssets.length > 0 && (\n          <Trace\n            name={EventName.NFT_BUY_BAG_CHANGED}\n            properties={{\n              usd_value: fetchedPriceData,\n              bag_quantity: itemsInBag.length,\n              ...formatAssetEventProperties(unavailableAssets),\n            }}\n            shouldLogImpression\n          >\n            <UnavailableAssetsHeaderRow\n              assets={unavailableAssets}\n              usdPrice={fetchedPriceData}\n              clearUnavailableAssets={() => setItemsInBag(availableItems)}\n              didOpenUnavailableAssets={didOpenUnavailableAssets}\n              setDidOpenUnavailableAssets={setDidOpenUnavailableAssets}\n              isMobile={isMobile}\n            />\n          </Trace>\n        )}\n        {priceChangedAssets.map((asset, index) => (\n          <PriceChangeBagRow\n            key={asset.id}\n            asset={asset}\n            usdPrice={fetchedPriceData}\n            markAssetAsReviewed={markAssetAsReviewed}\n            top={index === 0 && unavailableAssets.length === 0}\n            isMobile={isMobile}\n          />\n        ))}\n      </Column>\n      <Column>\n        {unchangedAssets\n          .slice(0)\n          .reverse()\n          .map((asset) => (\n            <BagRow\n              key={asset.id}\n              asset={asset}\n              usdPrice={fetchedPriceData}\n              removeAsset={removeAssetsFromBag}\n              showRemove={true}\n              isMobile={isMobile}\n            />\n          ))}\n      </Column>\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}