{"ast":null,"code":"import { useTheme as _useTheme } from \"styled-components\";\nimport _styled from \"styled-components\";\nvar _jsxFileName = \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/Pools/PoolDetails/PriceChart.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { Trans } from \"@lingui/react\";\nimport { AxisBottom } from '@visx/axis';\nimport { localPoint } from '@visx/event';\nimport { GlyphCircle } from '@visx/glyph';\nimport { Line } from '@visx/shape';\nimport AnimatedInLineChart from 'components/Charts/AnimatedInLineChart';\nimport FadedInLineChart from 'components/Charts/FadeInLineChart';\nimport { bisect, curveCardinal, scaleLinear, timeDay, timeHour, timeMinute, timeMonth } from 'd3';\nimport { TimePeriod } from 'graphql/data/util';\nimport { useActiveLocale } from 'hooks/useActiveLocale';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { ArrowDownRight, ArrowUpRight, TrendingUp } from 'react-feather';\nimport { ThemedText } from 'theme';\nimport { textFadeIn } from 'theme/styles';\nimport { dayHourFormatter, hourFormatter, monthDayFormatter, monthTickFormatter, monthYearDayFormatter, weekFormatter } from 'utils/formatChartTimes';\nimport { formatDollar } from 'utils/formatNumbers';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DATA_EMPTY = {\n  value: 0,\n  timestamp: 0\n};\nexport function getPriceBounds(pricePoints) {\n  const prices = pricePoints.map(x => x.value);\n  const min = Math.min(...prices);\n  const max = Math.max(...prices);\n  return [min, max];\n}\nconst StyledUpArrow = _styled(ArrowUpRight).withConfig({\n  displayName: \"PriceChart__StyledUpArrow\",\n  componentId: \"sc-t2td99-0\"\n})([\"color:\", \";\"], _ref => {\n  let {\n    theme\n  } = _ref;\n  return theme.accentSuccess;\n});\nconst StyledDownArrow = _styled(ArrowDownRight).withConfig({\n  displayName: \"PriceChart__StyledDownArrow\",\n  componentId: \"sc-t2td99-1\"\n})([\"color:\", \";\"], _ref2 => {\n  let {\n    theme\n  } = _ref2;\n  return theme.accentFailure;\n});\nfunction calculateDelta(start, current) {\n  return (current / start - 1) * 100;\n}\nexport function getDeltaArrow(delta) {\n  let iconSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;\n  // Null-check not including zero\n  if (delta === null || delta === undefined) {\n    return null;\n  } else if (Math.sign(delta) < 0) {\n    return /*#__PURE__*/_jsxDEV(StyledDownArrow, {\n      size: iconSize,\n      \"aria-label\": \"down\"\n    }, \"arrow-down\", false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(StyledUpArrow, {\n    size: iconSize,\n    \"aria-label\": \"up\"\n  }, \"arrow-up\", false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 10\n  }, this);\n}\nexport function formatDelta(delta) {\n  // Null-check not including zero\n  if (delta === null || delta === undefined || delta === Infinity || isNaN(delta)) {\n    return '-';\n  }\n  const formattedDelta = Math.abs(delta).toFixed(2) + '%';\n  return formattedDelta;\n}\nexport const DeltaText = _styled.span.withConfig({\n  displayName: \"PriceChart__DeltaText\",\n  componentId: \"sc-t2td99-2\"\n})([\"color:\", \";\"], _ref3 => {\n  let {\n    theme,\n    delta\n  } = _ref3;\n  return delta !== undefined ? Math.sign(delta) < 0 ? theme.accentFailure : theme.accentSuccess : theme.textPrimary;\n});\nconst ChartHeader = _styled.div.withConfig({\n  displayName: \"PriceChart__ChartHeader\",\n  componentId: \"sc-t2td99-3\"\n})([\"position:absolute;\", \";animation-duration:\", \";\"], textFadeIn, _ref4 => {\n  let {\n    theme\n  } = _ref4;\n  return theme.transition.duration.medium;\n});\nexport const TokenPrice = _styled.span.withConfig({\n  displayName: \"PriceChart__TokenPrice\",\n  componentId: \"sc-t2td99-4\"\n})([\"font-size:36px;line-height:44px;\"]);\nconst MissingPrice = _styled(TokenPrice).withConfig({\n  displayName: \"PriceChart__MissingPrice\",\n  componentId: \"sc-t2td99-5\"\n})([\"font-size:24px;line-height:44px;color:\", \";\"], _ref5 => {\n  let {\n    theme\n  } = _ref5;\n  return theme.textTertiary;\n});\nconst DeltaContainer = _styled.div.withConfig({\n  displayName: \"PriceChart__DeltaContainer\",\n  componentId: \"sc-t2td99-6\"\n})([\"height:16px;display:flex;align-items:center;margin-top:4px;\"]);\nexport const ArrowCell = _styled.div.withConfig({\n  displayName: \"PriceChart__ArrowCell\",\n  componentId: \"sc-t2td99-7\"\n})([\"padding-right:3px;display:flex;\"]);\nfunction fixChart(prices) {\n  if (!prices) return {\n    prices: null,\n    blanks: []\n  };\n  const fixedChart = [];\n  const blanks = [];\n  let lastValue = undefined;\n  for (let i = 0; i < prices.length; i++) {\n    if (prices[i].value !== 0) {\n      if (fixedChart.length === 0 && i !== 0) {\n        blanks.push([{\n          ...prices[0],\n          value: prices[i].value\n        }, prices[i]]);\n      }\n      lastValue = prices[i];\n      fixedChart.push(prices[i]);\n    }\n  }\n  if (lastValue && lastValue !== prices[prices.length - 1]) {\n    blanks.push([lastValue, {\n      ...prices[prices.length - 1],\n      value: lastValue.value\n    }]);\n  }\n  return {\n    prices: fixedChart,\n    blanks\n  };\n}\nconst margin = {\n  top: 100,\n  bottom: 48,\n  crosshair: 72\n};\nconst timeOptionsHeight = 44;\nexport function PriceChart(_ref6) {\n  _s();\n  var _originalPrices$, _originalPrices;\n  let {\n    width,\n    height,\n    prices: originalPrices,\n    timePeriod\n  } = _ref6;\n  const locale = useActiveLocale();\n  const theme = _useTheme();\n  const {\n    prices,\n    blanks\n  } = useMemo(() => originalPrices && originalPrices.length > 0 ? fixChart(originalPrices) : {\n    prices: null,\n    blanks: []\n  }, [originalPrices]);\n  const chartAvailable = !!prices && prices.length > 0;\n  const missingPricesMessage = !chartAvailable ? (prices === null || prices === void 0 ? void 0 : prices.length) === 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Trans, {\n      id: \"Missing price data due to recently low trading volume on Uniswap v3\"\n    }, void 0, false, void 0, this)\n  }, void 0, false) : /*#__PURE__*/_jsxDEV(Trans, {\n    id: \"Missing chart data\"\n  }, void 0, false, void 0, this) : null;\n\n  // first price point on the x-axis of the current time period's chart\n  const startingPrice = (_originalPrices$ = originalPrices === null || originalPrices === void 0 ? void 0 : originalPrices[0]) !== null && _originalPrices$ !== void 0 ? _originalPrices$ : DATA_EMPTY;\n  // last price point on the x-axis of the current time period's chart\n  const endingPrice = (_originalPrices = originalPrices === null || originalPrices === void 0 ? void 0 : originalPrices[originalPrices.length - 1]) !== null && _originalPrices !== void 0 ? _originalPrices : DATA_EMPTY;\n  const [displayPrice, setDisplayPrice] = useState(startingPrice);\n\n  // set display price to ending price when prices have changed.\n  useEffect(() => {\n    setDisplayPrice(endingPrice);\n  }, [prices, endingPrice]);\n  const [crosshair, setCrosshair] = useState(null);\n  const graphHeight = height - timeOptionsHeight > 0 ? height - timeOptionsHeight : 0;\n  const graphInnerHeight = graphHeight - margin.top - margin.bottom > 0 ? graphHeight - margin.top - margin.bottom : 0;\n\n  // Defining scales\n  // x scale\n  const timeScale = useMemo(() => scaleLinear().domain([startingPrice.timestamp, endingPrice.timestamp]).range([0, width]), [startingPrice, endingPrice, width]);\n  // y scale\n  const rdScale = useMemo(() => scaleLinear().domain(getPriceBounds(originalPrices !== null && originalPrices !== void 0 ? originalPrices : [])).range([graphInnerHeight, 0]), [originalPrices, graphInnerHeight]);\n  function tickFormat(timePeriod, locale) {\n    var _timeMinute$every;\n    const offsetTime = (endingPrice.timestamp.valueOf() - startingPrice.timestamp.valueOf()) / 24;\n    const startDateWithOffset = new Date((startingPrice.timestamp.valueOf() + offsetTime) * 1000);\n    const endDateWithOffset = new Date((endingPrice.timestamp.valueOf() - offsetTime) * 1000);\n    switch (timePeriod) {\n      case TimePeriod.HOUR:\n        return [hourFormatter(locale), dayHourFormatter(locale), ((_timeMinute$every = timeMinute.every(5)) !== null && _timeMinute$every !== void 0 ? _timeMinute$every : timeMinute).range(startDateWithOffset, endDateWithOffset, 2).map(x => x.valueOf() / 1000)];\n      case TimePeriod.DAY:\n        return [hourFormatter(locale), dayHourFormatter(locale), timeHour.range(startDateWithOffset, endDateWithOffset, 4).map(x => x.valueOf() / 1000)];\n      case TimePeriod.WEEK:\n        return [weekFormatter(locale), dayHourFormatter(locale), timeDay.range(startDateWithOffset, endDateWithOffset, 1).map(x => x.valueOf() / 1000)];\n      case TimePeriod.MONTH:\n        return [monthDayFormatter(locale), dayHourFormatter(locale), timeDay.range(startDateWithOffset, endDateWithOffset, 7).map(x => x.valueOf() / 1000)];\n      case TimePeriod.YEAR:\n        return [monthTickFormatter(locale), monthYearDayFormatter(locale), timeMonth.range(startDateWithOffset, endDateWithOffset, 2).map(x => x.valueOf() / 1000)];\n    }\n  }\n  const handleHover = useCallback(event => {\n    if (!prices) return;\n    const {\n      x\n    } = localPoint(event) || {\n      x: 0\n    };\n    const x0 = timeScale.invert(x); // get timestamp from the scalexw\n    const index = bisect(prices.map(x => x.timestamp), x0, 1);\n    const d0 = prices[index - 1];\n    const d1 = prices[index];\n    let pricePoint = d0;\n    const hasPreviousData = d1 && d1.timestamp;\n    if (hasPreviousData) {\n      pricePoint = x0.valueOf() - d0.timestamp.valueOf() > d1.timestamp.valueOf() - x0.valueOf() ? d1 : d0;\n    }\n    if (pricePoint) {\n      setCrosshair(timeScale(pricePoint.timestamp));\n      setDisplayPrice(pricePoint);\n    }\n  }, [timeScale, prices]);\n  const resetDisplay = useCallback(() => {\n    setCrosshair(null);\n    setDisplayPrice(endingPrice);\n  }, [setCrosshair, setDisplayPrice, endingPrice]);\n  const [tickFormatter, crosshairDateFormatter, ticks] = tickFormat(timePeriod, locale);\n  const delta = calculateDelta(startingPrice.value, displayPrice.value);\n  const formattedDelta = formatDelta(delta);\n  const arrow = getDeltaArrow(delta);\n  const crosshairEdgeMax = width * 0.85;\n  const crosshairAtEdge = !!crosshair && crosshair > crosshairEdgeMax;\n\n  /*\n   * Default curve doesn't look good for the HOUR chart.\n   * Higher values make the curve more rigid, lower values smooth the curve but make it less \"sticky\" to real data points,\n   * making it unacceptable for shorter durations / smaller variances.\n   */\n  const curveTension = timePeriod === TimePeriod.HOUR ? 1 : 0.9;\n  const getX = useMemo(() => p => timeScale(p.timestamp), [timeScale]);\n  const getY = useMemo(() => p => rdScale(p.value), [rdScale]);\n  const curve = useMemo(() => curveCardinal.tension(curveTension), [curveTension]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(ChartHeader, {\n      children: displayPrice.value ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(TokenPrice, {\n          children: formatDollar({\n            num: displayPrice.value,\n            isPrice: true\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DeltaContainer, {\n          children: [formattedDelta, /*#__PURE__*/_jsxDEV(ArrowCell, {\n            children: arrow\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(MissingPrice, {\n          children: \"Price Unavailable\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ThemedText.Caption, {\n          style: {\n            color: theme.textTertiary\n          },\n          children: missingPricesMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), !chartAvailable ? /*#__PURE__*/_jsxDEV(MissingPriceChart, {\n      width: width,\n      height: graphHeight,\n      message: !!displayPrice.value && missingPricesMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n      width: width,\n      height: graphHeight,\n      style: {\n        minWidth: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(AnimatedInLineChart, {\n        data: prices,\n        getX: getX,\n        getY: getY,\n        marginTop: margin.top,\n        curve: curve,\n        strokeWidth: 2\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this), blanks.map((blank, index) => /*#__PURE__*/_jsxDEV(FadedInLineChart, {\n        data: blank,\n        getX: getX,\n        getY: getY,\n        marginTop: margin.top,\n        curve: curve,\n        strokeWidth: 2,\n        color: theme.textTertiary,\n        dashed: true\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 13\n      }, this)), crosshair !== null ? /*#__PURE__*/_jsxDEV(\"g\", {\n        children: [/*#__PURE__*/_jsxDEV(AxisBottom, {\n          scale: timeScale,\n          stroke: theme.backgroundOutline,\n          tickFormat: tickFormatter,\n          tickStroke: theme.backgroundOutline,\n          tickLength: 4,\n          hideTicks: true,\n          tickTransform: \"translate(0 -5)\",\n          tickValues: ticks,\n          top: graphHeight - 1,\n          tickLabelProps: () => ({\n            fill: theme.textSecondary,\n            fontSize: 12,\n            textAnchor: 'middle',\n            transform: 'translate(0 -24)'\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n          x: crosshair + (crosshairAtEdge ? -4 : 4),\n          y: margin.crosshair + 10,\n          textAnchor: crosshairAtEdge ? 'end' : 'start',\n          fontSize: 12,\n          fill: theme.textSecondary,\n          children: crosshairDateFormatter(displayPrice.timestamp)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Line, {\n          from: {\n            x: crosshair,\n            y: margin.crosshair\n          },\n          to: {\n            x: crosshair,\n            y: graphHeight\n          },\n          stroke: theme.backgroundOutline,\n          strokeWidth: 1,\n          pointerEvents: \"none\",\n          strokeDasharray: \"4,4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(GlyphCircle, {\n          left: crosshair,\n          top: rdScale(displayPrice.value) + margin.top,\n          size: 50,\n          fill: theme.accentAction,\n          stroke: theme.backgroundOutline,\n          strokeWidth: 0.5\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(AxisBottom, {\n        hideAxisLine: true,\n        scale: timeScale,\n        stroke: theme.backgroundOutline,\n        top: graphHeight - 1,\n        hideTicks: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 13\n      }, this), !width &&\n      /*#__PURE__*/\n      // Ensures an axis is drawn even if the width is not yet initialized.\n      _jsxDEV(\"line\", {\n        x1: 0,\n        y1: graphHeight - 1,\n        x2: \"100%\",\n        y2: graphHeight - 1,\n        fill: \"transparent\",\n        shapeRendering: \"crispEdges\",\n        stroke: theme.backgroundOutline,\n        strokeWidth: 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n        x: 0,\n        y: 0,\n        width: width,\n        height: graphHeight,\n        fill: \"transparent\",\n        onTouchStart: handleHover,\n        onTouchMove: handleHover,\n        onMouseMove: handleHover,\n        onMouseLeave: resetDisplay\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(PriceChart, \"JvR8PLCYZHU06dxm+bxoyFPdI/w=\", false, function () {\n  return [useActiveLocale, _useTheme];\n});\n_c = PriceChart;\nconst StyledMissingChart = _styled.svg.withConfig({\n  displayName: \"PriceChart__StyledMissingChart\",\n  componentId: \"sc-t2td99-8\"\n})([\"text{font-size:12px;font-weight:400;}\"]);\nconst chartBottomPadding = 15;\nfunction MissingPriceChart(_ref7) {\n  _s2();\n  let {\n    width,\n    height,\n    message\n  } = _ref7;\n  const theme = _useTheme();\n  const midPoint = height / 2 + 45;\n  return /*#__PURE__*/_jsxDEV(StyledMissingChart, {\n    width: width,\n    height: height,\n    style: {\n      minWidth: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"path\", {\n      d: `M 0 ${midPoint} Q 104 ${midPoint - 70}, 208 ${midPoint} T 416 ${midPoint}\n          M 416 ${midPoint} Q 520 ${midPoint - 70}, 624 ${midPoint} T 832 ${midPoint}`,\n      stroke: theme.backgroundOutline,\n      fill: \"transparent\",\n      strokeWidth: \"2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(TrendingUp, {\n      stroke: theme.textTertiary,\n      x: 0,\n      size: 12,\n      y: height - chartBottomPadding - 10\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      y: height - chartBottomPadding,\n      x: \"20\",\n      fill: theme.textTertiary,\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 414,\n    columnNumber: 5\n  }, this);\n}\n_s2(MissingPriceChart, \"VrMvFCCB9Haniz3VCRPNUiCauHs=\", false, function () {\n  return [_useTheme];\n});\n_c2 = MissingPriceChart;\nvar _c, _c2;\n$RefreshReg$(_c, \"PriceChart\");\n$RefreshReg$(_c2, \"MissingPriceChart\");","map":{"version":3,"names":["AxisBottom","localPoint","GlyphCircle","Line","AnimatedInLineChart","FadedInLineChart","bisect","curveCardinal","scaleLinear","timeDay","timeHour","timeMinute","timeMonth","TimePeriod","useActiveLocale","useCallback","useEffect","useMemo","useState","ArrowDownRight","ArrowUpRight","TrendingUp","ThemedText","textFadeIn","dayHourFormatter","hourFormatter","monthDayFormatter","monthTickFormatter","monthYearDayFormatter","weekFormatter","formatDollar","DATA_EMPTY","value","timestamp","getPriceBounds","pricePoints","prices","map","x","min","Math","max","StyledUpArrow","styled","theme","accentSuccess","StyledDownArrow","accentFailure","calculateDelta","start","current","getDeltaArrow","delta","iconSize","undefined","sign","formatDelta","Infinity","isNaN","formattedDelta","abs","toFixed","DeltaText","span","textPrimary","ChartHeader","div","transition","duration","medium","TokenPrice","MissingPrice","textTertiary","DeltaContainer","ArrowCell","fixChart","blanks","fixedChart","lastValue","i","length","push","margin","top","bottom","crosshair","timeOptionsHeight","PriceChart","width","height","originalPrices","timePeriod","locale","useTheme","chartAvailable","missingPricesMessage","startingPrice","endingPrice","displayPrice","setDisplayPrice","setCrosshair","graphHeight","graphInnerHeight","timeScale","domain","range","rdScale","tickFormat","offsetTime","valueOf","startDateWithOffset","Date","endDateWithOffset","HOUR","every","DAY","WEEK","MONTH","YEAR","handleHover","event","x0","invert","index","d0","d1","pricePoint","hasPreviousData","resetDisplay","tickFormatter","crosshairDateFormatter","ticks","arrow","crosshairEdgeMax","crosshairAtEdge","curveTension","getX","p","getY","curve","tension","num","isPrice","color","minWidth","blank","backgroundOutline","fill","textSecondary","fontSize","textAnchor","transform","y","accentAction","StyledMissingChart","svg","chartBottomPadding","MissingPriceChart","message","midPoint"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/Pools/PoolDetails/PriceChart.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { AxisBottom, TickFormatter } from '@visx/axis'\nimport { localPoint } from '@visx/event'\nimport { EventType } from '@visx/event/lib/types'\nimport { GlyphCircle } from '@visx/glyph'\nimport { Line } from '@visx/shape'\nimport AnimatedInLineChart from 'components/Charts/AnimatedInLineChart'\nimport FadedInLineChart from 'components/Charts/FadeInLineChart'\nimport { bisect, curveCardinal, NumberValue, scaleLinear, timeDay, timeHour, timeMinute, timeMonth } from 'd3'\nimport { PricePoint } from 'graphql/data/util'\nimport { TimePeriod } from 'graphql/data/util'\nimport { useActiveLocale } from 'hooks/useActiveLocale'\nimport { ReactNode, useCallback, useEffect, useMemo, useState } from 'react'\nimport { ArrowDownRight, ArrowUpRight, TrendingUp } from 'react-feather'\nimport styled, { useTheme } from 'styled-components/macro'\nimport { ThemedText } from 'theme'\nimport { textFadeIn } from 'theme/styles'\nimport {\n  dayHourFormatter,\n  hourFormatter,\n  monthDayFormatter,\n  monthTickFormatter,\n  monthYearDayFormatter,\n  weekFormatter,\n} from 'utils/formatChartTimes'\nimport { formatDollar } from 'utils/formatNumbers'\n\nconst DATA_EMPTY = { value: 0, timestamp: 0 }\n\nexport function getPriceBounds(pricePoints: PricePoint[]): [number, number] {\n  const prices = pricePoints.map((x) => x.value)\n  const min = Math.min(...prices)\n  const max = Math.max(...prices)\n  return [min, max]\n}\n\nconst StyledUpArrow = styled(ArrowUpRight)`\n  color: ${({ theme }) => theme.accentSuccess};\n`\nconst StyledDownArrow = styled(ArrowDownRight)`\n  color: ${({ theme }) => theme.accentFailure};\n`\n\nfunction calculateDelta(start: number, current: number) {\n  return (current / start - 1) * 100\n}\n\nexport function getDeltaArrow(delta: number | null | undefined, iconSize = 20) {\n  // Null-check not including zero\n  if (delta === null || delta === undefined) {\n    return null\n  } else if (Math.sign(delta) < 0) {\n    return <StyledDownArrow size={iconSize} key=\"arrow-down\" aria-label=\"down\" />\n  }\n  return <StyledUpArrow size={iconSize} key=\"arrow-up\" aria-label=\"up\" />\n}\n\nexport function formatDelta(delta: number | null | undefined) {\n  // Null-check not including zero\n  if (delta === null || delta === undefined || delta === Infinity || isNaN(delta)) {\n    return '-'\n  }\n  const formattedDelta = Math.abs(delta).toFixed(2) + '%'\n  return formattedDelta\n}\n\nexport const DeltaText = styled.span<{ delta: number | undefined }>`\n  color: ${({ theme, delta }) =>\n    delta !== undefined ? (Math.sign(delta) < 0 ? theme.accentFailure : theme.accentSuccess) : theme.textPrimary};\n`\n\nconst ChartHeader = styled.div`\n  position: absolute;\n  ${textFadeIn};\n  animation-duration: ${({ theme }) => theme.transition.duration.medium};\n`\nexport const TokenPrice = styled.span`\n  font-size: 36px;\n  line-height: 44px;\n`\nconst MissingPrice = styled(TokenPrice)`\n  font-size: 24px;\n  line-height: 44px;\n  color: ${({ theme }) => theme.textTertiary};\n`\n\nconst DeltaContainer = styled.div`\n  height: 16px;\n  display: flex;\n  align-items: center;\n  margin-top: 4px;\n`\nexport const ArrowCell = styled.div`\n  padding-right: 3px;\n  display: flex;\n`\n\nfunction fixChart(prices: PricePoint[] | undefined | null) {\n  if (!prices) return { prices: null, blanks: [] }\n\n  const fixedChart: PricePoint[] = []\n  const blanks: PricePoint[][] = []\n  let lastValue: PricePoint | undefined = undefined\n  for (let i = 0; i < prices.length; i++) {\n    if (prices[i].value !== 0) {\n      if (fixedChart.length === 0 && i !== 0) {\n        blanks.push([{ ...prices[0], value: prices[i].value }, prices[i]])\n      }\n      lastValue = prices[i]\n      fixedChart.push(prices[i])\n    }\n  }\n\n  if (lastValue && lastValue !== prices[prices.length - 1]) {\n    blanks.push([lastValue, { ...prices[prices.length - 1], value: lastValue.value }])\n  }\n\n  return { prices: fixedChart, blanks }\n}\n\nconst margin = { top: 100, bottom: 48, crosshair: 72 }\nconst timeOptionsHeight = 44\n\ninterface PriceChartProps {\n  width: number\n  height: number\n  prices: PricePoint[] | undefined | null\n  timePeriod: TimePeriod\n}\n\nexport function PriceChart({ width, height, prices: originalPrices, timePeriod }: PriceChartProps) {\n  const locale = useActiveLocale()\n  const theme = useTheme()\n\n  const { prices, blanks } = useMemo(\n    () => (originalPrices && originalPrices.length > 0 ? fixChart(originalPrices) : { prices: null, blanks: [] }),\n    [originalPrices]\n  )\n\n  const chartAvailable = !!prices && prices.length > 0\n  const missingPricesMessage = !chartAvailable ? (\n    prices?.length === 0 ? (\n      <>\n        <Trans>Missing price data due to recently low trading volume on Uniswap v3</Trans>\n      </>\n    ) : (\n      <Trans>Missing chart data</Trans>\n    )\n  ) : null\n\n  // first price point on the x-axis of the current time period's chart\n  const startingPrice = originalPrices?.[0] ?? DATA_EMPTY\n  // last price point on the x-axis of the current time period's chart\n  const endingPrice = originalPrices?.[originalPrices.length - 1] ?? DATA_EMPTY\n  const [displayPrice, setDisplayPrice] = useState(startingPrice)\n\n  // set display price to ending price when prices have changed.\n  useEffect(() => {\n    setDisplayPrice(endingPrice)\n  }, [prices, endingPrice])\n  const [crosshair, setCrosshair] = useState<number | null>(null)\n\n  const graphHeight = height - timeOptionsHeight > 0 ? height - timeOptionsHeight : 0\n  const graphInnerHeight = graphHeight - margin.top - margin.bottom > 0 ? graphHeight - margin.top - margin.bottom : 0\n\n  // Defining scales\n  // x scale\n  const timeScale = useMemo(\n    () => scaleLinear().domain([startingPrice.timestamp, endingPrice.timestamp]).range([0, width]),\n    [startingPrice, endingPrice, width]\n  )\n  // y scale\n  const rdScale = useMemo(\n    () =>\n      scaleLinear()\n        .domain(getPriceBounds(originalPrices ?? []))\n        .range([graphInnerHeight, 0]),\n    [originalPrices, graphInnerHeight]\n  )\n\n  function tickFormat(\n    timePeriod: TimePeriod,\n    locale: string\n  ): [TickFormatter<NumberValue>, (v: number) => string, NumberValue[]] {\n    const offsetTime = (endingPrice.timestamp.valueOf() - startingPrice.timestamp.valueOf()) / 24\n    const startDateWithOffset = new Date((startingPrice.timestamp.valueOf() + offsetTime) * 1000)\n    const endDateWithOffset = new Date((endingPrice.timestamp.valueOf() - offsetTime) * 1000)\n    switch (timePeriod) {\n      case TimePeriod.HOUR:\n        return [\n          hourFormatter(locale),\n          dayHourFormatter(locale),\n          (timeMinute.every(5) ?? timeMinute)\n            .range(startDateWithOffset, endDateWithOffset, 2)\n            .map((x) => x.valueOf() / 1000),\n        ]\n      case TimePeriod.DAY:\n        return [\n          hourFormatter(locale),\n          dayHourFormatter(locale),\n          timeHour.range(startDateWithOffset, endDateWithOffset, 4).map((x) => x.valueOf() / 1000),\n        ]\n      case TimePeriod.WEEK:\n        return [\n          weekFormatter(locale),\n          dayHourFormatter(locale),\n          timeDay.range(startDateWithOffset, endDateWithOffset, 1).map((x) => x.valueOf() / 1000),\n        ]\n      case TimePeriod.MONTH:\n        return [\n          monthDayFormatter(locale),\n          dayHourFormatter(locale),\n          timeDay.range(startDateWithOffset, endDateWithOffset, 7).map((x) => x.valueOf() / 1000),\n        ]\n      case TimePeriod.YEAR:\n        return [\n          monthTickFormatter(locale),\n          monthYearDayFormatter(locale),\n          timeMonth.range(startDateWithOffset, endDateWithOffset, 2).map((x) => x.valueOf() / 1000),\n        ]\n    }\n  }\n\n  const handleHover = useCallback(\n    (event: Element | EventType) => {\n      if (!prices) return\n\n      const { x } = localPoint(event) || { x: 0 }\n      const x0 = timeScale.invert(x) // get timestamp from the scalexw\n      const index = bisect(\n        prices.map((x) => x.timestamp),\n        x0,\n        1\n      )\n\n      const d0 = prices[index - 1]\n      const d1 = prices[index]\n      let pricePoint = d0\n\n      const hasPreviousData = d1 && d1.timestamp\n      if (hasPreviousData) {\n        pricePoint = x0.valueOf() - d0.timestamp.valueOf() > d1.timestamp.valueOf() - x0.valueOf() ? d1 : d0\n      }\n\n      if (pricePoint) {\n        setCrosshair(timeScale(pricePoint.timestamp))\n        setDisplayPrice(pricePoint)\n      }\n    },\n    [timeScale, prices]\n  )\n\n  const resetDisplay = useCallback(() => {\n    setCrosshair(null)\n    setDisplayPrice(endingPrice)\n  }, [setCrosshair, setDisplayPrice, endingPrice])\n\n  const [tickFormatter, crosshairDateFormatter, ticks] = tickFormat(timePeriod, locale)\n  const delta = calculateDelta(startingPrice.value, displayPrice.value)\n  const formattedDelta = formatDelta(delta)\n  const arrow = getDeltaArrow(delta)\n  const crosshairEdgeMax = width * 0.85\n  const crosshairAtEdge = !!crosshair && crosshair > crosshairEdgeMax\n\n  /*\n   * Default curve doesn't look good for the HOUR chart.\n   * Higher values make the curve more rigid, lower values smooth the curve but make it less \"sticky\" to real data points,\n   * making it unacceptable for shorter durations / smaller variances.\n   */\n  const curveTension = timePeriod === TimePeriod.HOUR ? 1 : 0.9\n\n  const getX = useMemo(() => (p: PricePoint) => timeScale(p.timestamp), [timeScale])\n  const getY = useMemo(() => (p: PricePoint) => rdScale(p.value), [rdScale])\n  const curve = useMemo(() => curveCardinal.tension(curveTension), [curveTension])\n\n  return (\n    <>\n      <ChartHeader>\n        {displayPrice.value ? (\n          <>\n            <TokenPrice>{formatDollar({ num: displayPrice.value, isPrice: true })}</TokenPrice>\n            <DeltaContainer>\n              {formattedDelta}\n              <ArrowCell>{arrow}</ArrowCell>\n            </DeltaContainer>\n          </>\n        ) : (\n          <>\n            <MissingPrice>Price Unavailable</MissingPrice>\n            <ThemedText.Caption style={{ color: theme.textTertiary }}>{missingPricesMessage}</ThemedText.Caption>\n          </>\n        )}\n      </ChartHeader>\n      {!chartAvailable ? (\n        <MissingPriceChart width={width} height={graphHeight} message={!!displayPrice.value && missingPricesMessage} />\n      ) : (\n        <svg width={width} height={graphHeight} style={{ minWidth: '100%' }}>\n          <AnimatedInLineChart\n            data={prices}\n            getX={getX}\n            getY={getY}\n            marginTop={margin.top}\n            curve={curve}\n            strokeWidth={2}\n          />\n          {blanks.map((blank, index) => (\n            <FadedInLineChart\n              key={index}\n              data={blank}\n              getX={getX}\n              getY={getY}\n              marginTop={margin.top}\n              curve={curve}\n              strokeWidth={2}\n              color={theme.textTertiary}\n              dashed\n            />\n          ))}\n          {crosshair !== null ? (\n            <g>\n              <AxisBottom\n                scale={timeScale}\n                stroke={theme.backgroundOutline}\n                tickFormat={tickFormatter}\n                tickStroke={theme.backgroundOutline}\n                tickLength={4}\n                hideTicks={true}\n                tickTransform=\"translate(0 -5)\"\n                tickValues={ticks}\n                top={graphHeight - 1}\n                tickLabelProps={() => ({\n                  fill: theme.textSecondary,\n                  fontSize: 12,\n                  textAnchor: 'middle',\n                  transform: 'translate(0 -24)',\n                })}\n              />\n              <text\n                x={crosshair + (crosshairAtEdge ? -4 : 4)}\n                y={margin.crosshair + 10}\n                textAnchor={crosshairAtEdge ? 'end' : 'start'}\n                fontSize={12}\n                fill={theme.textSecondary}\n              >\n                {crosshairDateFormatter(displayPrice.timestamp)}\n              </text>\n              <Line\n                from={{ x: crosshair, y: margin.crosshair }}\n                to={{ x: crosshair, y: graphHeight }}\n                stroke={theme.backgroundOutline}\n                strokeWidth={1}\n                pointerEvents=\"none\"\n                strokeDasharray=\"4,4\"\n              />\n              <GlyphCircle\n                left={crosshair}\n                top={rdScale(displayPrice.value) + margin.top}\n                size={50}\n                fill={theme.accentAction}\n                stroke={theme.backgroundOutline}\n                strokeWidth={0.5}\n              />\n            </g>\n          ) : (\n            <AxisBottom\n              hideAxisLine={true}\n              scale={timeScale}\n              stroke={theme.backgroundOutline}\n              top={graphHeight - 1}\n              hideTicks\n            />\n          )}\n          {!width && (\n            // Ensures an axis is drawn even if the width is not yet initialized.\n            <line\n              x1={0}\n              y1={graphHeight - 1}\n              x2=\"100%\"\n              y2={graphHeight - 1}\n              fill=\"transparent\"\n              shapeRendering=\"crispEdges\"\n              stroke={theme.backgroundOutline}\n              strokeWidth={1}\n            />\n          )}\n          <rect\n            x={0}\n            y={0}\n            width={width}\n            height={graphHeight}\n            fill=\"transparent\"\n            onTouchStart={handleHover}\n            onTouchMove={handleHover}\n            onMouseMove={handleHover}\n            onMouseLeave={resetDisplay}\n          />\n        </svg>\n      )}\n    </>\n  )\n}\n\nconst StyledMissingChart = styled.svg`\n  text {\n    font-size: 12px;\n    font-weight: 400;\n  }\n`\nconst chartBottomPadding = 15\nfunction MissingPriceChart({ width, height, message }: { width: number; height: number; message: ReactNode }) {\n  const theme = useTheme()\n  const midPoint = height / 2 + 45\n  return (\n    <StyledMissingChart width={width} height={height} style={{ minWidth: '100%' }}>\n      <path\n        d={`M 0 ${midPoint} Q 104 ${midPoint - 70}, 208 ${midPoint} T 416 ${midPoint}\n          M 416 ${midPoint} Q 520 ${midPoint - 70}, 624 ${midPoint} T 832 ${midPoint}`}\n        stroke={theme.backgroundOutline}\n        fill=\"transparent\"\n        strokeWidth=\"2\"\n      />\n      {message && <TrendingUp stroke={theme.textTertiary} x={0} size={12} y={height - chartBottomPadding - 10} />}\n      <text y={height - chartBottomPadding} x=\"20\" fill={theme.textTertiary}>\n        {message}\n      </text>\n    </StyledMissingChart>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}