{"ast":null,"code":"import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{BigNumber}from'@ethersproject/bignumber';import{CurrencyAmount}from'@uniswap/sdk-core';import{useSingleCallResult}from'lib/hooks/multicall';import useBlockNumber from'lib/hooks/useBlockNumber';import{useEffect,useState}from'react';import{unwrappedToken}from'utils/unwrappedToken';import{useV3NFTPositionManagerContract}from'./useContract';var MAX_UINT128=BigNumber.from(2).pow(128).sub(1);// compute current + counterfactual fees for a v3 position\nexport function useV3PositionFees(pool,tokenId){var _useSingleCallResult$;var asWETH=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var positionManager=useV3NFTPositionManagerContract(false);var owner=(_useSingleCallResult$=useSingleCallResult(tokenId?positionManager:null,'ownerOf',[tokenId]).result)===null||_useSingleCallResult$===void 0?void 0:_useSingleCallResult$[0];var tokenIdHexString=tokenId===null||tokenId===void 0?void 0:tokenId.toHexString();var latestBlockNumber=useBlockNumber();// we can't use multicall for this because we need to simulate the call from a specific address\n// latestBlockNumber is included to ensure data stays up-to-date every block\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),amounts=_useState2[0],setAmounts=_useState2[1];useEffect(function(){if(positionManager&&tokenIdHexString&&owner){positionManager.callStatic.collect({tokenId:tokenIdHexString,recipient:owner,// some tokens might fail if transferred to address(0)\namount0Max:MAX_UINT128,amount1Max:MAX_UINT128},{from:owner}// need to simulate the call as the owner\n).then(function(results){setAmounts([results.amount0,results.amount1]);});}},[positionManager,tokenIdHexString,owner,latestBlockNumber]);if(pool&&amounts){return[CurrencyAmount.fromRawAmount(asWETH?pool.token0:unwrappedToken(pool.token0),amounts[0].toString()),CurrencyAmount.fromRawAmount(asWETH?pool.token1:unwrappedToken(pool.token1),amounts[1].toString())];}else{return[undefined,undefined];}}","map":{"version":3,"names":["BigNumber","CurrencyAmount","useSingleCallResult","useBlockNumber","useEffect","useState","unwrappedToken","useV3NFTPositionManagerContract","MAX_UINT128","from","pow","sub","useV3PositionFees","pool","tokenId","asWETH","positionManager","owner","result","tokenIdHexString","toHexString","latestBlockNumber","amounts","setAmounts","callStatic","collect","recipient","amount0Max","amount1Max","then","results","amount0","amount1","fromRawAmount","token0","toString","token1","undefined"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/hooks/useV3PositionFees.ts"],"sourcesContent":["import { BigNumber } from '@ethersproject/bignumber'\nimport { Currency, CurrencyAmount } from '@uniswap/sdk-core'\nimport { Pool } from '@uniswap/v3-sdk'\nimport { useSingleCallResult } from 'lib/hooks/multicall'\nimport useBlockNumber from 'lib/hooks/useBlockNumber'\nimport { useEffect, useState } from 'react'\nimport { unwrappedToken } from 'utils/unwrappedToken'\n\nimport { useV3NFTPositionManagerContract } from './useContract'\n\nconst MAX_UINT128 = BigNumber.from(2).pow(128).sub(1)\n\n// compute current + counterfactual fees for a v3 position\nexport function useV3PositionFees(\n  pool?: Pool,\n  tokenId?: BigNumber,\n  asWETH = false\n): [CurrencyAmount<Currency>, CurrencyAmount<Currency>] | [undefined, undefined] {\n  const positionManager = useV3NFTPositionManagerContract(false)\n  const owner: string | undefined = useSingleCallResult(tokenId ? positionManager : null, 'ownerOf', [tokenId])\n    .result?.[0]\n\n  const tokenIdHexString = tokenId?.toHexString()\n  const latestBlockNumber = useBlockNumber()\n\n  // we can't use multicall for this because we need to simulate the call from a specific address\n  // latestBlockNumber is included to ensure data stays up-to-date every block\n  const [amounts, setAmounts] = useState<[BigNumber, BigNumber] | undefined>()\n  useEffect(() => {\n    if (positionManager && tokenIdHexString && owner) {\n      positionManager.callStatic\n        .collect(\n          {\n            tokenId: tokenIdHexString,\n            recipient: owner, // some tokens might fail if transferred to address(0)\n            amount0Max: MAX_UINT128,\n            amount1Max: MAX_UINT128,\n          },\n          { from: owner } // need to simulate the call as the owner\n        )\n        .then((results) => {\n          setAmounts([results.amount0, results.amount1])\n        })\n    }\n  }, [positionManager, tokenIdHexString, owner, latestBlockNumber])\n\n  if (pool && amounts) {\n    return [\n      CurrencyAmount.fromRawAmount(asWETH ? pool.token0 : unwrappedToken(pool.token0), amounts[0].toString()),\n      CurrencyAmount.fromRawAmount(asWETH ? pool.token1 : unwrappedToken(pool.token1), amounts[1].toString()),\n    ]\n  } else {\n    return [undefined, undefined]\n  }\n}\n"],"mappings":"4KAAA,OAASA,SAAS,KAAQ,0BAA0B,CACpD,OAAmBC,cAAc,KAAQ,mBAAmB,CAE5D,OAASC,mBAAmB,KAAQ,qBAAqB,CACzD,MAAOC,eAAc,KAAM,0BAA0B,CACrD,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,cAAc,KAAQ,sBAAsB,CAErD,OAASC,+BAA+B,KAAQ,eAAe,CAE/D,GAAMC,YAAW,CAAGR,SAAS,CAACS,IAAI,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAErD;AACA,MAAO,SAASC,kBAAiB,CAC/BC,IAAW,CACXC,OAAmB,CAE4D,8BAD/EC,OAAM,2DAAG,KAAK,CAEd,GAAMC,gBAAe,CAAGT,+BAA+B,CAAC,KAAK,CAAC,CAC9D,GAAMU,MAAyB,wBAAGf,mBAAmB,CAACY,OAAO,CAAGE,eAAe,CAAG,IAAI,CAAE,SAAS,CAAE,CAACF,OAAO,CAAC,CAAC,CAC1GI,MAAM,gDADyB,sBACtB,CAAC,CAAC,CAEd,GAAMC,iBAAgB,CAAGL,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEM,WAAW,EAAE,CAC/C,GAAMC,kBAAiB,CAAGlB,cAAc,EAAE,CAE1C;AACA;AACA,cAA8BE,QAAQ,EAAsC,wCAArEiB,OAAO,eAAEC,UAAU,eAC1BnB,SAAS,CAAC,UAAM,CACd,GAAIY,eAAe,EAAIG,gBAAgB,EAAIF,KAAK,CAAE,CAChDD,eAAe,CAACQ,UAAU,CACvBC,OAAO,CACN,CACEX,OAAO,CAAEK,gBAAgB,CACzBO,SAAS,CAAET,KAAK,CAAE;AAClBU,UAAU,CAAEnB,WAAW,CACvBoB,UAAU,CAAEpB,WACd,CAAC,CACD,CAAEC,IAAI,CAAEQ,KAAM,CAAE;AAAA,CACjB,CACAY,IAAI,CAAC,SAACC,OAAO,CAAK,CACjBP,UAAU,CAAC,CAACO,OAAO,CAACC,OAAO,CAAED,OAAO,CAACE,OAAO,CAAC,CAAC,CAChD,CAAC,CAAC,CACN,CACF,CAAC,CAAE,CAAChB,eAAe,CAAEG,gBAAgB,CAAEF,KAAK,CAAEI,iBAAiB,CAAC,CAAC,CAEjE,GAAIR,IAAI,EAAIS,OAAO,CAAE,CACnB,MAAO,CACLrB,cAAc,CAACgC,aAAa,CAAClB,MAAM,CAAGF,IAAI,CAACqB,MAAM,CAAG5B,cAAc,CAACO,IAAI,CAACqB,MAAM,CAAC,CAAEZ,OAAO,CAAC,CAAC,CAAC,CAACa,QAAQ,EAAE,CAAC,CACvGlC,cAAc,CAACgC,aAAa,CAAClB,MAAM,CAAGF,IAAI,CAACuB,MAAM,CAAG9B,cAAc,CAACO,IAAI,CAACuB,MAAM,CAAC,CAAEd,OAAO,CAAC,CAAC,CAAC,CAACa,QAAQ,EAAE,CAAC,CACxG,CACH,CAAC,IAAM,CACL,MAAO,CAACE,SAAS,CAAEA,SAAS,CAAC,CAC/B,CACF"},"metadata":{},"sourceType":"module"}