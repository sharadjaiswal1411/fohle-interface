{"ast":null,"code":"import _regeneratorRuntime from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { BigNumber } from '@ethersproject/bignumber';\nimport retry from 'async-retry';\nimport axios from 'axios';\nimport { log } from '../util/log';\nimport { IGasPriceProvider } from './gas-price-provider';\nexport var ETHGasStationInfoProvider = /*#__PURE__*/function (_IGasPriceProvider) {\n  _inherits(ETHGasStationInfoProvider, _IGasPriceProvider);\n  var _super = _createSuper(ETHGasStationInfoProvider);\n  function ETHGasStationInfoProvider(url) {\n    var _this;\n    _classCallCheck(this, ETHGasStationInfoProvider);\n    _this = _super.call(this);\n    _this.url = url;\n    return _this;\n  }\n  _createClass(ETHGasStationInfoProvider, [{\n    key: \"getGasPrice\",\n    value: function () {\n      var _getGasPrice = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n        var response, gasPriceResponse, status, gasPriceWei;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                log.info(\"About to get gas prices from gas station \".concat(this.url));\n                _context2.next = 3;\n                return retry( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          return _context.abrupt(\"return\", axios.get(_this2.url));\n                        case 1:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })), {\n                  retries: 1\n                });\n              case 3:\n                response = _context2.sent;\n                gasPriceResponse = response.data, status = response.status;\n                if (!(status != 200)) {\n                  _context2.next = 8;\n                  break;\n                }\n                log.error({\n                  response: response\n                }, \"Unabled to get gas price from \".concat(this.url, \".\"));\n                throw new Error(\"Unable to get gas price from \".concat(this.url));\n              case 8:\n                log.info({\n                  gasPriceResponse: gasPriceResponse\n                }, 'Gas price response from API. About to parse \"fast\" to big number');\n                // Gas prices from ethgasstation are in GweiX10.\n                gasPriceWei = BigNumber.from(gasPriceResponse.fast).div(BigNumber.from(10)).mul(BigNumber.from(10).pow(9));\n                log.info(\"Gas price in wei: \".concat(gasPriceWei, \" as of block \").concat(gasPriceResponse.blockNum));\n                return _context2.abrupt(\"return\", {\n                  gasPriceWei: gasPriceWei\n                });\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function getGasPrice() {\n        return _getGasPrice.apply(this, arguments);\n      }\n      return getGasPrice;\n    }()\n  }]);\n  return ETHGasStationInfoProvider;\n}(IGasPriceProvider);","map":{"version":3,"sources":["../../../src/providers/eth-gas-station-info-gas-price-provider.ts"],"names":[],"mappings":";;;;;;AAAA,SAAS,SAAS,QAAQ,0BAA0B;AACpD,OAAO,KAAK,MAAM,aAAa;AAC/B,OAAO,KAAK,MAAM,OAAO;AAEzB,SAAS,GAAG,QAAQ,aAAa;AAEjC,SAAmB,iBAAiB,QAAQ,sBAAsB;AAiBlE,WAAa,yBAA0B;EAAA;EAAA;EAErC,mCAAY,GAAW,EAAA;IAAA;IAAA;IACrB;IACA,MAAK,GAAG,GAAG,GAAG;IAAC;EACjB;EAAC;IAAA;IAAA;MAAA,4EAEM;QAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACL,GAAG,CAAC,IAAI,oDAA6C,IAAI,CAAC,GAAG,EAAG;gBAAC;gBAAA,OAC1C,KAAK,wEAC1B;kBAAA;oBAAA;sBAAA;wBAAA;0BAAA,iCACS,KAAK,CAAC,GAAG,CAAwB,MAAI,CAAC,GAAG,CAAC;wBAAA;wBAAA;0BAAA;sBAAA;oBAAA;kBAAA;gBAAA,CAClD,IACD;kBAAE,OAAO,EAAE;gBAAC,CAAE,CACf;cAAA;gBALK,QAAQ;gBAOA,gBAAgB,GAAa,QAAQ,CAA3C,IAAI,EAAoB,MAAM,GAAK,QAAQ,CAAnB,MAAM;gBAAA,MAElC,MAAM,IAAI,GAAG;kBAAA;kBAAA;gBAAA;gBACf,GAAG,CAAC,KAAK,CAAC;kBAAE,QAAQ,EAAR;gBAAQ,CAAE,0CAAmC,IAAI,CAAC,GAAG,OAAI;gBAAC,MAEhE,IAAI,KAAK,wCAAiC,IAAI,CAAC,GAAG,EAAG;cAAA;gBAG7D,GAAG,CAAC,IAAI,CACN;kBAAE,gBAAgB,EAAhB;gBAAgB,CAAE,EACpB,kEAAkE,CACnE;gBAED;gBACM,WAAW,GAAG,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CACtD,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CACvB,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAEjC,GAAG,CAAC,IAAI,6BACe,WAAW,0BAAgB,gBAAgB,CAAC,QAAQ,EAC1E;gBAAC,kCAEK;kBAAE,WAAW,EAAE;gBAAW,CAAE;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACpC;MAAA;QAAA;MAAA;MAAA;IAAA;EAAA;EAAA;AAAA,EAvC4C,iBAAiB","sourceRoot":"","sourcesContent":["import { BigNumber } from '@ethersproject/bignumber';\nimport retry from 'async-retry';\nimport axios from 'axios';\nimport { log } from '../util/log';\nimport { IGasPriceProvider } from './gas-price-provider';\nexport class ETHGasStationInfoProvider extends IGasPriceProvider {\n    constructor(url) {\n        super();\n        this.url = url;\n    }\n    async getGasPrice() {\n        log.info(`About to get gas prices from gas station ${this.url}`);\n        const response = await retry(async () => {\n            return axios.get(this.url);\n        }, { retries: 1 });\n        const { data: gasPriceResponse, status } = response;\n        if (status != 200) {\n            log.error({ response }, `Unabled to get gas price from ${this.url}.`);\n            throw new Error(`Unable to get gas price from ${this.url}`);\n        }\n        log.info({ gasPriceResponse }, 'Gas price response from API. About to parse \"fast\" to big number');\n        // Gas prices from ethgasstation are in GweiX10.\n        const gasPriceWei = BigNumber.from(gasPriceResponse.fast)\n            .div(BigNumber.from(10))\n            .mul(BigNumber.from(10).pow(9));\n        log.info(`Gas price in wei: ${gasPriceWei} as of block ${gasPriceResponse.blockNum}`);\n        return { gasPriceWei: gasPriceWei };\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXRoLWdhcy1zdGF0aW9uLWluZm8tZ2FzLXByaWNlLXByb3ZpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Byb3ZpZGVycy9ldGgtZ2FzLXN0YXRpb24taW5mby1nYXMtcHJpY2UtcHJvdmlkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JELE9BQU8sS0FBSyxNQUFNLGFBQWEsQ0FBQztBQUNoQyxPQUFPLEtBQUssTUFBTSxPQUFPLENBQUM7QUFFMUIsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUVsQyxPQUFPLEVBQVksaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQWlCbkUsTUFBTSxPQUFPLHlCQUEwQixTQUFRLGlCQUFpQjtJQUU5RCxZQUFZLEdBQVc7UUFDckIsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNqQixDQUFDO0lBRU0sS0FBSyxDQUFDLFdBQVc7UUFDdEIsR0FBRyxDQUFDLElBQUksQ0FBQyw0Q0FBNEMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDakUsTUFBTSxRQUFRLEdBQUcsTUFBTSxLQUFLLENBQzFCLEtBQUssSUFBSSxFQUFFO1lBQ1QsT0FBTyxLQUFLLENBQUMsR0FBRyxDQUF3QixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEQsQ0FBQyxFQUNELEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUNmLENBQUM7UUFFRixNQUFNLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQztRQUVwRCxJQUFJLE1BQU0sSUFBSSxHQUFHLEVBQUU7WUFDakIsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLFFBQVEsRUFBRSxFQUFFLGlDQUFpQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUV0RSxNQUFNLElBQUksS0FBSyxDQUFDLGdDQUFnQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztTQUM3RDtRQUVELEdBQUcsQ0FBQyxJQUFJLENBQ04sRUFBRSxnQkFBZ0IsRUFBRSxFQUNwQixrRUFBa0UsQ0FDbkUsQ0FBQztRQUVGLGdEQUFnRDtRQUNoRCxNQUFNLFdBQVcsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQzthQUN0RCxHQUFHLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUN2QixHQUFHLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVsQyxHQUFHLENBQUMsSUFBSSxDQUNOLHFCQUFxQixXQUFXLGdCQUFnQixnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsQ0FDNUUsQ0FBQztRQUVGLE9BQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLENBQUM7SUFDdEMsQ0FBQztDQUNGIn0="]},"metadata":{},"sourceType":"module"}