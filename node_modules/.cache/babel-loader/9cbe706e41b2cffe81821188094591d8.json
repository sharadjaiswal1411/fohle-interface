{"ast":null,"code":"import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{max,scaleLinear}from'd3';import{useEffect,useMemo,useRef,useState}from'react';import{Bound}from'state/mint/v3/actions';import{Area}from'./Area';import{AxisBottom}from'./AxisBottom';import{Brush}from'./Brush';import{Line}from'./Line';import Zoom,{ZoomOverlay}from'./Zoom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var xAccessor=function xAccessor(d){return d.price0;};var yAccessor=function yAccessor(d){return d.activeLiquidity;};export function Chart(_ref){var _ref$id=_ref.id,id=_ref$id===void 0?'liquidityChartRangeInput':_ref$id,_ref$data=_ref.data,series=_ref$data.series,current=_ref$data.current,ticksAtLimit=_ref.ticksAtLimit,styles=_ref.styles,_ref$dimensions=_ref.dimensions,width=_ref$dimensions.width,height=_ref$dimensions.height,margins=_ref.margins,_ref$interactive=_ref.interactive,interactive=_ref$interactive===void 0?true:_ref$interactive,brushDomain=_ref.brushDomain,brushLabels=_ref.brushLabels,onBrushDomainChange=_ref.onBrushDomainChange,zoomLevels=_ref.zoomLevels;var zoomRef=useRef(null);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),zoom=_useState2[0],setZoom=_useState2[1];var _useMemo=useMemo(function(){return[height-margins.top-margins.bottom,width-margins.left-margins.right];},[width,height,margins]),_useMemo2=_slicedToArray(_useMemo,2),innerHeight=_useMemo2[0],innerWidth=_useMemo2[1];var _useMemo3=useMemo(function(){var scales={xScale:scaleLinear().domain([current*zoomLevels.initialMin,current*zoomLevels.initialMax]).range([0,innerWidth]),yScale:scaleLinear().domain([0,max(series,yAccessor)]).range([innerHeight,0])};if(zoom){var newXscale=zoom.rescaleX(scales.xScale);scales.xScale.domain(newXscale.domain());}return scales;},[current,zoomLevels.initialMin,zoomLevels.initialMax,innerWidth,series,innerHeight,zoom]),xScale=_useMemo3.xScale,yScale=_useMemo3.yScale;useEffect(function(){// reset zoom as necessary\nsetZoom(null);},[zoomLevels]);useEffect(function(){if(!brushDomain){onBrushDomainChange(xScale.domain(),undefined);}},[brushDomain,onBrushDomainChange,xScale]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Zoom,{svg:zoomRef.current,xScale:xScale,setZoom:setZoom,width:innerWidth,height:// allow zooming inside the x-axis\nheight,resetBrush:function resetBrush(){onBrushDomainChange([current*zoomLevels.initialMin,current*zoomLevels.initialMax],'reset');},showResetButton:Boolean(ticksAtLimit[Bound.LOWER]||ticksAtLimit[Bound.UPPER]),zoomLevels:zoomLevels}),/*#__PURE__*/_jsxs(\"svg\",{width:\"100%\",height:\"100%\",viewBox:\"0 0 \".concat(width,\" \").concat(height),style:{overflow:'visible'},children:[/*#__PURE__*/_jsxs(\"defs\",{children:[/*#__PURE__*/_jsx(\"clipPath\",{id:\"\".concat(id,\"-chart-clip\"),children:/*#__PURE__*/_jsx(\"rect\",{x:\"0\",y:\"0\",width:innerWidth,height:height})}),brushDomain&&/*#__PURE__*/ // mask to highlight selected area\n_jsx(\"mask\",{id:\"\".concat(id,\"-chart-area-mask\"),children:/*#__PURE__*/_jsx(\"rect\",{fill:\"white\",x:xScale(brushDomain[0]),y:\"0\",width:xScale(brushDomain[1])-xScale(brushDomain[0]),height:innerHeight})})]}),/*#__PURE__*/_jsxs(\"g\",{transform:\"translate(\".concat(margins.left,\",\").concat(margins.top,\")\"),children:[/*#__PURE__*/_jsxs(\"g\",{clipPath:\"url(#\".concat(id,\"-chart-clip)\"),children:[/*#__PURE__*/_jsx(Area,{series:series,xScale:xScale,yScale:yScale,xValue:xAccessor,yValue:yAccessor}),brushDomain&&/*#__PURE__*/ // duplicate area chart with mask for selected area\n_jsx(\"g\",{mask:\"url(#\".concat(id,\"-chart-area-mask)\"),children:/*#__PURE__*/_jsx(Area,{series:series,xScale:xScale,yScale:yScale,xValue:xAccessor,yValue:yAccessor,fill:styles.area.selection})}),/*#__PURE__*/_jsx(Line,{value:current,xScale:xScale,innerHeight:innerHeight}),/*#__PURE__*/_jsx(AxisBottom,{xScale:xScale,innerHeight:innerHeight})]}),/*#__PURE__*/_jsx(ZoomOverlay,{width:innerWidth,height:height,ref:zoomRef}),/*#__PURE__*/_jsx(Brush,{id:id,xScale:xScale,interactive:interactive,brushLabelValue:brushLabels,brushExtent:brushDomain!==null&&brushDomain!==void 0?brushDomain:xScale.domain(),innerWidth:innerWidth,innerHeight:innerHeight,setBrushExtent:onBrushDomainChange,westHandleColor:styles.brush.handle.west,eastHandleColor:styles.brush.handle.east})]})]})]});}","map":{"version":3,"names":["max","scaleLinear","useEffect","useMemo","useRef","useState","Bound","Area","AxisBottom","Brush","Line","Zoom","ZoomOverlay","xAccessor","d","price0","yAccessor","activeLiquidity","Chart","id","data","series","current","ticksAtLimit","styles","dimensions","width","height","margins","interactive","brushDomain","brushLabels","onBrushDomainChange","zoomLevels","zoomRef","zoom","setZoom","top","bottom","left","right","innerHeight","innerWidth","scales","xScale","domain","initialMin","initialMax","range","yScale","newXscale","rescaleX","undefined","Boolean","LOWER","UPPER","overflow","area","selection","brush","handle","west","east"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/LiquidityChartRangeInput/Chart.tsx"],"sourcesContent":["import { max, scaleLinear, ZoomTransform } from 'd3'\nimport { useEffect, useMemo, useRef, useState } from 'react'\nimport { Bound } from 'state/mint/v3/actions'\n\nimport { Area } from './Area'\nimport { AxisBottom } from './AxisBottom'\nimport { Brush } from './Brush'\nimport { Line } from './Line'\nimport { ChartEntry, LiquidityChartRangeInputProps } from './types'\nimport Zoom, { ZoomOverlay } from './Zoom'\n\nconst xAccessor = (d: ChartEntry) => d.price0\nconst yAccessor = (d: ChartEntry) => d.activeLiquidity\n\nexport function Chart({\n  id = 'liquidityChartRangeInput',\n  data: { series, current },\n  ticksAtLimit,\n  styles,\n  dimensions: { width, height },\n  margins,\n  interactive = true,\n  brushDomain,\n  brushLabels,\n  onBrushDomainChange,\n  zoomLevels,\n}: LiquidityChartRangeInputProps) {\n  const zoomRef = useRef<SVGRectElement | null>(null)\n\n  const [zoom, setZoom] = useState<ZoomTransform | null>(null)\n\n  const [innerHeight, innerWidth] = useMemo(\n    () => [height - margins.top - margins.bottom, width - margins.left - margins.right],\n    [width, height, margins]\n  )\n\n  const { xScale, yScale } = useMemo(() => {\n    const scales = {\n      xScale: scaleLinear()\n        .domain([current * zoomLevels.initialMin, current * zoomLevels.initialMax] as number[])\n        .range([0, innerWidth]),\n      yScale: scaleLinear()\n        .domain([0, max(series, yAccessor)] as number[])\n        .range([innerHeight, 0]),\n    }\n\n    if (zoom) {\n      const newXscale = zoom.rescaleX(scales.xScale)\n      scales.xScale.domain(newXscale.domain())\n    }\n\n    return scales\n  }, [current, zoomLevels.initialMin, zoomLevels.initialMax, innerWidth, series, innerHeight, zoom])\n\n  useEffect(() => {\n    // reset zoom as necessary\n    setZoom(null)\n  }, [zoomLevels])\n\n  useEffect(() => {\n    if (!brushDomain) {\n      onBrushDomainChange(xScale.domain() as [number, number], undefined)\n    }\n  }, [brushDomain, onBrushDomainChange, xScale])\n\n  return (\n    <>\n      <Zoom\n        svg={zoomRef.current}\n        xScale={xScale}\n        setZoom={setZoom}\n        width={innerWidth}\n        height={\n          // allow zooming inside the x-axis\n          height\n        }\n        resetBrush={() => {\n          onBrushDomainChange(\n            [current * zoomLevels.initialMin, current * zoomLevels.initialMax] as [number, number],\n            'reset'\n          )\n        }}\n        showResetButton={Boolean(ticksAtLimit[Bound.LOWER] || ticksAtLimit[Bound.UPPER])}\n        zoomLevels={zoomLevels}\n      />\n      <svg width=\"100%\" height=\"100%\" viewBox={`0 0 ${width} ${height}`} style={{ overflow: 'visible' }}>\n        <defs>\n          <clipPath id={`${id}-chart-clip`}>\n            <rect x=\"0\" y=\"0\" width={innerWidth} height={height} />\n          </clipPath>\n\n          {brushDomain && (\n            // mask to highlight selected area\n            <mask id={`${id}-chart-area-mask`}>\n              <rect\n                fill=\"white\"\n                x={xScale(brushDomain[0])}\n                y=\"0\"\n                width={xScale(brushDomain[1]) - xScale(brushDomain[0])}\n                height={innerHeight}\n              />\n            </mask>\n          )}\n        </defs>\n\n        <g transform={`translate(${margins.left},${margins.top})`}>\n          <g clipPath={`url(#${id}-chart-clip)`}>\n            <Area series={series} xScale={xScale} yScale={yScale} xValue={xAccessor} yValue={yAccessor} />\n\n            {brushDomain && (\n              // duplicate area chart with mask for selected area\n              <g mask={`url(#${id}-chart-area-mask)`}>\n                <Area\n                  series={series}\n                  xScale={xScale}\n                  yScale={yScale}\n                  xValue={xAccessor}\n                  yValue={yAccessor}\n                  fill={styles.area.selection}\n                />\n              </g>\n            )}\n\n            <Line value={current} xScale={xScale} innerHeight={innerHeight} />\n\n            <AxisBottom xScale={xScale} innerHeight={innerHeight} />\n          </g>\n\n          <ZoomOverlay width={innerWidth} height={height} ref={zoomRef} />\n\n          <Brush\n            id={id}\n            xScale={xScale}\n            interactive={interactive}\n            brushLabelValue={brushLabels}\n            brushExtent={brushDomain ?? (xScale.domain() as [number, number])}\n            innerWidth={innerWidth}\n            innerHeight={innerHeight}\n            setBrushExtent={onBrushDomainChange}\n            westHandleColor={styles.brush.handle.west}\n            eastHandleColor={styles.brush.handle.east}\n          />\n        </g>\n      </svg>\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}