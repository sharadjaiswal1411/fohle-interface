{"ast":null,"code":"import _toConsumableArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{ParentSize}from'@visx/responsive';import{ChartContainer,LoadingChart}from'components/Tokens/TokenDetails/Skeleton';import{isPricePoint}from'graphql/data/util';import{useAtomValue}from'jotai/utils';import{pageTimePeriodAtom}from'pages/TokenDetails';import{startTransition,Suspense,useMemo}from'react';import{PriceChart}from'./PriceChart';import TimePeriodSelector from'./TimeSelector';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function usePriceHistory(tokenPriceData){// Appends the current price to the end of the priceHistory array\nvar priceHistory=useMemo(function(){var _tokenPriceData$token,_tokenPriceData$token2,_market$priceHistory,_market$price;var market=(_tokenPriceData$token=tokenPriceData.tokens)===null||_tokenPriceData$token===void 0?void 0:(_tokenPriceData$token2=_tokenPriceData$token[0])===null||_tokenPriceData$token2===void 0?void 0:_tokenPriceData$token2.market;var priceHistory=market===null||market===void 0?void 0:(_market$priceHistory=market.priceHistory)===null||_market$priceHistory===void 0?void 0:_market$priceHistory.filter(isPricePoint);var currentPrice=market===null||market===void 0?void 0:(_market$price=market.price)===null||_market$price===void 0?void 0:_market$price.value;if(Array.isArray(priceHistory)&&currentPrice!==undefined){var timestamp=Date.now()/1000;return[].concat(_toConsumableArray(priceHistory),[{timestamp:timestamp,value:currentPrice}]);}return priceHistory;},[tokenPriceData]);return priceHistory;}export default function ChartSection(_ref){var tokenPriceQuery=_ref.tokenPriceQuery,onChangeTimePeriod=_ref.onChangeTimePeriod;if(!tokenPriceQuery){return/*#__PURE__*/_jsx(LoadingChart,{});}return/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingChart,{}),children:/*#__PURE__*/_jsx(ChartContainer,{children:/*#__PURE__*/_jsx(Chart,{tokenPriceQuery:tokenPriceQuery,onChangeTimePeriod:onChangeTimePeriod})})});}function Chart(_ref2){var tokenPriceQuery=_ref2.tokenPriceQuery,onChangeTimePeriod=_ref2.onChangeTimePeriod;var prices=usePriceHistory(tokenPriceQuery);// Initializes time period to global & maintain separate time period for subsequent changes\nvar timePeriod=useAtomValue(pageTimePeriodAtom);return/*#__PURE__*/_jsxs(ChartContainer,{children:[/*#__PURE__*/_jsx(ParentSize,{children:function children(_ref3){var width=_ref3.width;return/*#__PURE__*/_jsx(PriceChart,{prices:prices!==null&&prices!==void 0?prices:null,width:width,height:436,timePeriod:timePeriod});}}),/*#__PURE__*/_jsx(TimePeriodSelector,{currentTimePeriod:timePeriod,onTimeChange:function onTimeChange(t){startTransition(function(){return onChangeTimePeriod(t);});}})]});}","map":{"version":3,"names":["ParentSize","ChartContainer","LoadingChart","isPricePoint","useAtomValue","pageTimePeriodAtom","startTransition","Suspense","useMemo","PriceChart","TimePeriodSelector","usePriceHistory","tokenPriceData","priceHistory","market","tokens","filter","currentPrice","price","value","Array","isArray","undefined","timestamp","Date","now","ChartSection","tokenPriceQuery","onChangeTimePeriod","Chart","prices","timePeriod","width","t"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/components/Tokens/TokenDetails/ChartSection.tsx"],"sourcesContent":["import { ParentSize } from '@visx/responsive'\nimport { ChartContainer, LoadingChart } from 'components/Tokens/TokenDetails/Skeleton'\nimport { TokenPriceQuery } from 'graphql/data/TokenPrice'\nimport { isPricePoint, PricePoint } from 'graphql/data/util'\nimport { TimePeriod } from 'graphql/data/util'\nimport { useAtomValue } from 'jotai/utils'\nimport { pageTimePeriodAtom } from 'pages/TokenDetails'\nimport { startTransition, Suspense, useMemo } from 'react'\n\nimport { PriceChart } from './PriceChart'\nimport TimePeriodSelector from './TimeSelector'\n\nfunction usePriceHistory(tokenPriceData: TokenPriceQuery): PricePoint[] | undefined {\n  // Appends the current price to the end of the priceHistory array\n  const priceHistory = useMemo(() => {\n    const market = tokenPriceData.tokens?.[0]?.market\n    const priceHistory = market?.priceHistory?.filter(isPricePoint)\n    const currentPrice = market?.price?.value\n    if (Array.isArray(priceHistory) && currentPrice !== undefined) {\n      const timestamp = Date.now() / 1000\n      return [...priceHistory, { timestamp, value: currentPrice }]\n    }\n    return priceHistory\n  }, [tokenPriceData])\n\n  return priceHistory\n}\nexport default function ChartSection({\n  tokenPriceQuery,\n  onChangeTimePeriod,\n}: {\n  tokenPriceQuery?: TokenPriceQuery\n  onChangeTimePeriod: OnChangeTimePeriod\n}) {\n  if (!tokenPriceQuery) {\n    return <LoadingChart />\n  }\n\n  return (\n    <Suspense fallback={<LoadingChart />}>\n      <ChartContainer>\n        <Chart tokenPriceQuery={tokenPriceQuery} onChangeTimePeriod={onChangeTimePeriod} />\n      </ChartContainer>\n    </Suspense>\n  )\n}\n\nexport type OnChangeTimePeriod = (t: TimePeriod) => void\nfunction Chart({\n  tokenPriceQuery,\n  onChangeTimePeriod,\n}: {\n  tokenPriceQuery: TokenPriceQuery\n  onChangeTimePeriod: OnChangeTimePeriod\n}) {\n  const prices = usePriceHistory(tokenPriceQuery)\n  // Initializes time period to global & maintain separate time period for subsequent changes\n  const timePeriod = useAtomValue(pageTimePeriodAtom)\n\n  return (\n    <ChartContainer>\n      <ParentSize>\n        {({ width }) => <PriceChart prices={prices ?? null} width={width} height={436} timePeriod={timePeriod} />}\n      </ParentSize>\n      <TimePeriodSelector\n        currentTimePeriod={timePeriod}\n        onTimeChange={(t: TimePeriod) => {\n          startTransition(() => onChangeTimePeriod(t))\n        }}\n      />\n    </ChartContainer>\n  )\n}\n"],"mappings":"oLAAA,OAASA,UAAU,KAAQ,kBAAkB,CAC7C,OAASC,cAAc,CAAEC,YAAY,KAAQ,yCAAyC,CAEtF,OAASC,YAAY,KAAoB,mBAAmB,CAE5D,OAASC,YAAY,KAAQ,aAAa,CAC1C,OAASC,kBAAkB,KAAQ,oBAAoB,CACvD,OAASC,eAAe,CAAEC,QAAQ,CAAEC,OAAO,KAAQ,OAAO,CAE1D,OAASC,UAAU,KAAQ,cAAc,CACzC,MAAOC,mBAAkB,KAAM,gBAAgB,yFAE/C,QAASC,gBAAe,CAACC,cAA+B,CAA4B,CAClF;AACA,GAAMC,aAAY,CAAGL,OAAO,CAAC,UAAM,qFACjC,GAAMM,OAAM,wBAAGF,cAAc,CAACG,MAAM,wEAArB,sBAAwB,CAAC,CAAC,iDAA1B,uBAA4BD,MAAM,CACjD,GAAMD,aAAY,CAAGC,MAAM,SAANA,MAAM,uCAANA,MAAM,CAAED,YAAY,+CAApB,qBAAsBG,MAAM,CAACb,YAAY,CAAC,CAC/D,GAAMc,aAAY,CAAGH,MAAM,SAANA,MAAM,gCAANA,MAAM,CAAEI,KAAK,wCAAb,cAAeC,KAAK,CACzC,GAAIC,KAAK,CAACC,OAAO,CAACR,YAAY,CAAC,EAAII,YAAY,GAAKK,SAAS,CAAE,CAC7D,GAAMC,UAAS,CAAGC,IAAI,CAACC,GAAG,EAAE,CAAG,IAAI,CACnC,mCAAWZ,YAAY,GAAE,CAAEU,SAAS,CAATA,SAAS,CAAEJ,KAAK,CAAEF,YAAa,CAAC,GAC7D,CACA,MAAOJ,aAAY,CACrB,CAAC,CAAE,CAACD,cAAc,CAAC,CAAC,CAEpB,MAAOC,aAAY,CACrB,CACA,cAAe,SAASa,aAAY,MAMjC,IALDC,gBAAe,MAAfA,eAAe,CACfC,kBAAkB,MAAlBA,kBAAkB,CAKlB,GAAI,CAACD,eAAe,CAAE,CACpB,mBAAO,KAAC,YAAY,IAAG,CACzB,CAEA,mBACE,KAAC,QAAQ,EAAC,QAAQ,cAAE,KAAC,YAAY,IAAI,uBACnC,KAAC,cAAc,wBACb,KAAC,KAAK,EAAC,eAAe,CAAEA,eAAgB,CAAC,kBAAkB,CAAEC,kBAAmB,EAAG,EACpE,EACR,CAEf,CAGA,QAASC,MAAK,OAMX,IALDF,gBAAe,OAAfA,eAAe,CACfC,kBAAkB,OAAlBA,kBAAkB,CAKlB,GAAME,OAAM,CAAGnB,eAAe,CAACgB,eAAe,CAAC,CAC/C;AACA,GAAMI,WAAU,CAAG3B,YAAY,CAACC,kBAAkB,CAAC,CAEnD,mBACE,MAAC,cAAc,yBACb,KAAC,UAAU,WACR,4BAAG2B,MAAK,OAALA,KAAK,oBAAO,KAAC,UAAU,EAAC,MAAM,CAAEF,MAAM,SAANA,MAAM,UAANA,MAAM,CAAI,IAAK,CAAC,KAAK,CAAEE,KAAM,CAAC,MAAM,CAAE,GAAI,CAAC,UAAU,CAAED,UAAW,EAAG,IAC9F,cACb,KAAC,kBAAkB,EACjB,iBAAiB,CAAEA,UAAW,CAC9B,YAAY,CAAE,sBAACE,CAAa,CAAK,CAC/B3B,eAAe,CAAC,iBAAMsB,mBAAkB,CAACK,CAAC,CAAC,GAAC,CAC9C,CAAE,EACF,GACa,CAErB"},"metadata":{},"sourceType":"module"}