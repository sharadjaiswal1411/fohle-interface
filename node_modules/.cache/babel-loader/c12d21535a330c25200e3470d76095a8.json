{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import*as Sentry from'@sentry/react';import{SupportedChainId}from'constants/chains';import uriToHttp from'lib/utils/uriToHttp';import Vibrant from'node-vibrant/lib/bundle.js';import{shade}from'polished';import{useEffect,useState}from'react';import{WrappedTokenInfo}from'state/lists/wrappedTokenInfo';import{hex}from'wcag-contrast';function URIForEthToken(address){return\"https://raw.githubusercontent.com/uniswap/assets/master/blockchains/ethereum/assets/\".concat(address,\"/logo.png\");}function getColorFromToken(_x){return _getColorFromToken.apply(this,arguments);}function _getColorFromToken(){_getColorFromToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token){var wrappedToken,address,logoURI;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(token instanceof WrappedTokenInfo){_context.next=2;break;}return _context.abrupt(\"return\",null);case 2:wrappedToken=token;address=wrappedToken.address;logoURI=wrappedToken.logoURI;if(logoURI){_context.next=11;break;}if(!(token.chainId!==SupportedChainId.MAINNET)){_context.next=10;break;}return _context.abrupt(\"return\",null);case 10:logoURI=URIForEthToken(address);case 11:_context.prev=11;_context.next=14;return getColorFromUriPath(logoURI);case 14:return _context.abrupt(\"return\",_context.sent);case 17:_context.prev=17;_context.t0=_context[\"catch\"](11);if(!(logoURI===URIForEthToken(address))){_context.next=21;break;}return _context.abrupt(\"return\",null);case 21:_context.prev=21;logoURI=URIForEthToken(address);_context.next=25;return getColorFromUriPath(logoURI);case 25:return _context.abrupt(\"return\",_context.sent);case 28:_context.prev=28;_context.t1=_context[\"catch\"](21);Sentry.captureMessage(_context.t1.toString());case 31:return _context.abrupt(\"return\",null);case 32:case\"end\":return _context.stop();}}},_callee,null,[[11,17],[21,28]]);}));return _getColorFromToken.apply(this,arguments);}function getColorFromUriPath(_x2){return _getColorFromUriPath.apply(this,arguments);}function _getColorFromUriPath(){_getColorFromUriPath=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(uri){var _palette;var formattedPath,palette,detectedHex,AAscore;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formattedPath=uriToHttp(uri)[0];_context2.prev=1;_context2.next=4;return Vibrant.from(formattedPath).getPalette();case 4:palette=_context2.sent;_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",null);case 10:if((_palette=palette)===null||_palette===void 0?void 0:_palette.Vibrant){_context2.next=12;break;}return _context2.abrupt(\"return\",null);case 12:detectedHex=palette.Vibrant.hex;AAscore=hex(detectedHex,'#FFF');while(AAscore<3){detectedHex=shade(0.005,detectedHex);AAscore=hex(detectedHex,'#FFF');}return _context2.abrupt(\"return\",detectedHex);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[1,7]]);}));return _getColorFromUriPath.apply(this,arguments);}export function useColor(token){var _useState=useState('#2172E5'),_useState2=_slicedToArray(_useState,2),color=_useState2[0],setColor=_useState2[1];useEffect(function(){var stale=false;if(token){getColorFromToken(token).then(function(tokenColor){if(!stale&&tokenColor!==null){setColor(tokenColor);}});}return function(){stale=true;setColor('#2172E5');};},[token]);return color;}","map":{"version":3,"names":["Sentry","SupportedChainId","uriToHttp","Vibrant","shade","useEffect","useState","WrappedTokenInfo","hex","URIForEthToken","address","getColorFromToken","token","wrappedToken","logoURI","chainId","MAINNET","getColorFromUriPath","captureMessage","toString","uri","formattedPath","from","getPalette","palette","detectedHex","AAscore","useColor","color","setColor","stale","then","tokenColor"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/fohle-interface/src/hooks/useColor.ts"],"sourcesContent":["import * as Sentry from '@sentry/react'\nimport { Token } from '@uniswap/sdk-core'\nimport { SupportedChainId } from 'constants/chains'\nimport uriToHttp from 'lib/utils/uriToHttp'\nimport Vibrant from 'node-vibrant/lib/bundle.js'\nimport { shade } from 'polished'\nimport { useEffect, useState } from 'react'\nimport { WrappedTokenInfo } from 'state/lists/wrappedTokenInfo'\nimport { hex } from 'wcag-contrast'\n\nfunction URIForEthToken(address: string) {\n  return `https://raw.githubusercontent.com/uniswap/assets/master/blockchains/ethereum/assets/${address}/logo.png`\n}\n\nasync function getColorFromToken(token: Token): Promise<string | null> {\n  if (!(token instanceof WrappedTokenInfo)) {\n    return null\n  }\n\n  const wrappedToken = token as WrappedTokenInfo\n  const { address } = wrappedToken\n  let { logoURI } = wrappedToken\n  if (!logoURI) {\n    if (token.chainId !== SupportedChainId.MAINNET) {\n      return null\n    } else {\n      logoURI = URIForEthToken(address)\n    }\n  }\n\n  try {\n    return await getColorFromUriPath(logoURI)\n  } catch (e) {\n    if (logoURI === URIForEthToken(address)) {\n      return null\n    }\n\n    try {\n      logoURI = URIForEthToken(address)\n      return await getColorFromUriPath(logoURI)\n    } catch (error) {\n      Sentry.captureMessage(error.toString())\n    }\n  }\n\n  return null\n}\n\nasync function getColorFromUriPath(uri: string): Promise<string | null> {\n  const formattedPath = uriToHttp(uri)[0]\n\n  let palette\n\n  try {\n    palette = await Vibrant.from(formattedPath).getPalette()\n  } catch (err) {\n    return null\n  }\n  if (!palette?.Vibrant) {\n    return null\n  }\n\n  let detectedHex = palette.Vibrant.hex\n  let AAscore = hex(detectedHex, '#FFF')\n  while (AAscore < 3) {\n    detectedHex = shade(0.005, detectedHex)\n    AAscore = hex(detectedHex, '#FFF')\n  }\n\n  return detectedHex\n}\n\nexport function useColor(token?: Token) {\n  const [color, setColor] = useState('#2172E5')\n\n  useEffect(() => {\n    let stale = false\n\n    if (token) {\n      getColorFromToken(token).then((tokenColor) => {\n        if (!stale && tokenColor !== null) {\n          setColor(tokenColor)\n        }\n      })\n    }\n\n    return () => {\n      stale = true\n      setColor('#2172E5')\n    }\n  }, [token])\n\n  return color\n}\n"],"mappings":"igBAAA,MAAO,GAAKA,OAAM,KAAM,eAAe,CAEvC,OAASC,gBAAgB,KAAQ,kBAAkB,CACnD,MAAOC,UAAS,KAAM,qBAAqB,CAC3C,MAAOC,QAAO,KAAM,4BAA4B,CAChD,OAASC,KAAK,KAAQ,UAAU,CAChC,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,gBAAgB,KAAQ,8BAA8B,CAC/D,OAASC,GAAG,KAAQ,eAAe,CAEnC,QAASC,eAAc,CAACC,OAAe,CAAE,CACvC,oGAA8FA,OAAO,cACvG,CAAC,QAEcC,kBAAiB,+JAAhC,iBAAiCC,KAAY,sJACrCA,KAAK,WAAYL,iBAAgB,yDAC9B,IAAI,SAGPM,YAAY,CAAGD,KAAK,CAClBF,OAAO,CAAKG,YAAY,CAAxBH,OAAO,CACTI,OAAO,CAAKD,YAAY,CAAxBC,OAAO,IACRA,OAAO,+BACNF,KAAK,CAACG,OAAO,GAAKd,gBAAgB,CAACe,OAAO,2DACrC,IAAI,UAEXF,OAAO,CAAGL,cAAc,CAACC,OAAO,CAAC,iDAKtBO,oBAAmB,CAACH,OAAO,CAAC,wHAErCA,OAAO,GAAKL,cAAc,CAACC,OAAO,CAAC,2DAC9B,IAAI,2BAIXI,OAAO,CAAGL,cAAc,CAACC,OAAO,CAAC,wBACpBO,oBAAmB,CAACH,OAAO,CAAC,mHAEzCd,MAAM,CAACkB,cAAc,CAAC,YAAMC,QAAQ,EAAE,CAAC,yCAIpC,IAAI,gFACZ,4DAEcF,oBAAmB,sKAAlC,kBAAmCG,GAAW,iLACtCC,aAAa,CAAGnB,SAAS,CAACkB,GAAG,CAAC,CAAC,CAAC,CAAC,yCAKrBjB,QAAO,CAACmB,IAAI,CAACD,aAAa,CAAC,CAACE,UAAU,EAAE,QAAxDC,OAAO,oIAEA,IAAI,uBAERA,OAAO,mCAAP,SAASrB,OAAO,4DACZ,IAAI,UAGTsB,WAAW,CAAGD,OAAO,CAACrB,OAAO,CAACK,GAAG,CACjCkB,OAAO,CAAGlB,GAAG,CAACiB,WAAW,CAAE,MAAM,CAAC,CACtC,MAAOC,OAAO,CAAG,CAAC,CAAE,CAClBD,WAAW,CAAGrB,KAAK,CAAC,KAAK,CAAEqB,WAAW,CAAC,CACvCC,OAAO,CAAGlB,GAAG,CAACiB,WAAW,CAAE,MAAM,CAAC,CACpC,CAAC,iCAEMA,WAAW,wEACnB,sDAED,MAAO,SAASE,SAAQ,CAACf,KAAa,CAAE,CACtC,cAA0BN,QAAQ,CAAC,SAAS,CAAC,wCAAtCsB,KAAK,eAAEC,QAAQ,eAEtBxB,SAAS,CAAC,UAAM,CACd,GAAIyB,MAAK,CAAG,KAAK,CAEjB,GAAIlB,KAAK,CAAE,CACTD,iBAAiB,CAACC,KAAK,CAAC,CAACmB,IAAI,CAAC,SAACC,UAAU,CAAK,CAC5C,GAAI,CAACF,KAAK,EAAIE,UAAU,GAAK,IAAI,CAAE,CACjCH,QAAQ,CAACG,UAAU,CAAC,CACtB,CACF,CAAC,CAAC,CACJ,CAEA,MAAO,WAAM,CACXF,KAAK,CAAG,IAAI,CACZD,QAAQ,CAAC,SAAS,CAAC,CACrB,CAAC,CACH,CAAC,CAAE,CAACjB,KAAK,CAAC,CAAC,CAEX,MAAOgB,MAAK,CACd"},"metadata":{},"sourceType":"module"}